<!doctype html><html lang=zh-CN><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222><meta name=generator content="Hexo 5.2.0"><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-next.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32-next.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16-next.png><link rel=mask-icon href=/images/logo.svg color=#222><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><script class=next-config data-name=main type=application/json>{"hostname":"vitock.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src=/js/config.js></script><meta name=description content="ECDH密钥分发算法 满足结合律交换律,根据几何图像,交换律显而易见,结合律未找到证明。 下面大写表示曲线上的点,小写表示数. 表示 PQ连线和曲线另外一个交点R′R^{&amp;#x27;}R′的x轴对称点R  P+Q&#x3D;RP + Q &#x3D; R P+Q&#x3D;R"><meta property=og:type content=article><meta property=og:title content=ECC椭圆曲线加密><meta property=og:url content=http://vitock.github.io/2020/10/21/541a3f0129ff/index.html><meta property=og:site_name><meta property=og:description content="ECDH密钥分发算法 满足结合律交换律,根据几何图像,交换律显而易见,结合律未找到证明。 下面大写表示曲线上的点,小写表示数. 表示 PQ连线和曲线另外一个交点R′R^{&amp;#x27;}R′的x轴对称点R  P+Q&#x3D;RP + Q &#x3D; R P+Q&#x3D;R"><meta property=og:locale content=zh_CN><meta property=og:image content=http://vitock.github.io/2020/10/21/541a3f0129ff/p1.jpg><meta property=og:image content=http://vitock.github.io/2020/10/21/541a3f0129ff/p2.jpg><meta property=article:published_time content=2020-10-21T05:02:30.000Z><meta property=article:modified_time content=2021-08-12T02:14:02.852Z><meta property=article:author content=Vitock><meta property=article:tag content=ECC加密><meta property=article:tag content=椭圆曲线><meta property=article:tag content=模逆元><meta property=article:tag content=素数><meta name=twitter:card content=summary><meta name=twitter:image content=http://vitock.github.io/2020/10/21/541a3f0129ff/p1.jpg><link rel=canonical href=http://vitock.github.io/2020/10/21/541a3f0129ff/ ><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://vitock.github.io/2020/10/21/541a3f0129ff/","path":"2020/10/21/541a3f0129ff/","title":"ECC椭圆曲线加密"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>ECC椭圆曲线加密 |</title><script src=/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?49542d4f1ae3f2f35a0227ac6a0c62c6></script><noscript><link rel=stylesheet href=/css/noscript.css></noscript><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title></h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Vitock</div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#ecdh%E5%AF%86%E9%92%A5%E5%88%86%E5%8F%91%E7%AE%97%E6%B3%95><span class=nav-number>1.</span> <span class=nav-text>ECDH密钥分发算法</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#ecc-%E5%8A%A0%E5%AF%86%E8%BF%87%E7%A8%8B><span class=nav-number>2.</span> <span class=nav-text>Ecc 加密过程</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E8%A7%A3%E5%AF%86%E8%BF%87%E7%A8%8B><span class=nav-number>3.</span> <span class=nav-text>解密过程</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%A4%AD%E5%9C%86%E6%96%B9%E7%A8%8B%E7%9A%84%E6%B1%82%E8%A7%A3><span class=nav-number>4.</span> <span class=nav-text>椭圆方程的求解</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%A8%A1%E7%B4%A0%E6%95%B0p%E7%82%B9%E8%BF%90%E7%AE%97><span class=nav-number>5.</span> <span class=nav-text>模素数P点运算</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%A8%A1%E9%80%86%E5%85%83><span class=nav-number>5.1.</span> <span class=nav-text>模逆元</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%A4%A7%E7%BB%93%E5%B1%80><span class=nav-number>6.</span> <span class=nav-text>大结局</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%8E%A8%E8%8D%90%E8%B5%84%E6%96%99><span class=nav-number>6.1.</span> <span class=nav-text>推荐资料</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E4%B8%80%E4%B8%AAdemo><span class=nav-number>7.</span> <span class=nav-text>一个Demo</span></a></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class=site-overview><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Vitock src=/img/avatar/icon_0.webp><p class=site-author-name itemprop=name>Vitock<div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>51</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>50</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class=links-of-author-item><a href=https://github.com/vitock title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;vitock" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item><a href=https://weibo.com/2145843507/profile title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;2145843507&#x2F;profile" rel=noopener target=_blank><i class="fab fa-weibo fa-fw"></i>Weibo</a></span></div></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang=zh-CN><link itemprop=mainEntityOfPage href=http://vitock.github.io/2020/10/21/541a3f0129ff/ ><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=/img/avatar/icon_0.webp><meta itemprop=name content=Vitock><meta itemprop=description content=""></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=""></span><header class=post-header><h1 class=post-title itemprop="name headline">ECC椭圆曲线加密</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i> </span><span class=post-meta-item-text>发表于</span> <time title="创建时间：2020-10-21 13:02:30" itemprop="dateCreated datePublished" datetime=2020-10-21T13:02:30+08:00>2020-10-21</time></span></div></div></header><div class=post-body itemprop=articleBody><h2 id=ecdh密钥分发算法><a class=markdownIt-Anchor href=#ecdh密钥分发算法></a> ECDH密钥分发算法</h2><p>满足结合律交换律,根据几何图像,交换律显而易见,结合律未找到证明。<br>下面大写表示曲线上的点,小写表示数.<br>表示 PQ连线和曲线另外一个交点<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>R</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msup></mrow><annotation encoding=application/x-tex>R^{&#x27;}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.94248em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.94248em;margin-right:.05em><span class=pstrut style=height:2.57948em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>的x轴对称点R<br><img src=p1.jpg alt=""><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>+</mo><mi>Q</mi><mo>=</mo><mi>R</mi></mrow><annotation encoding=application/x-tex>P + Q = R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">Q</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span></span><p>表示,P点切线,与曲线交点的x轴对称点<br><img src=p2.jpg alt=""><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>+</mo><mi>P</mi><mo>+</mo><mi>P</mi><mo>=</mo><mn>2</mn><mo>⋅</mo><mi>P</mi><mo>+</mo><mi>P</mi><mo>=</mo><mn>3</mn><mi>P</mi></mrow><annotation encoding=application/x-tex>P + P + P = 2 \cdot P + P = 3P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>2</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord>3</span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span></span><p>已知 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=application/x-tex>P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span>为公钥, <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span>为私钥, <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span>为公共曲线参数<br>由<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span> 求 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=application/x-tex>P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span> 很容易,<br>由<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=application/x-tex>P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span> 和 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span> 求 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span> 很困难,<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>a</mi></msub><mo>=</mo><msub><mi>s</mi><mi>a</mi></msub><mo>⋅</mo><mi>G</mi></mrow><annotation encoding=application/x-tex>P_a =s_a \cdot G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.59445em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span></span><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>b</mi></msub><mo>=</mo><msub><mi>s</mi><mi>b</mi></msub><mo>⋅</mo><mi>G</mi></mrow><annotation encoding=application/x-tex>P_b = s_b \cdot G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.59445em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span></span><p>A 和 B 交换密钥流程<br>B 只用将 自己的私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>s</mi><mi>b</mi></msub></mrow><annotation encoding=application/x-tex>s_b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 乘 A的公钥 获得 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>K_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><br>A 只用将 自己的私钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>s</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>s_a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 乘 B的公钥 获得 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>K_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable rowspacing=0.24999999999999992em columnalign="right left" columnspacing=0em><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><msub><mi>K</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msub><mi>s</mi><mi>b</mi></msub><mo>⋅</mo><msub><mi>P</mi><mi>a</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msub><mi>s</mi><mi>b</mi></msub><mo>⋅</mo><msub><mi>s</mi><mi>a</mi></msub><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msub><mi>s</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>s</mi><mi>b</mi></msub><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msub><mi>s</mi><mi>a</mi></msub><mo>⋅</mo><mo stretchy=false>(</mo><msub><mi>s</mi><mi>b</mi></msub><mo>⋅</mo><mi>G</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msub><mi>s</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>P</mi><mi>b</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msub><mi>K</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} K_1 &amp;=s_b \cdot P_a\\ &amp;= s_b \cdot s_a \cdot G\\ &amp;= s_a \cdot s_b \cdot G\\ &amp;= s_a \cdot (s_b \cdot G)\\ &amp;= s_a \cdot P_b \\ &amp;= K_2 \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:9.000000000000002em;vertical-align:-4.250000000000001em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.750000000000001em><span style=top:-6.910000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-5.41em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-3.9099999999999993em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-2.4099999999999993em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-.9099999999999997em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:.5900000000000007em><span class=pstrut style=height:3em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:4.250000000000001em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4.750000000000001em><span style=top:-6.910000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-5.41em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span></span></span><span style=top:-3.9099999999999993em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span></span></span><span style=top:-2.4099999999999993em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span><span class=mclose>)</span></span></span><span style=top:-.9099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:.5900000000000007em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:4.250000000000001em><span></span></span></span></span></span></span></span></span></span></span></span><p>这样<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub></mrow><annotation encoding=application/x-tex>K_1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> , <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>K_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>相等,就完成了交换.<blockquote><p>两对密钥 公钥私钥交叉相乘结果相等<br>相乘是对应的椭圆曲线相乘法则</blockquote><h2 id=ecc-加密过程><a class=markdownIt-Anchor href=#ecc-加密过程></a> Ecc 加密过程</h2><p>加密过程实际上是用的 ecdh 随机生成一个 密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>K_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>,然后在用对称加密算法 例如 AES 等使用此 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>K_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 加密。<p>已知密钥对 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>=</mo><mi>s</mi><mo>⋅</mo><mi>G</mi></mrow><annotation encoding=application/x-tex>P = s \cdot G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.44445em;vertical-align:0></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span> (P公钥,s私钥)<p>随机生成一个密钥对 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>P_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>s</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>s_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><p>对应的加密<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mi>r</mi></msub><mo>=</mo><msub><mi>s</mi><mi>r</mi></msub><mo>⋅</mo><mi>P</mi></mrow><annotation encoding=application/x-tex>K_r= s_r \cdot P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.59445em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span></span><ul><li>然后使用AES , <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>K_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 加密 明文M获得密文C,把临时公钥 (<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>P_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> C)作为结果返回<li>同时为了解密时候能校验是否解密成功,需要返回一个校验量 MAC,<br>可以是 HMAC(<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>P_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>,<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>K_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>,C)<blockquote><p>如果AES加密是非密码本模式,需要返回初始化向量IV.<br>$K_r 是一个点,(X,Y)坐标编码成可加密的key,一般只需要 X坐标,因为Y坐标可以通过X坐标计算出来</blockquote></ul><h2 id=解密过程><a class=markdownIt-Anchor href=#解密过程></a> 解密过程</h2><p>从加密方获得 已知密文 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span>,和临时公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>P_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>, 校验参数MAC<br>自己保密的私钥<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>s</mi></mrow><annotation encoding=application/x-tex>s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span><ol><li>下面计算 对应的AES 密钥,</ol><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mrow><mn>2</mn><mi>r</mi></mrow></msub><mo>=</mo><mi>s</mi><mo>⋅</mo><msub><mi>P</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>K_{2r} = s \cdot P_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.44445em;vertical-align:0></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></span><p>参考 ECCDH密钥分发算法 ,两对ECC密钥的公钥私钥交叉相乘结果是一样的. <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mrow><mn>2</mn><mi>r</mi></mrow></msub><mo>=</mo><msub><mi>K</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>K_{2r} = K_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><blockquote><p>证明</blockquote><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable rowspacing=0.24999999999999992em columnalign="right left" columnspacing=0em><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><msub><mi>K</mi><mrow><mn>2</mn><mi>r</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mo>⋅</mo><msub><mi>P</mi><mi>r</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mo>⋅</mo><msub><mi>s</mi><mi>r</mi></msub><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mo>⋅</mo><mi>G</mi><mo>⋅</mo><msub><mi>s</mi><mi>r</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>P</mi><mo>⋅</mo><msub><mi>s</mi><mi>r</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msub><mi>K</mi><mi>r</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} K_ {2r} &amp;= s \cdot P_r \\ &amp;= s \cdot s_r \cdot G \\&amp;= s \cdot G \cdot s_r \\&amp;= P \cdot s_r \\&amp;= K_r\end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:7.500000000000002em;vertical-align:-3.5000000000000018em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4em><span style=top:-6.16em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-4.659999999999999em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-3.1599999999999984em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-1.6599999999999984em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-.15999999999999837em><span class=pstrut style=height:3em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.5000000000000018em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:4em><span style=top:-6.16em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-4.659999999999999em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span></span></span><span style=top:-3.1599999999999984em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-1.6599999999999984em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-.15999999999999837em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.5000000000000018em><span></span></span></span></span></span></span></span></span></span></span></span><ol start=2><li>验证是否是结果是否正确<br>计算<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>a</mi><mi>c</mi><mn>2</mn><mo>=</mo><mi>H</mi><mi>A</mi><mi>M</mi><mi>C</mi><mo stretchy=false>(</mo><msub><mi>P</mi><mi>r</mi></msub><mo separator=true>,</mo><msub><mi>K</mi><mrow><mn>2</mn><mi>r</mi></mrow></msub><mo separator=true>,</mo><mi>C</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>Mac2 = HAMC(P_r,K_{2r},C)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class=mord>2</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mclose>)</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>a</mi><mi>c</mi><mn>2</mn><mo>=</mo><mo>=</mo><mi>M</mi><mi>A</mi><mi>C</mi></mrow><annotation encoding=application/x-tex>Mac2 == MAC</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class=mord>2</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span> 说明数据正确,反之报错,终止解密<li>通过 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>K_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 进行对应的 AES 解密,进行解密获得明文<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>T</mi><mi>E</mi><mi>X</mi><mi>T</mi></mrow><annotation encoding=application/x-tex>TEXT</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>T</span><span class="mord mathdefault" style=margin-right:.05764em>E</span><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class="mord mathdefault" style=margin-right:.13889em>T</span></span></span></span><blockquote><p>如果需要初始化向量IV,也应该从加密方直接获取,加密方要把 iv mac 密文<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>C</mi></mrow><annotation encoding=application/x-tex>C</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span></span></span></span>, 临时公钥<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>P</mi><mi>r</mi></msub></mrow><annotation encoding=application/x-tex>P_r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 一起返回</blockquote></ol><p>这里有<a target=_blank rel=noopener href=http://iewl.herokuapp.com/www/ecc.html>一个在线加解密的网站</a>实现了上面的ECC 加密过程,<br>采用 AES-256-CBC,返回值里面有初始化向量<blockquote><p>网站的提供的默认公钥<br><code>BAjDe3ig3ZKh5xO0+aA5Zuakz2ukRfe0M3Jzg8nVFn/pnmD58qBX5Iwxk/IUNTm6TVZv7MZcXOcx0KzKORTMD4U=</code><p><code>私钥 fPtrf9iBkJTyEuCKbJuAxRoJEZJFOqPueQZ0mtsOC34=</code><br><br><br>曲线 secp256k1<br></blockquote><h2 id=椭圆方程的求解><a class=markdownIt-Anchor href=#椭圆方程的求解></a> 椭圆方程的求解</h2><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable width=100%><mtr><mtd width=50%></mtd><mtd><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow></mtd><mtd width=50%></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding=application/x-tex>y^2 = x^3 + ax + b \tag{1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.0585479999999998em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8641079999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.9474379999999999em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8641079999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span><span class=tag><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class="mord text"><span class=mord>(</span><span class=mord><span class=mord>1</span></span><span class=mord>)</span></span></span></span></span></span><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable width=100%><mtr><mtd width=50%></mtd><mtd><mrow><mi>y</mi><mo>−</mo><msub><mi>y</mi><mi>p</mi></msub><mo>=</mo><mi>k</mi><mo stretchy=false>(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>p</mi></msub><mo stretchy=false>)</mo></mrow></mtd><mtd width=50%></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding=application/x-tex>y - y_p = k (x-x_p) \tag{2}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.716668em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span></span><span class=tag><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class="mord text"><span class=mord>(</span><span class=mord><span class=mord>2</span></span><span class=mord>)</span></span></span></span></span></span><p>其中<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>k</mi><mo>=</mo><mfrac><mrow><msub><mi>y</mi><mi>p</mi></msub><mo>−</mo><msub><mi>y</mi><mi>q</mi></msub></mrow><mrow><msub><mi>x</mi><mi>p</mi></msub><mo>−</mo><msub><mi>x</mi><mi>q</mi></msub></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mtext>P != Q;连线的斜率</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>k</mi><mo>=</mo><mfrac><mrow><mn>3</mn><msubsup><mi>x</mi><mi>p</mi><mn>2</mn></msubsup><mo>+</mo><mi>a</mi></mrow><mrow><mn>2</mn><msub><mi>y</mi><mi>p</mi></msub></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mtext>P = Q;表示在该点切线的斜率,也就是导数</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding=application/x-tex>\begin{cases} k = \frac{y_p-y_q}{x_p-x_q} &amp; \text{P != Q;连线的斜率} \\[2ex] k = \frac{3x_p^2 + a}{2y_p} &amp; \text{P = Q;表示在该点切线的斜率,也就是导数} \\[2ex] \end{cases}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:4.8273399999999995em;vertical-align:-2.1636699999999998em></span><span class=minner><span class=mopen><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.65002em><span style=top:-1.8999899999999998em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style=top:-1.8999899999999998em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style=top:-2.1999899999999997em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style=top:-3.15001em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style=top:-4.30001em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style=top:-4.60001em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style=top:-4.90002em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.15002em><span></span></span></span></span></span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.6636699999999998em><span style=top:-4.88701em><span class=pstrut style=height:3.23134em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.915651em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285716em><span style=top:-2.357em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2818857142857143em><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285716em><span style=top:-2.357em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2818857142857143em><span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.50732em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285716em><span style=top:-2.357em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2818857142857143em><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285716em><span style=top:-2.357em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2818857142857143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.5423199999999999em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style=top:-2.36167em><span class=pstrut style=height:3.23134em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.2313399999999999em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285716em><span style=top:-2.357em;margin-left:-.03588em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2818857142857143em><span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.60742em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8913142857142857em><span style=top:-2.214em;margin-left:0;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.42488571428571426em><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.5423199999999999em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.1636699999999998em><span></span></span></span></span></span><span class=arraycolsep style=width:1em></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.6636699999999998em><span style=top:-4.88701em><span class=pstrut style=height:3.23134em></span><span class=mord><span class="mord text"><span class=mord>P != Q;</span><span class="mord cjk_fallback">连线的斜率</span></span></span></span><span style=top:-2.36167em><span class=pstrut style=height:3.23134em></span><span class=mord><span class="mord text"><span class=mord>P = Q;</span><span class="mord cjk_fallback">表示在该点切线的斜率</span><span class=mord>,</span><span class="mord cjk_fallback">也就是导数</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.1636699999999998em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>将 2 带入 1中,根据得到 ,根据<a target=_blank rel=noopener href=https://baike.baidu.com/item/%E9%9F%A6%E8%BE%BE%E5%AE%9A%E7%90%86>根与系数关系(韦达定理)</a><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable rowspacing=0.24999999999999992em columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><msub><mi>a</mi><mi>n</mi></msub><msup><mi>X</mi><mi>n</mi></msup><mo>+</mo><msub><mi>b</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>X</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi mathvariant=normal>.</mi><mi mathvariant=normal>.</mi><mi mathvariant=normal>.</mi><mo>+</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mi mathvariant=normal>.</mi><mi mathvariant=normal>.</mi><mi mathvariant=normal>.</mi><mo>+</mo><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><mfrac><msub><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>a</mi><mi>n</mi></msub></mfrac><mo separator=true>;</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mtext>*</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><msub><mi>x</mi><mn>0</mn></msub><mo>⋅</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><mi mathvariant=normal>.</mi><mi mathvariant=normal>.</mi><mi mathvariant=normal>.</mi><mo>⋅</mo><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><mo stretchy=false>(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy=false>)</mo><mi>n</mi></msup><mfrac><msub><mi>a</mi><mn>0</mn></msub><msub><mi>a</mi><mi>n</mi></msub></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} &amp; a_nX^n + b_{n-1}X^{n-1} + ... + a_0 = 0 \\ &amp; x_0 + x_1+ ... + x_n = \frac{a_{n-1} }{a_n} ; &amp;\text{*}\\ &amp; x_0 \cdot x_1 \cdot ... \cdot x_n = (-1)^n \frac{a_0}{a_n}\\[2ex] \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:6.397228em;vertical-align:-2.948614em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.448614em><span style=top:-5.6920660000000005em><span class=pstrut style=height:3.10756em></span><span class=mord></span></span><span style=top:-3.924506em><span class=pstrut style=height:3.10756em></span><span class=mord></span></span><span style=top:-1.6809459999999998em><span class=pstrut style=height:3.10756em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.948614em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.448614em><span style=top:-5.6920660000000005em><span class=pstrut style=height:3.10756em></span><span class=mord><span class=mord></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">b</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault" style=margin-right:.07847em>X</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>.</span><span class=mord>.</span><span class=mord>.</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>0</span></span></span><span style=top:-3.924506em><span class=pstrut style=height:3.10756em></span><span class=mord><span class=mord></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>.</span><span class=mord>.</span><span class=mord>.</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1075599999999999em><span style=top:-2.3139999999999996em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.8360000000000001em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mpunct>;</span></span></span><span style=top:-1.6809459999999998em><span class=pstrut style=height:3.10756em></span><span class=mord><span class=mord></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>.</span><span class=mord>.</span><span class=mord>.</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mopen>(</span><span class=mord>−</span><span class=mord>1</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1075599999999999em><span style=top:-2.3139999999999996em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.8360000000000001em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.948614em><span></span></span></span></span></span><span class=arraycolsep style=width:1em></span><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.924506em><span style=top:-3.924506em><span class=pstrut style=height:3.10756em></span><span class=mord><span class="mord text"><span class=mord>*</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.31905399999999995em><span></span></span></span></span></span></span></span></span></span></span></span><p>得到<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msub><mi>x</mi><mi>R</mi></msub><mo>=</mo><msup><mi>k</mi><mn>2</mn></msup><mo>−</mo><msub><mi>x</mi><mi>P</mi></msub><mo>−</mo><msub><mi>x</mi><mi>Q</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msub><mi>y</mi><mi>R</mi></msub><mo>=</mo><mo>−</mo><msub><mi>y</mi><mi>P</mi></msub><mo>+</mo><mi>k</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mi>P</mi></msub><mo>−</mo><msub><mi>x</mi><mi>R</mi></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=application/x-tex>\begin{cases} x_R = k^2 -x_P - x_Q\\ y_R = -y_P +k(x_P - x_R) \end{cases}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:3.0000299999999998em;vertical-align:-1.25003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">{</span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.69em><span style=top:-3.69em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>−</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.19em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><h2 id=模素数p点运算><a class=markdownIt-Anchor href=#模素数p点运算></a> 模素数P点运算</h2><p>上面的说明是实数上的运算, 会有小数的问题,计算机处理起来有困难;采用模素数运算,可以很好的解决这个问题,所有的<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo separator=true>,</mo><mi>y</mi></mrow><annotation encoding=application/x-tex>x,y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span>都是整数,并且根据公共点<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span>生成足够多的点,<p>上面的公式进一步变成<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msub><mi>x</mi><mi>R</mi></msub><mo>=</mo><msup><mi>k</mi><mn>2</mn></msup><mo>−</mo><msub><mi>x</mi><mi>P</mi></msub><mo>−</mo><msub><mi>x</mi><mi>Q</mi></msub><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msub><mi>y</mi><mi>R</mi></msub><mo>=</mo><mo>−</mo><msub><mi>y</mi><mi>P</mi></msub><mo>+</mo><mi>k</mi><mo stretchy=false>(</mo><msub><mi>x</mi><mi>P</mi></msub><mo>−</mo><msub><mi>x</mi><mi>R</mi></msub><mo stretchy=false>)</mo><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=application/x-tex>\begin{cases} x_R = k^2 -x_P - x_Q \pmod p \\ y_R = -y_P +k(x_P - x_R) \pmod p \end{cases}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:3.0000299999999998em;vertical-align:-1.25003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">{</span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.69em><span style=top:-3.69em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.328331em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>−</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.13889em>P</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.32833099999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.00773em>R</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.19em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>k</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>y</mi><mi>p</mi></msub><mo>−</mo><msub><mi>y</mi><mi>q</mi></msub><mo stretchy=false>)</mo><mo>⋅</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mi>p</mi></msub><mo>−</mo><msub><mi>x</mi><mi>q</mi></msub><msup><mo stretchy=false>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mi>k</mi><mo>=</mo><mo stretchy=false>(</mo><mn>3</mn><msubsup><mi>x</mi><mi>p</mi><mn>2</mn></msubsup><mo>+</mo><mi>a</mi><mo stretchy=false>)</mo><mo>⋅</mo><mo stretchy=false>(</mo><mn>2</mn><msub><mi>y</mi><mi>p</mi></msub><msup><mo stretchy=false>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=application/x-tex>\begin{cases} k = (y_p-y_q)\cdot(x_p-x_q)^{-1} \pmod p \\[2ex] k =(3x_p^2 + a)\cdot(2y_p)^{-1} \pmod p \\[2ex] \end{cases}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:4.604em;vertical-align:-2.052em></span><span class=minner><span class=mopen><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.35002em><span style=top:-2.19999em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style=top:-2.19999em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style=top:-3.1500100000000004em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style=top:-4.30001em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style=top:-4.60002em><span class=pstrut style=height:3.15em></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.8500199999999998em><span></span></span></span></span></span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.552em><span style=top:-4.552em><span class=pstrut style=height:3.008em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03588em>q</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mopen>(</span><span class=mord>3</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-2.4530000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.383108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">a</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class=mord>2</span><span class=mord><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.052em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>模素数P算法获取到的点已经绝大部分不再曲线了,全部分布在 [0 ,p-1] 这个正方形区间内.<h3 id=模逆元><a class=markdownIt-Anchor href=#模逆元></a> 模逆元</h3><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>b</mi><mo>=</mo><mn>1</mn><mspace></mspace><mspace width=1em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>ab = 1 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:1em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span></span><p>ab 互为模逆元,<br>这里 由于p 取的素数, a,b都小于p,那么a,b和p都互质数,<br>模逆元必定存在(充要条件.a 和p 互质,那么,b存在);<p>快速求模逆元,可以用<a target=_blank rel=noopener href=https://zh.wikipedia.org/wiki/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95>扩展欧几里得算法</a>,具体方式就是辗转相除,细节可以看百科<h2 id=大结局><a class=markdownIt-Anchor href=#大结局></a> 大结局</h2><p>这样,ECC加密过程基本清楚.<br>实际上,很多ECC文章写的ecc加密过程是这样<br>已知公钥 P,私钥s 消息 M,(也就是X,坐标,y坐标根据方程算出来);<br>加密过程 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>C</mi><mi>m</mi></msub><mo separator=true>,</mo><msub><mi>C</mi><mi>p</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(C_m,C_p)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.036108em;vertical-align:-.286108em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 为加密结果<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span></span></span></span>为随机数.作为临时私钥<br><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mi>p</mi></msub></mrow><annotation encoding=application/x-tex>C_p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span></span>临时公钥,和加密结果一起返回<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>C</mi><mi>m</mi></msub><mo>=</mo><mi>M</mi><mo>+</mo><mi>r</mi><mo>⋅</mo><mi>P</mi><mspace linebreak=newline></mspace><msub><mi>C</mi><mi>p</mi></msub><mo>=</mo><mi>r</mi><mo>⋅</mo><mi>G</mi><mspace linebreak=newline></mspace></mrow><annotation encoding=application/x-tex>C_m = M + r \cdot P \\ C_p = r \cdot G\\</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.44445em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.969438em;vertical-align:-.286108em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.44445em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span><span class="mspace newline"></span></span></span></span><p>解密过程,知道 C 和 S<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable rowspacing=0.24999999999999992em columnalign="right left" columnspacing=0em><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mi>M</mi></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>C</mi><mo>−</mo><mi>s</mi><mo>⋅</mo><msub><mi>C</mi><mi>p</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>M</mi><mo>+</mo><mi>r</mi><mo>⋅</mo><mi>P</mi><mo>−</mo><mi>s</mi><mo>⋅</mo><msub><mi>C</mi><mi>p</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>M</mi><mo>+</mo><mo stretchy=false>(</mo><mi>r</mi><mo>⋅</mo><mi>s</mi><mo>⋅</mo><mi>G</mi><mo>−</mo><mi>s</mi><mo>⋅</mo><mi>r</mi><mo>⋅</mo><mi>G</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>M</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} M &amp;= C - s \cdot C_p \\ &amp;= M + r \cdot P - s \cdot C_p \\ &amp;= M + (r\cdot s \cdot G - s \cdot r \cdot G)\\ &amp;= M \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:6em;vertical-align:-2.7500000000000004em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.25em><span style=top:-5.41em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span><span style=top:-3.91em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-2.4099999999999993em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-.9099999999999997em><span class=pstrut style=height:3em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.7500000000000004em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:3.25em><span style=top:-5.41em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span><span style=top:-3.91em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.15139200000000003em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.286108em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999993em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">s</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span><span class=mclose>)</span></span></span><span style=top:-.9099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.7500000000000004em><span></span></span></span></span></span></span></span></span></span></span></span><p>减法表示逆元,对于任意 点<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi><mo>+</mo><mo stretchy=false>(</mo><mo>−</mo><mi>P</mi><mo stretchy=false>)</mo><mo>=</mo><mi>O</mi></mrow><annotation encoding=application/x-tex>P + (-P) = O</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>−</span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.02778em>O</span></span></span></span><br>椭圆曲线零元是 无穷远处的点.作图可知<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=application/x-tex>P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span>点逆元表示P的x轴对称点 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>P</mi><msup><mrow></mrow><mo mathvariant=normal>′</mo></msup></msup></mrow><annotation encoding=application/x-tex>P^{&#x27;}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.94248em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.94248em><span style=top:-2.94248em;margin-right:.05em><span class=pstrut style=height:2.57948em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8278285714285715em><span style=top:-2.931em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><p>这种方式有一个缺点,就是计算过程比较麻烦,而且也是用到了dh秘钥交换的方式。<br>所以很多加密实现都是直接用 ecdh方式商定一个共同的随机私钥，再通过AES等对称加密方式进行加密，从而加速运算。<h3 id=推荐资料><a class=markdownIt-Anchor href=#推荐资料></a> 推荐资料</h3><p><a target=_blank rel=noopener href=https://zhuanlan.zhihu.com/p/143122476>零知识证明 - 椭圆曲线基础</a><h2 id=一个demo><a class=markdownIt-Anchor href=#一个demo></a> 一个Demo</h2><p>一个小demo,第一次加解密可能比较慢,(服务器可能还没load)<blockquote><p>heroku app 免费版30分钟休眠<br><br>密钥不匹配无法解密的</blockquote><style>.eccbtn{margin-top:20px;margin-bottom:20px;height:40px;line-height:40px;color:#fff;font-size:15px;border-radius:5px;align-items:center;justify-content:center;text-align:center}.genbtn{background-color:grey;width:200px;font-size:15px}.encbtn{background-color:#6495ed;width:60px}.decbtn{background-color:orange;width:60px;font-size:15px}.row{display:inline-flex}.tv{width:80%;height:150px;font-size:15px}#encresult{font-size:13px}input{width:80%;font-size:15px}</style><script src=https://libs.baidu.com/jquery/2.0.0/jquery.min.js></script><div class="eccbtn genbtn" id=genkeypair>重新生成密钥对</div><div class=row>私钥</div><input class=row id=prikey autocomplete=off><div></div><div class=row>公钥</div><input class=row id=pubkey autocomplete=off><div></div><div class="eccbtn encbtn row" id=enc>加密</div><div class="eccbtn decbtn row" id=dec>解密</div><div>明文</div><textarea class=tv id=msg placeholder=需要加密的明文 autocomplete=off></textarea><div>密文</div><textarea class=tv id=encresult placeholder=需要解密的密文 autocomplete=off></textarea><script>var msg="\n     周南·关雎\n     关关雎鸠，在河之洲。窈窕淑女，君子好逑。\n     参差荇菜，左右流之。窈窕淑女，寤寐求之。\n     求之不得，寤寐思服。悠哉悠哉，辗转反侧。\n     参差荇菜，左右采之。窈窕淑女，琴瑟友之。\n     参差荇菜，左右芼之。窈窕淑女，钟鼓乐之。",pri="tBy5/x8zXMjJF2y5oqHrTBhwOYmHA4kipqcN5DCHB4s=",pub="BPSvb5qEaDRr6btDb+J/UK0MdAsldBNelCKJ5WLnhp8c7D2AVPjj+Vf30QmNsV+4Sq5xt7rp7k/B+zRHRf/f+58=",encresult="AAAQACAAQQAUBZCFkCOp0DrKsOKbHlrYVxlCalHTIL68n7gHbTewfLUKnLk+8MnoVIz0v5MsItgE1yTXUjsrjRT/FoEpH9zpvds33iXz19UyIMsSFX0Kyknefmc6JGiM/58tXv/2KoGSyzgy/dheOnaRYhWdihKKM6hKAwzFQmj4b17TB/acEHQeb4hHp6TcKEHlCc/Hj+PKtQMUD+hwUki0OmGZSMRCcCZhMTQMvZc0o2zaJeSQAnqDHpaaKdmBF5GETthPI0UBH7zHeMXT1DKFnWKKgd/bvg4zgMhNUr+vjNfNYN/wXadjCstHtfxvteMMVuhSy0GECGWqto8X40Sz/YPu/In1Gv7wRtY5xfcBaJXCitmn1FQ55Zd/woKF51a6vWqVC1OePAAaXQzGVUAFkiXfujmSRLI/MCEiOip37ubPWLmzQNKJHd/A5YMjmJQugJzViFVjIbL6NC1Q0zJZweQfNa8FbuYPa+nEunGgyLLT3BCYlY8jlTv8JYdl+L06vOY4ZoOI+EVg7+l2tCt17a+toRqSte3DgnP83xWqhJB+wxDoRQ9+KVXLcxBckbhsGxxQwtfEQPD90y5f7DMOgn248PImhT8jh5OKr6Nv46IiBh6Wlqlmm2J1q8lGchlKC9z3lZ8IHEJW1twohqiM7QRUzdtBVCkLmdHD+c1/ogzlvsA7AAy0uXU8AV1XL2vVcod1Iqw+nO4QAoH9k1E++hiWZdzB1/Dpur8thM21u4qRtsgW5E2CpR0Cem+g5NA8nuXdXH7HOonzTCTrCkgeYVvGLwZouflPFQwWhZ49JmG3RleYVBc=";$("#pubkey").val(pub),$("#prikey").val(pri),$("#msg").val(msg),$("#encresult").val(encresult),console.log(pri,pub,encresult),$("#genkeypair").click((function(){$.ajax({url:"//lwx01.herokuapp.com/gen_ecc?t="+(new Date).getTime(),type:"Get",dataType:"json",error:function(e){console.log(e),alert("出错"+JSON.stringify(e))},success:function(e){$("#prikey").val(e.privatekey),$("#pubkey").val(e.publickey)}})})),$("#enc").click((function(){var e=$("#pubkey").val();if(e){var l=$("#msg").val();l?($("#encresult").val("加密中..."),$.ajax({url:"//lwx01.herokuapp.com/ecc_enc?",type:"Post",dataType:"json",data:{msg:l,pubkey:e},error:function(e){alert("出错"+JSON.stringify(e))},success:function(e){$("#encresult").val(e.enc||e.err)}})):alert("请填写需要加密的明文信息")}else alert("请先填写公钥")})),$("#dec").click((function(){$("#dec").removeClass("scale");var e=$("#prikey").val();if(e){var l=$("#encresult").val();l?($("#msg").val("解密中..."),$.ajax({url:"//lwx01.herokuapp.com/ecc_dec?",type:"Post",dataType:"json",data:{msg:l,prikey:e},error:function(e){console.log(e),alert("出错"+JSON.stringify(e))},success:function(e){$("#msg").val(e.dec||e.err)}})):alert("请填写需要解密的密文")}else alert("请先填写私钥")}))</script></div><div class=popular-posts-header>相关文章</div><ul class=popular-posts><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/07/29/d9aa54d24287/ rel=bookmark>ECDSA 签名算法</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/07/817093e2f777/ rel=bookmark>扩展欧几里得算法</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/02/e68ed72c802a/ rel=bookmark>RSA</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/07/42fede76182f/ rel=bookmark>Miller-Rabin素数测试算法</a></div></ul><footer class=post-footer><div class=post-tags><a href=/tags/ECC%E5%8A%A0%E5%AF%86/ rel=tag><i class="fa fa-tag"></i> ECC加密</a> <a href=/tags/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/ rel=tag><i class="fa fa-tag"></i> 椭圆曲线</a> <a href=/tags/%E6%A8%A1%E9%80%86%E5%85%83/ rel=tag><i class="fa fa-tag"></i> 模逆元</a> <a href=/tags/%E7%B4%A0%E6%95%B0/ rel=tag><i class="fa fa-tag"></i> 素数</a></div><div class=post-nav><div class=post-nav-item><a href=/2020/07/20/5271286d2fa7/ rel=prev title=报名成功><i class="fa fa-chevron-left"></i> 报名成功</a></div><div class=post-nav-item><a href=/2020/10/28/84b0abdd036f/ rel=next title="hexo 从 travis 迁移到 azure devops">hexo 从 travis 迁移到 azure devops <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; <span itemprop=copyrightYear>2021</span> <span class=with-love><i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Vitock</span></div></div></footer><script src=https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/next-boot.js></script><script src=/js/pjax.js></script><script class=next-config data-name=enableMath type=application/json>true</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity="sha256-55Ddc47WvWTK5vYVejnAuSK7USJaL7FQXrzQ4HiQ1WY=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin=anonymous><script class=next-config data-name=gitalk type=application/json>{"enable":true,"github_id":"vitock","repo":"vitock.github.io","client_id":"e7f10b97367d65ffb9e5","client_secret":"2e83b75434ccccb749d08eddbb0599330d46835e","admin_user":"vitock","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en | zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"4c0ceecf9105b7029ea93846150d4bb2"}</script><script src=/js/third-party/comments/gitalk.js></script>
