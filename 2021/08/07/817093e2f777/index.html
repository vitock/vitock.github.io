<!doctype html><html lang=zh-CN><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222><meta name=generator content="Hexo 5.2.0"><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-next.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32-next.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16-next.png><link rel=mask-icon href=/images/logo.svg color=#222><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><script class=next-config data-name=main type=application/json>{"hostname":"vitock.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src=/js/config.js></script><meta name=description content="前面的笔记中,ECDH,ECDSA, RSA等整数模素数的操作,都需要用到模逆元 本文介绍 扩展欧几里德算法快速求模逆元 ed&#x3D;1(modn)e d &#x3D; 1\pmod n  ed&#x3D;1(modn)"><meta property=og:type content=article><meta property=og:title content=扩展欧几里得算法><meta property=og:url content=http://vitock.github.io/2021/08/07/817093e2f777/index.html><meta property=og:site_name><meta property=og:description content="前面的笔记中,ECDH,ECDSA, RSA等整数模素数的操作,都需要用到模逆元 本文介绍 扩展欧几里德算法快速求模逆元 ed&#x3D;1(modn)e d &#x3D; 1\pmod n  ed&#x3D;1(modn)"><meta property=og:locale content=zh_CN><meta property=article:published_time content=2021-08-07T01:23:34.000Z><meta property=article:modified_time content=2021-08-12T02:14:02.852Z><meta property=article:author content=Vitock><meta property=article:tag content=模逆元><meta property=article:tag content=素数><meta property=article:tag content=RSA><meta property=article:tag content=ECC><meta name=twitter:card content=summary><link rel=canonical href=http://vitock.github.io/2021/08/07/817093e2f777/ ><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://vitock.github.io/2021/08/07/817093e2f777/","path":"2021/08/07/817093e2f777/","title":"扩展欧几里得算法"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>扩展欧几里得算法 |</title><script src=/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?49542d4f1ae3f2f35a0227ac6a0c62c6></script><noscript><link rel=stylesheet href=/css/noscript.css></noscript><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title></h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Vitock</div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95%E6%B1%82%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0><span class=nav-number>1.</span> <span class=nav-text>欧几里得算法求最大公约数</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95><span class=nav-number>2.</span> <span class=nav-text>扩展欧几里得算法</span></a></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class=site-overview><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Vitock src=/img/avatar/icon_0.webp><p class=site-author-name itemprop=name>Vitock<div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>51</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>50</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class=links-of-author-item><a href=https://github.com/vitock title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;vitock" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item><a href=https://weibo.com/2145843507/profile title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;2145843507&#x2F;profile" rel=noopener target=_blank><i class="fab fa-weibo fa-fw"></i>Weibo</a></span></div></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang=zh-CN><link itemprop=mainEntityOfPage href=http://vitock.github.io/2021/08/07/817093e2f777/ ><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=/img/avatar/icon_0.webp><meta itemprop=name content=Vitock><meta itemprop=description content=""></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=""></span><header class=post-header><h1 class=post-title itemprop="name headline">扩展欧几里得算法</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i> </span><span class=post-meta-item-text>发表于</span> <time title="创建时间：2021-08-07 09:23:34" itemprop="dateCreated datePublished" datetime=2021-08-07T09:23:34+08:00>2021-08-07</time></span></div></div></header><div class=post-body itemprop=articleBody><p>前面的笔记中,ECDH,ECDSA, RSA等整数模素数的操作,都需要用到模逆元<p>本文介绍<br>扩展欧几里德算法快速求模逆元<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>e</mi><mi>d</mi><mo>=</mo><mn>1</mn><mspace></mspace><mspace width=1em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>n</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>e d = 1\pmod n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:1em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">n</span><span class=mclose>)</span></span></span></span></span><p><strong>裴蜀定理(贝祖等式):</strong><br>若<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mo separator=true>,</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>a,b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">a</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span></span></span></span>是整数,且<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy=false>(</mo><mi>a</mi><mo separator=true>,</mo><mi>b</mi><mo stretchy=false>)</mo><mo>=</mo><mi>d</mi></mrow><annotation encoding=application/x-tex>gcd(a,b)=d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class=mopen>(</span><span class="mord mathdefault">a</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">b</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>，那么对于任意的整数<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo separator=true>,</mo><mi>y</mi></mrow><annotation encoding=application/x-tex>x,y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span>,<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi></mrow><annotation encoding=application/x-tex>ax+by</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span>都一定是<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>的倍数，特别地，<br>一定存在整数<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo separator=true>,</mo><mi>y</mi></mrow><annotation encoding=application/x-tex>x,y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span>，使<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mi>d</mi></mrow><annotation encoding=application/x-tex>ax+by=d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span>成立。<p>推论:a ,b 互质的充要条件就是 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>ax +by = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span><h2 id=欧几里得算法求最大公约数><a class=markdownIt-Anchor href=#欧几里得算法求最大公约数></a> 欧几里得算法求最大公约数</h2><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi></mrow><annotation encoding=application/x-tex>d</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span></span></span></span> 是 a,b 的最大公约数(Greatest Common Divisor )<br>由 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mi>k</mi><mi>d</mi></mrow><annotation encoding=application/x-tex>ax +by = kd</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class="mord mathdefault">d</span></span></span></span> 知道,我们通过选取不同x,y可以逐步让k小,一直到0,那么前一次 肯定就是<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>k = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>,<p>可以让大数减去小的,获得的差取代大数,然后在不停迭代。<figure class="highlight plain"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line>例如 a &#x3D; 78 &#x3D; 3 * 13 * 2 ,b&#x3D; 28 &#x3D; 2 * 7 </span><br><span class=line></span><br><span class=line>78 - 28 &#x3D; 50 ,   a&#x3D; 50 , b &#x3D; 28</span><br><span class=line>50 - 28 &#x3D; 22 ,   a &#x3D; 22 ,b &#x3D; 28</span><br><span class=line>28 - 22 &#x3D; 6 ,    a &#x3D; 28,b &#x3D; 6</span><br><span class=line>28 - 6 * 4 &#x3D; 4 ,  a &#x3D; 4 ,b &#x3D; 6  &#x2F;&#x2F;&#x2F; 这里连续减法,重复步骤直接用乘法</span><br><span class=line>6 - 4 &#x3D; 2 ,       a &#x3D; 2 ,b &#x3D; 4  </span><br><span class=line>4 - 2 * 2 &#x3D; 0   &#x2F;&#x2F; 上一步的余数 2 就是最大公约数 </span><br></pre></table></figure><h2 id=扩展欧几里得算法><a class=markdownIt-Anchor href=#扩展欧几里得算法></a> 扩展欧几里得算法</h2><p>由于a,b 互质.<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>ax + by = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span><p>这里假定 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>b</mi></mrow><annotation encoding=application/x-tex>a &lt; b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">a</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span></span></span></span><br>我们正常欧几里得算法过程<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mspace linebreak=newline></mspace><msub><mi>k</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi><mo separator=true>,</mo><mspace linebreak=newline></mspace><mo>−</mo><msub><mi>k</mi><mn>0</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mspace linebreak=newline></mspace><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>k</mi><mn>0</mn></msub><mo>=</mo><msub><mi>k</mi><mn>2</mn></msub><mspace linebreak=newline></mspace><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mo>=</mo><msub><mi>k</mi><mn>3</mn></msub><mspace linebreak=newline></mspace><mo>−</mo><msub><mi>k</mi><mn>3</mn></msub><msub><mi>x</mi><mn>4</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><mi>k</mi><mn>4</mn><mspace linebreak=newline></mspace><mi mathvariant=normal>⋮</mi><mpadded height=+0em voffset=0em><mspace mathbackground=black width=0em height=1.5em></mspace></mpadded><mspace linebreak=newline></mspace><mo>−</mo><msub><mi>k</mi><mi>i</mi></msub><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>k</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><mspace width=1em><msub><mi>k</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>k</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo stretchy=false>⌊</mo><mrow><msub><mi>k</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant=normal>/</mi><msub><mi>k</mi><mi>i</mi></msub></mrow><mo stretchy=false>⌋</mo><mspace linebreak=newline></mspace><mi mathvariant=normal>⋮</mi><mpadded height=+0em voffset=0em><mspace mathbackground=black width=0em height=1.5em></mspace></mpadded><mspace linebreak=newline></mspace><mspace linebreak=newline></mspace><mo>−</mo><msub><mi>k</mi><mi>n</mi></msub><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>k</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mi mathvariant=normal>这</mi><mi mathvariant=normal>里</mi><mi mathvariant=normal>可</mi><mi mathvariant=normal>以</mi><mi mathvariant=normal>终</mi><mi mathvariant=normal>止</mi><mo separator=true>,</mo><mi>a</mi><mi>b</mi><mi mathvariant=normal>互</mi><mi mathvariant=normal>质</mi><mo separator=true>,</mo><mi mathvariant=normal>最</mi><mi mathvariant=normal>大</mi><mi mathvariant=normal>公</mi><mi mathvariant=normal>约</mi><mi mathvariant=normal>数</mi><mi mathvariant=normal>一</mi><mi mathvariant=normal>定</mi><mi mathvariant=normal>是</mi><mn>1</mn></mrow><annotation encoding=application/x-tex>\\ k_0 = a , \\ - k_0x_1 + b = k_1 \\ - k_1 x_2 + k_0 = k_2 \\ - k_2 x_3 + k_1 = k_3 \\ - k_3 x_4 + k_2 = k4 \\ \vdots \\ - k_i x_{i+1} + k_{i-1} = k_{i+1} ,\quad k_i &lt; k_{i-1 } , x_{i+1} = \lfloor{k_{i+1}/k_{i}} \rfloor \\ \vdots \\ \\ - k_n x_{n+1} + k_{n-1} = 1 ,这里可以终止,ab 互质,最大公约数一定是1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class="mspace newline"></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">a</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord>−</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">b</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mord>4</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:1.53em;vertical-align:-.03em></span><span class=mord><span class=mord>⋮</span><span class="mord rule" style=border-right-width:0;border-top-width:1.5em;bottom:0></span></span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:1em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>⌊</span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.311664em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mord>/</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.31166399999999994em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span><span class=mclose>⌋</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:1.53em;vertical-align:-.03em></span><span class=mord><span class=mord>⋮</span><span class="mord rule" style=border-right-width:0;border-top-width:1.5em;bottom:0></span></span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class="mspace newline"></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">里</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">终</span><span class="mord cjk_fallback">止</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">b</span><span class="mord cjk_fallback">互</span><span class="mord cjk_fallback">质</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">大</span><span class="mord cjk_fallback">公</span><span class="mord cjk_fallback">约</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">是</span><span class=mord>1</span></span></span></span></span><p>构造 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>ax + by = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span><br><strong><s>思路 1(走不通)</s></strong><p>注意到,倒数第1步中有<span class=katex><span class=katex-mathml><math><semantics><mrow><mo>⋯</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\dots =1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=minner>⋯</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span>的等式,<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mo>−</mo><msub><mi>k</mi><mi>n</mi></msub><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>k</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>- k_n x_{n+1} + k_{n-1} = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord>−</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></span><p>将<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mo>…</mo></mrow><annotation encoding=application/x-tex>k_{n-1} = \dots</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.12em;vertical-align:0></span><span class=minner>…</span></span></span></span> 依次代入.<p>很遗憾,这样会有另外一个常数,会得到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>+</mo><mi>C</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>ax + by + C = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>C</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> 形式的方程，这个不是我们想要的。<p><strong>思路2</strong><p>类似于求斐波那契数列构造<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>F</mi><mi>n</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>F</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow><mo>=</mo><mi>A</mi><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>F</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>F</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow></mrow><annotation encoding=application/x-tex>\begin{bmatrix} F_n \\ F_{n-1} \end{bmatrix} = A \begin{bmatrix} F_{n-1} \\ F_{n-2} \end{bmatrix}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:2.40003em;vertical-align:-.95003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.40003em;vertical-align:-.95003em></span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.13889em>F</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span></span></span></span></span><p>由上面的递推公式，<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mo>−</mo><msub><mi>k</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><msub><mi>k</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>=</mo><msub><mi>k</mi><mi>n</mi></msub><mspace linebreak=newline></mspace><mo>⇓</mo><mspace linebreak=newline></mspace><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>k</mi><mi>n</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>k</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow><mo>=</mo><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mo>−</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>k</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>k</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow></mrow><annotation encoding=application/x-tex>- k_{n-1} x_{n} + k_{n-2} = k_{n} \\ \Downarrow \\ \begin{bmatrix} k_{n} \\ k_{n-1} \end{bmatrix} = \begin{bmatrix} -x_n &amp; 1 \\ 1 &amp; 0 \end{bmatrix} \begin{bmatrix} k_{n-1} \\ k_{n-2} \end{bmatrix}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord>−</span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.902771em;vertical-align:-.208331em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mrel>⇓</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:2.40003em;vertical-align:-.95003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.40003em;vertical-align:-.95003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>−</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span></span></span></span></span><p>逐步展开,一直到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>b</mi><mo separator=true>,</mo><mi>a</mi></mrow><annotation encoding=application/x-tex>b, a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">a</span></span></span></span> ,这里 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mo>=</mo><msub><mi>k</mi><mn>0</mn></msub></mrow><annotation encoding=application/x-tex>a = k_0</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>,<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>k</mi><mi>n</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>k_n = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.84444em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span> (互质,取到最大公约数)<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msub><mi>k</mi><mi>n</mi></msub><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow><mo>=</mo><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><msub><mi>k</mi><mi>n</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msub><mi>k</mi><mi>n</mi></msub><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow><mo>=</mo><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mo>−</mo><msub><mi>x</mi><mi>n</mi></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mo>−</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow><mo>…</mo><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=false><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow><mrow><mo fence=true>[</mo><mtable rowspacing=0.15999999999999992em columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mi>a</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mi>b</mi></mstyle></mtd></mtr></mtable><mo fence=true>]</mo></mrow></mrow><annotation encoding=application/x-tex>\begin{bmatrix} 1 \\ k_n-1 \end{bmatrix} = \begin{bmatrix} k_n \\ k_n-1 \end{bmatrix} = \begin{bmatrix} -x_n &amp; 1\\ 1 &amp; 0 \end{bmatrix} \begin{bmatrix} -x_{n-1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix} \dots \begin{bmatrix} -x_{1} &amp; 1 \\ 1 &amp; 0 \end{bmatrix} \begin{bmatrix} a\\ b \end{bmatrix}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:2.40003em;vertical-align:-.95003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.40003em;vertical-align:-.95003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.03148em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:2.40003em;vertical-align:-.95003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>−</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>−</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>…</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>−</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">[</span></span><span class=mord><span class=mtable><span class=col-align-c><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.45em><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault">a</span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9500000000000004em><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">]</span></span></span></span></span></span></span><p>这样,我们迭代欧几里德算法时候,同步算出矩阵的乘积.<p>到最后,矩阵的 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>11</mn></msub><mo>=</mo><mi>x</mi></mrow><annotation encoding=application/x-tex>m_{11} = x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span></span></span></span> 是模逆元, <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>m</mi><mn>12</mn></msub><mo>=</mo><mi>y</mi></mrow><annotation encoding=application/x-tex>m_{12} = y</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span></span> 是方程的根,<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>ax + by = 1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style=margin-right:.03588em>y</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></span><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mi mathvariant=normal>为</mi><mi>a</mi><mi mathvariant=normal>的</mi><mi mathvariant=normal>模</mi><mi>b</mi><mi mathvariant=normal>逆</mi><mi mathvariant=normal>元</mi></mrow><annotation encoding=application/x-tex>x 为 a 的模b 逆元</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">x</span><span class="mord cjk_fallback">为</span><span class="mord mathdefault">a</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">模</span><span class="mord mathdefault">b</span><span class="mord cjk_fallback">逆</span><span class="mord cjk_fallback">元</span></span></span></span><p>下面是一个demo代码. 参数内建都是Number类型,大小有限制,作为原理演示。<figure class="highlight javascript"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br></pre><td class=code><pre><span class=line></span><br><span class=line><span class=comment>/// 欧几里得算法,求最大公约数</span></span><br><span class=line><span class=function><span class=keyword>function</span> <span class=title>gcd</span>(<span class=params>a,b,r0</span>)</span>&#123;</span><br><span class=line>    <span class=keyword>var</span> r = b % a  ;<span class=comment>// b % a;</span></span><br><span class=line>    <span class=keyword>if</span> (r == <span class=number>0</span>) &#123;</span><br><span class=line>        <span class=keyword>return</span> a;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>return</span> gcd(r,a);</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=comment>/*</span></span><br><span class=line><span class=comment>* 扩展欧几里得算法,求a 的模 b 逆元 </span></span><br><span class=line><span class=comment>* ax + by = 1;</span></span><br><span class=line><span class=comment>*/</span></span><br><span class=line><span class=function><span class=keyword>function</span> <span class=title>exGcd</span>(<span class=params>a,b</span>)</span>&#123;</span><br><span class=line></span><br><span class=line>    <span class=comment>/**</span></span><br><span class=line><span class=comment>     * 2x2 矩阵,用数组表示 A x B</span></span><br><span class=line><span class=comment>     * <span class=doctag>@param <span class=type>&#123;*&#125;</span> <span class=variable>A</span></span></span></span><br><span class=line><span class=comment>     * <span class=doctag>@param <span class=type>&#123;*&#125;</span> </span>B </span></span><br><span class=line><span class=comment>     */</span></span><br><span class=line>    <span class=function><span class=keyword>function</span> <span class=title>matrixMultiply</span>(<span class=params>A,B</span>)</span>&#123;</span><br><span class=line></span><br><span class=line></span><br><span class=line>        <span class=keyword>return</span> [A[<span class=number>0</span>] * B[<span class=number>0</span>] + A[<span class=number>1</span>] * B[<span class=number>2</span>],A[<span class=number>0</span>] * B[<span class=number>1</span>] + A[<span class=number>1</span>] * B[<span class=number>3</span>],</span><br><span class=line></span><br><span class=line>        A[<span class=number>2</span>] * B[<span class=number>0</span>] + A[<span class=number>3</span>] * B[<span class=number>2</span>] , A[<span class=number>2</span>] * B[<span class=number>1</span>] + A[<span class=number>3</span>] * B[<span class=number>3</span>]];</span><br><span class=line>    </span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>function</span> <span class=title>_exGcd</span>(<span class=params>a,b</span>)</span>&#123;</span><br><span class=line>         <span class=comment>/**</span></span><br><span class=line><span class=comment>         *   | xn  1 |  ... | x1 1|  * | a |  =  | 1 |</span></span><br><span class=line><span class=comment>         *   | 1   0 |      | 1  0|    | b |  =  | k |</span></span><br><span class=line><span class=comment>         */</span></span><br><span class=line>        <span class=keyword>var</span> s = b % a ;</span><br><span class=line>        <span class=keyword>var</span> q = (b - s  ) /a ;</span><br><span class=line></span><br><span class=line>        <span class=function><span class=title>if</span>(<span class=params>s == <span class=number>1</span></span>)</span>&#123; <span class=comment>//终止</span></span><br><span class=line>            <span class=keyword>return</span>  [-q,<span class=number>1</span>,   <span class=number>1</span>,<span class=number>0</span>]</span><br><span class=line>        &#125;</span><br><span class=line>        <span class=keyword>else</span> <span class=function><span class=title>if</span>(<span class=params>s == <span class=number>0</span></span>)</span>&#123;</span><br><span class=line></span><br><span class=line>            <span class=comment>/// error 不互质,除非 a == 1</span></span><br><span class=line>            <span class=keyword>return</span> [<span class=number>0</span>,<span class=number>0</span>,<span class=number>0</span>,<span class=number>0</span>];</span><br><span class=line>        &#125;</span><br><span class=line></span><br><span class=line>        <span class=keyword>const</span> matrix0 = [-q,<span class=number>1</span> ,<span class=number>1</span>,<span class=number>0</span>];</span><br><span class=line>        <span class=keyword>const</span> matrix1 = _exGcd(s,a);</span><br><span class=line>        <span class=keyword>return</span> matrixMultiply(matrix1,matrix0);</span><br><span class=line>    &#125;</span><br><span class=line> </span><br><span class=line></span><br><span class=line>    <span class=comment>/// 1 的逆元是本身</span></span><br><span class=line>    <span class=keyword>if</span> (a == <span class=number>1</span>) &#123;</span><br><span class=line>        <span class=keyword>return</span> <span class=number>1</span>;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=comment>// 0 无逆元</span></span><br><span class=line>    <span class=keyword>if</span> (a == <span class=number>0</span>) &#123;</span><br><span class=line>        <span class=keyword>return</span> <span class=number>0</span>;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=function><span class=title>if</span>(<span class=params>a &gt; b</span>)</span> &#123;</span><br><span class=line>        a = a % b ;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>var</span> m = _exGcd(a,b);</span><br><span class=line>    </span><br><span class=line>    <span class=comment>/// a * m[0] + b m[1] = 1;</span></span><br><span class=line>    <span class=keyword>return</span> (m[<span class=number>0</span>] % b + b) % b;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>var</span> b = <span class=number>10</span>;</span><br><span class=line><span class=function><span class=title>for</span>(<span class=params><span class=keyword>var</span> a = <span class=number>1</span> ;a &lt; b ; ++ a </span>)</span>&#123;</span><br><span class=line>    <span class=keyword>var</span> c = exGcd(a,b);</span><br><span class=line>    <span class=keyword>if</span> (c == <span class=number>0</span> || c == <span class=number>1</span>) &#123;</span><br><span class=line>        <span class=comment>// console.log(&#x27;-----&#x27; ,a)</span></span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>else</span> <span class=function><span class=title>if</span>(<span class=params>a * c %b == <span class=number>1</span></span>)</span>&#123;</span><br><span class=line>        <span class=built_in>console</span>.log(c , a   , <span class=string>` <span class=subst>$&#123;c&#125;</span> * <span class=subst>$&#123;a&#125;</span> % <span class=subst>$&#123;b&#125;</span>  = <span class=subst>$&#123;a * c %b &#125;</span>`</span>);</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line></span><br><span class=line></span><br></pre></table></figure></div><div class=popular-posts-header>相关文章</div><ul class=popular-posts><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/07/42fede76182f/ rel=bookmark>Miller-Rabin素数测试算法</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2020/10/21/541a3f0129ff/ rel=bookmark>ECC椭圆曲线加密</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/07/29/d9aa54d24287/ rel=bookmark>ECDSA 签名算法</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/02/e68ed72c802a/ rel=bookmark>RSA</a></div></ul><footer class=post-footer><div class=post-tags><a href=/tags/%E6%A8%A1%E9%80%86%E5%85%83/ rel=tag><i class="fa fa-tag"></i> 模逆元</a> <a href=/tags/%E7%B4%A0%E6%95%B0/ rel=tag><i class="fa fa-tag"></i> 素数</a> <a href=/tags/RSA/ rel=tag><i class="fa fa-tag"></i> RSA</a> <a href=/tags/ECC/ rel=tag><i class="fa fa-tag"></i> ECC</a></div><div class=post-nav><div class=post-nav-item><a href=/2021/08/07/42fede76182f/ rel=prev title=Miller-Rabin素数测试算法><i class="fa fa-chevron-left"></i> Miller-Rabin素数测试算法</a></div><div class=post-nav-item></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; <span itemprop=copyrightYear>2021</span> <span class=with-love><i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Vitock</span></div></div></footer><script src=https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/next-boot.js></script><script src=/js/pjax.js></script><script class=next-config data-name=enableMath type=application/json>false</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity="sha256-55Ddc47WvWTK5vYVejnAuSK7USJaL7FQXrzQ4HiQ1WY=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin=anonymous><script class=next-config data-name=gitalk type=application/json>{"enable":true,"github_id":"vitock","repo":"vitock.github.io","client_id":"e7f10b97367d65ffb9e5","client_secret":"2e83b75434ccccb749d08eddbb0599330d46835e","admin_user":"vitock","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en | zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"47d9f17abdea7facf6b8fc5b66976b6e"}</script><script src=/js/third-party/comments/gitalk.js></script>
