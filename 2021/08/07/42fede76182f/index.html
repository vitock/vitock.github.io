<!doctype html><html lang=zh-CN><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222><meta name=generator content="Hexo 5.2.0"><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-next.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32-next.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16-next.png><link rel=mask-icon href=/images/logo.svg color=#222><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><script class=next-config data-name=main type=application/json>{"hostname":"vitock.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src=/js/config.js></script><meta name=description content="Miller-Rabin素数测试算法 已知费马定理 p 是素数 ap−1&#x3D;1(modp)(F)a ^ {p -1} &#x3D; 1 \pmod p  \tag{F} ap−1&#x3D;1(modp)(F)"><meta property=og:type content=article><meta property=og:title content=Miller-Rabin素数测试算法><meta property=og:url content=http://vitock.github.io/2021/08/07/42fede76182f/index.html><meta property=og:site_name><meta property=og:description content="Miller-Rabin素数测试算法 已知费马定理 p 是素数 ap−1&#x3D;1(modp)(F)a ^ {p -1} &#x3D; 1 \pmod p  \tag{F} ap−1&#x3D;1(modp)(F)"><meta property=og:locale content=zh_CN><meta property=article:published_time content=2021-08-07T00:55:40.000Z><meta property=article:modified_time content=2021-08-12T02:14:02.852Z><meta property=article:author content=Vitock><meta property=article:tag content=素数><meta property=article:tag content=加密><meta property=article:tag content=RSA><meta property=article:tag content=ECC><meta name=twitter:card content=summary><link rel=canonical href=http://vitock.github.io/2021/08/07/42fede76182f/ ><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://vitock.github.io/2021/08/07/42fede76182f/","path":"2021/08/07/42fede76182f/","title":"Miller-Rabin素数测试算法"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>Miller-Rabin素数测试算法 |</title><script src=/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?49542d4f1ae3f2f35a0227ac6a0c62c6></script><noscript><link rel=stylesheet href=/css/noscript.css></noscript><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title></h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Vitock</div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#miller-rabin%E7%B4%A0%E6%95%B0%E6%B5%8B%E8%AF%95%E7%AE%97%E6%B3%95><span class=nav-number>1.</span> <span class=nav-text>Miller-Rabin素数测试算法</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E4%BA%8C%E6%AC%A1%E6%8E%A2%E6%B5%8B><span class=nav-number>1.1.</span> <span class=nav-text>二次探测</span></a></ol></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class=site-overview><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Vitock src=/img/avatar/icon_0.webp><p class=site-author-name itemprop=name>Vitock<div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>51</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>50</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class=links-of-author-item><a href=https://github.com/vitock title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;vitock" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item><a href=https://weibo.com/2145843507/profile title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;2145843507&#x2F;profile" rel=noopener target=_blank><i class="fab fa-weibo fa-fw"></i>Weibo</a></span></div></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang=zh-CN><link itemprop=mainEntityOfPage href=http://vitock.github.io/2021/08/07/42fede76182f/ ><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=/img/avatar/icon_0.webp><meta itemprop=name content=Vitock><meta itemprop=description content=""></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=""></span><header class=post-header><h1 class=post-title itemprop="name headline">Miller-Rabin素数测试算法</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i> </span><span class=post-meta-item-text>发表于</span> <time title="创建时间：2021-08-07 08:55:40" itemprop="dateCreated datePublished" datetime=2021-08-07T08:55:40+08:00>2021-08-07</time></span></div></div></header><div class=post-body itemprop=articleBody><h2 id=miller-rabin素数测试算法><a class=markdownIt-Anchor href=#miller-rabin素数测试算法></a> Miller-Rabin素数测试算法</h2><p>已知费马定理 p 是素数<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable width=100%><mtr><mtd width=50%></mtd><mtd><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mn>1</mn><mspace></mspace><mspace width=1em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow></mtd><mtd width=50%></mtd><mtd><mtext>(F)</mtext></mtd></mtr></mtable><annotation encoding=application/x-tex>a ^ {p -1} = 1 \pmod p \tag{F}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.864108em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.1130000000000004em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:1em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span><span class=tag><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class="mord text"><span class=mord>(</span><span class=mord><span class=mord>F</span></span><span class=mord>)</span></span></span></span></span></span><p>那么他的逆命题,如果上面式子,<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 是否是素数呢?<br>答案是否定的,但是我们可以通过不同的 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span></span></span></span> 来测试来增加我们的确信度。<p>但是，如果<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>很大,每次更换 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">a</span></span></span></span> 重新计算<span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=application/x-tex>a ^ {p-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 代价有点大，科学家想到了加速办法。<h3 id=二次探测><a class=markdownIt-Anchor href=#二次探测></a> 二次探测</h3><p>如果 p 是素数<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mspace></mspace><mspace width=1em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x ^2 = 1 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8641079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8641079999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:1em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span></span><p>的解只有 <span class=katex><span class=katex-mathml><math><semantics><mrow><mn>1</mn><mo separator=true>,</mo><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>1,p-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8388800000000001em;vertical-align:-.19444em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mspace></mspace><mspace width=1em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo><mspace linebreak=newline></mspace><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mo>−</mo><mn>1</mn><mspace></mspace><mspace width=1em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x_1 = 1 \pmod p \\ x_2 = -1 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:1em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>−</span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:1em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span></span><p>有什么用?<p>看到2次方了吗,这个我们可以利用起来逐级降次(逐次开方),或者自底向上逐渐升次。<p>对于每个＞2的素数, <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn><mo>=</mo><msup><mn>2</mn><mi>k</mi></msup><mo>×</mo><mi>s</mi></mrow><annotation encoding=application/x-tex>p-1 = 2 ^ k \times s</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.932438em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style=margin-right:.03148em>k</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">s</span></span></span></span><p>测试<ol><li>随机选取一个数 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>p</mi></mrow><annotation encoding=application/x-tex>a &lt; p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathdefault">a</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>&lt;</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span>;<li>计算初始值 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>a</mi><mi>s</mi></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x = a ^ s \pmod{p}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span><ol><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn><mspace width=1em><mi mathvariant=normal>或</mi><mi mathvariant=normal>者</mi><mspace width=1em><mi>x</mi><mo>=</mo><mi>p</mi><mo>−</mo><mn>1</mn><mspace width=1em><mi mathvariant=normal>即</mi><mi>x</mi><mo>=</mo><mo>−</mo><mn>1</mn><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x = 1 \quad 或者 \quad x = p-1 \quad 即x= -1 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:1em></span><span class="mord cjk_fallback">或</span><span class="mord cjk_fallback">者</span><span class=mspace style=margin-right:1em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:1em></span><span class="mord cjk_fallback">即</span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>−</span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span> ，说明肯定满足 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>a</mi><mi>p</mi></msup><mo>−</mo><mn>1</mn><mo>=</mo><mn>1</mn><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>a^p-1 = 1 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.747722em;vertical-align:-.08333em></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span> ,后面继续平方结果肯定也是1,那么通过测试。<li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>≠</mo><mo>±</mo><mn>1</mn><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x \not =\pm1 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>±</span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span> 那么逐次升幂测试(最多<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>次,不能超过 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=application/x-tex>a^{p-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>),后面还有机会通过。<ol><li>StepA:<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x = x ^ 2 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span><ul><li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>≠</mo><mo>±</mo><mn>1</mn><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x \not =\pm1 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel><span class=mord><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.69444em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=rlap><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=inner><span class=mrel></span></span><span class=fix></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.19444em><span></span></span></span></span></span></span></span><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>±</span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span> ,继续步骤StepA,但是总平方次数不能超过 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>次<li>如果 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>x</mi><mo>=</mo><mo>±</mo><mn>1</mn><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>x =\pm1 \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">x</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.72777em;vertical-align:-.08333em></span><span class=mord>±</span><span class=mord>1</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span>,那么通过测试。</ul></ol></ol><li>如果总的平方次数到 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>次了,依然没有通过,那么,这就是个合数,中断<li>根据需要,如果需要增加可信度,再走一次 步骤1</ol><p>例子<p>我们检验 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>541</mn></mrow><annotation encoding=application/x-tex>p = 541</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>5</span><span class=mord>4</span><span class=mord>1</span></span></span></span><br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn><mo>=</mo><msup><mn>2</mn><mn>2</mn></msup><mo>∗</mo><mn>135</mn></mrow><annotation encoding=application/x-tex>p -1 = 2 ^ 2 * 135</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.7777700000000001em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>∗</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mord>3</span><span class=mord>5</span></span></span></span><ol><li>随机选择 a = 154<ol><li><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>a</mi><mn>135</mn></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mn>541</mn><mo stretchy=false>)</mo><mo>=</mo><mn>540</mn></mrow><annotation encoding=application/x-tex>a ^ {135} \pmod{541} = 540</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class=mord>5</span><span class=mord>4</span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>5</span><span class=mord>4</span><span class=mord>0</span></span></span></span> 通过</ol><li>随机 a = 2<ol><li><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>a</mi><mn>135</mn></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mn>541</mn><mo stretchy=false>)</mo><mo>=</mo><mn>52</mn></mrow><annotation encoding=application/x-tex>a ^ {135} \pmod{541} = 52</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class=mord>5</span><span class=mord>4</span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>5</span><span class=mord>2</span></span></span></span><li><span class=katex><span class=katex-mathml><math><semantics><mrow><mn>5</mn><msup><mn>2</mn><mn>2</mn></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mn>541</mn><mo stretchy=false>)</mo><mo>=</mo><mn>540</mn></mrow><annotation encoding=application/x-tex>52 ^ 2 \pmod{541} = 540</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord>5</span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class=mord>5</span><span class=mord>4</span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>5</span><span class=mord>4</span><span class=mord>0</span></span></span></span> 通过</ol><li>随机 a = 19<ol><li><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>a</mi><mn>135</mn></msup><mspace></mspace><mspace width=0.4444444444444444em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mn>541</mn><mo stretchy=false>)</mo><mo>=</mo><mn>540</mn></mrow><annotation encoding=application/x-tex>a ^ {135} \pmod{541} = 540</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">a</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.4444444444444444em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class=mord>5</span><span class=mord>4</span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>5</span><span class=mord>4</span><span class=mord>0</span></span></span></span> 通过</ol></ol><p>…<p>下面是 计算 1000以内的素数个数 ,只是原理验证,类型用的 JavaScript 内建的Number,大小有限制<figure class="highlight javascript"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br></pre><td class=code><pre><span class=line></span><br><span class=line><span class=function><span class=keyword>function</span> <span class=title>isPrime</span>(<span class=params>p</span>)</span>&#123;</span><br><span class=line>    <span class=function><span class=keyword>function</span> <span class=title>testPrime</span>(<span class=params> a,p</span>)</span>&#123;</span><br><span class=line>        <span class=comment>/**</span></span><br><span class=line><span class=comment>         * 计算 a ^2^k mod p</span></span><br><span class=line><span class=comment>         */</span></span><br><span class=line>        <span class=function><span class=keyword>function</span> <span class=title>pow</span>(<span class=params>a,k,p</span>)</span>&#123;</span><br><span class=line>            <span class=keyword>var</span> z = <span class=number>0</span></span><br><span class=line>            <span class=function><span class=title>while</span>(<span class=params>z ++  &lt; k</span>)</span>&#123;</span><br><span class=line>                a = a * a %p</span><br><span class=line>            &#125;</span><br><span class=line>            <span class=keyword>return</span> a ;</span><br><span class=line>        &#125;</span><br><span class=line></span><br><span class=line>        <span class=comment>/**</span></span><br><span class=line><span class=comment>         * 计算 arr[0] * arr[x] mod p</span></span><br><span class=line><span class=comment>         */</span></span><br><span class=line>        <span class=function><span class=keyword>function</span> <span class=title>mods</span>(<span class=params>p,arr</span>)</span>&#123;</span><br><span class=line>            <span class=keyword>var</span> z = arr[<span class=number>0</span>] % p;</span><br><span class=line>            <span class=keyword>for</span> (<span class=keyword>let</span> index = <span class=number>1</span>; index &lt; arr.length; index++) &#123;  </span><br><span class=line>                <span class=keyword>const</span> element = arr[index]; </span><br><span class=line>                z = z * element % p</span><br><span class=line>            &#125;</span><br><span class=line>            <span class=keyword>return</span> z;</span><br><span class=line>        &#125;</span><br><span class=line></span><br><span class=line> </span><br><span class=line>        <span class=comment>// 分解 p-1 = 2 ^K  * s</span></span><br><span class=line>        <span class=keyword>var</span> p_1 = p-<span class=number>1</span>;</span><br><span class=line>        <span class=keyword>var</span> s = <span class=number>1</span>;</span><br><span class=line>        <span class=keyword>var</span> K = <span class=number>0</span>;</span><br><span class=line>        <span class=keyword>var</span> rightShift = <span class=number>0</span>;</span><br><span class=line>        <span class=keyword>while</span>((p_1 &gt;&gt;rightShift &amp; <span class=number>1</span>) == <span class=number>0</span> &amp;&amp; (p_1 &gt;&gt;rightShift))&#123;</span><br><span class=line>            rightShift ++ ;</span><br><span class=line>        &#125;</span><br><span class=line>        s = p_1 &gt;&gt; rightShift;</span><br><span class=line>        K = rightShift;</span><br><span class=line></span><br><span class=line></span><br><span class=line>        <span class=comment>/// 分解 s = 2 ^x1 + 2 ^x2 ...</span></span><br><span class=line>        <span class=comment>/// 直接读取二进制位</span></span><br><span class=line>        <span class=keyword>var</span> m = [];</span><br><span class=line>        <span class=keyword>var</span> k0 = <span class=number>0</span> ,tmp = s;</span><br><span class=line>        <span class=function><span class=title>while</span>(<span class=params>tmp &gt; <span class=number>0</span> </span>)</span>&#123;</span><br><span class=line>            <span class=keyword>const</span> z = tmp &amp; <span class=number>1</span>;</span><br><span class=line>            <span class=keyword>if</span> (z) &#123;</span><br><span class=line>                m.push(pow(a,k0,p));</span><br><span class=line>            &#125;</span><br><span class=line>            k0 ++ ;</span><br><span class=line>            tmp = tmp &gt;&gt; <span class=number>1</span>;</span><br><span class=line>        &#125;</span><br><span class=line></span><br><span class=line></span><br><span class=line>        <span class=comment>// 计算 ss = a ^s</span></span><br><span class=line>        <span class=keyword>var</span> ss = mods(p,m);</span><br><span class=line>        <span class=comment>// 逐步测试 ss ^2  = 1 ,-1 mod p</span></span><br><span class=line>        <span class=keyword>while</span> (ss !== <span class=number>1</span> &amp;&amp; ss !== p_1 &amp;&amp; K -- &gt; <span class=number>0</span>)&#123;</span><br><span class=line>            ss = ss * ss % p;</span><br><span class=line>        &#125;</span><br><span class=line>        <span class=keyword>return</span> ss == <span class=number>1</span> || ss == p_1  </span><br><span class=line>    &#125;</span><br><span class=line>    <span class=built_in>this</span>.testPrime = testPrime;</span><br><span class=line></span><br><span class=line></span><br><span class=line>    <span class=keyword>if</span> (!p) &#123;</span><br><span class=line>        <span class=keyword>return</span> <span class=literal>false</span>;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>for</span> (<span class=keyword>let</span> index = <span class=number>0</span>; index &lt; <span class=number>200</span>  ; index++) &#123;</span><br><span class=line>        <span class=keyword>var</span>  a =   <span class=built_in>Math</span>.floor((<span class=built_in>Math</span>.random() * p )) </span><br><span class=line>        <span class=function><span class=title>while</span>(<span class=params>a == <span class=number>0</span> || a == p </span>)</span>&#123;</span><br><span class=line>            a = <span class=built_in>Math</span>.floor((<span class=built_in>Math</span>.random() * p )) ;</span><br><span class=line>        &#125;</span><br><span class=line>        </span><br><span class=line>        <span class=keyword>const</span> testResult = testPrime(a,p);</span><br><span class=line>        <span class=function><span class=title>if</span>(<span class=params>!testResult</span>)</span>&#123;</span><br><span class=line>            <span class=comment>// console.log(&#x27;测试不通过&#x27;,`$&#123;a &#125; $&#123;p &#125;  $&#123;testResult&#125;`);</span></span><br><span class=line>            <span class=keyword>return</span> <span class=literal>false</span>;</span><br><span class=line>        &#125;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>return</span> <span class=literal>true</span>;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line></span><br><span class=line><span class=keyword>var</span> c = <span class=number>0</span>,p = <span class=number>1</span>;</span><br><span class=line><span class=keyword>var</span> arr = []</span><br><span class=line><span class=function><span class=title>while</span>(<span class=params>p++ &lt; <span class=number>1000</span></span>)</span>&#123;</span><br><span class=line>    <span class=function><span class=title>if</span>(<span class=params>isPrime(p)</span>)</span>&#123;</span><br><span class=line>        c ++ ;</span><br><span class=line>        arr.push(p);</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line> </span><br><span class=line><span class=built_in>console</span>.log(<span class=string>&#x27;1000以内素数个数&#x27;</span>,c);<span class=comment>//168</span></span><br><span class=line></span><br></pre></table></figure><blockquote><p>看到AKS算法,也是多项式时间,<strong>但是是确定性的算法</strong>。<a target=_blank rel=noopener href=https://baike.baidu.com/item/AKS%E7%B4%A0%E6%95%B0%E6%B5%8B%E8%AF%95/22735657>AKS</a></blockquote></div><div class=popular-posts-header>相关文章</div><ul class=popular-posts><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/07/817093e2f777/ rel=bookmark>扩展欧几里得算法</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/02/e68ed72c802a/ rel=bookmark>RSA</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2020/10/21/541a3f0129ff/ rel=bookmark>ECC椭圆曲线加密</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/07/29/d9aa54d24287/ rel=bookmark>ECDSA 签名算法</a></div></ul><footer class=post-footer><div class=post-tags><a href=/tags/%E7%B4%A0%E6%95%B0/ rel=tag><i class="fa fa-tag"></i> 素数</a> <a href=/tags/%E5%8A%A0%E5%AF%86/ rel=tag><i class="fa fa-tag"></i> 加密</a> <a href=/tags/RSA/ rel=tag><i class="fa fa-tag"></i> RSA</a> <a href=/tags/ECC/ rel=tag><i class="fa fa-tag"></i> ECC</a></div><div class=post-nav><div class=post-nav-item><a href=/2021/08/05/340e0c14fac3/ rel=prev title=疫情,又来了><i class="fa fa-chevron-left"></i> 疫情,又来了</a></div><div class=post-nav-item><a href=/2021/08/07/817093e2f777/ rel=next title=扩展欧几里得算法>扩展欧几里得算法 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; <span itemprop=copyrightYear>2021</span> <span class=with-love><i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Vitock</span></div></div></footer><script src=https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/next-boot.js></script><script src=/js/pjax.js></script><script class=next-config data-name=enableMath type=application/json>false</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity="sha256-55Ddc47WvWTK5vYVejnAuSK7USJaL7FQXrzQ4HiQ1WY=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin=anonymous><script class=next-config data-name=gitalk type=application/json>{"enable":true,"github_id":"vitock","repo":"vitock.github.io","client_id":"e7f10b97367d65ffb9e5","client_secret":"2e83b75434ccccb749d08eddbb0599330d46835e","admin_user":"vitock","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en | zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"9e7726d21592f2b256b173ec722bce31"}</script><script src=/js/third-party/comments/gitalk.js></script>
