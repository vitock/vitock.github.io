<!doctype html><html lang=zh-CN><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222><meta name=generator content="Hexo 5.2.0"><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-next.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32-next.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16-next.png><link rel=mask-icon href=/images/logo.svg color=#222><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><script class=next-config data-name=main type=application/json>{"hostname":"vitock.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src=/js/config.js></script><meta name=description content="原文 ZhenlyChen&#x2F;X.509Reader   X.509 证书解析  X.509 证书结构描述"><meta property=og:type content=article><meta property=og:title content=x509证书><meta property=og:url content=http://vitock.github.io/2021/05/21/fb95fd27ad48/index.html><meta property=og:site_name><meta property=og:description content="原文 ZhenlyChen&#x2F;X.509Reader   X.509 证书解析  X.509 证书结构描述"><meta property=og:locale content=zh_CN><meta property=og:image content=http://vitock.github.io/2021/05/21/fb95fd27ad48/Design/1544786276143.png><meta property=article:published_time content=2021-05-21T08:09:26.000Z><meta property=article:modified_time content=2021-08-12T02:14:02.852Z><meta property=article:author content=Vitock><meta property=article:tag content=开发><meta property=article:tag content=证书格式><meta property=article:tag content=ASN.1><meta name=twitter:card content=summary><meta name=twitter:image content=http://vitock.github.io/2021/05/21/fb95fd27ad48/Design/1544786276143.png><link rel=canonical href=http://vitock.github.io/2021/05/21/fb95fd27ad48/ ><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://vitock.github.io/2021/05/21/fb95fd27ad48/","path":"2021/05/21/fb95fd27ad48/","title":"x509证书"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>x509证书 |</title><script src=/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?49542d4f1ae3f2f35a0227ac6a0c62c6></script><noscript><link rel=stylesheet href=/css/noscript.css></noscript><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title></h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Vitock</div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#x509-%E8%AF%81%E4%B9%A6%E8%A7%A3%E6%9E%90><span class=nav-number>1.</span> <span class=nav-text>X.509 证书解析</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#x509-%E8%AF%81%E4%B9%A6%E7%BB%93%E6%9E%84%E6%8F%8F%E8%BF%B0><span class=nav-number>1.1.</span> <span class=nav-text>X.509 证书结构描述</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84><span class=nav-number>1.2.</span> <span class=nav-text>数据结构</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#base64><span class=nav-number>1.2.1.</span> <span class=nav-text>Base64</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E8%A7%A3%E7%A0%81><span class=nav-number>1.2.1.1.</span> <span class=nav-text>解码</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#ans1><span class=nav-number>1.2.2.</span> <span class=nav-text>ANS.1</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#der><span class=nav-number>1.2.3.</span> <span class=nav-text>DER</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%B1%BB%E5%9E%8B%E5%AD%97%E6%AE%B5><span class=nav-number>1.2.3.1.</span> <span class=nav-text>类型字段</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E9%95%BF%E5%BA%A6%E5%AD%97%E6%AE%B5><span class=nav-number>1.2.3.2.</span> <span class=nav-text>长度字段</span></a><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%80%BC%E5%AD%97%E6%AE%B5><span class=nav-number>1.2.3.3.</span> <span class=nav-text>值字段</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#object-id><span class=nav-number>1.2.4.</span> <span class=nav-text>Object ID</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E8%BD%AC%E6%8D%A2><span class=nav-number>1.2.4.1.</span> <span class=nav-text>转换</span></a></ol><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%A7%A3%E6%9E%90><span class=nav-number>1.2.5.</span> <span class=nav-text>解析</span></a></ol><li class="nav-item nav-level-2"><a class=nav-link href=#c-%E8%AF%AD%E8%A8%80%E6%BA%90%E4%BB%A3%E7%A0%81><span class=nav-number>1.3.</span> <span class=nav-text>C 语言源代码</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6><span class=nav-number>1.3.1.</span> <span class=nav-text>读取文件</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#base64%E8%A7%A3%E7%A0%81><span class=nav-number>1.3.2.</span> <span class=nav-text>Base64解码</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#ans1%E8%A7%A3%E7%A0%81><span class=nav-number>1.3.3.</span> <span class=nav-text>ANS.1解码</span></a><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE><span class=nav-number>1.3.4.</span> <span class=nav-text>显示数据</span></a></ol></ol></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class=site-overview><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Vitock src=/img/avatar/icon_0.webp><p class=site-author-name itemprop=name>Vitock<div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>51</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>50</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class=links-of-author-item><a href=https://github.com/vitock title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;vitock" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item><a href=https://weibo.com/2145843507/profile title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;2145843507&#x2F;profile" rel=noopener target=_blank><i class="fab fa-weibo fa-fw"></i>Weibo</a></span></div></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang=zh-CN><link itemprop=mainEntityOfPage href=http://vitock.github.io/2021/05/21/fb95fd27ad48/ ><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=/img/avatar/icon_0.webp><meta itemprop=name content=Vitock><meta itemprop=description content=""></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=""></span><header class=post-header><h1 class=post-title itemprop="name headline">x509证书</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i> </span><span class=post-meta-item-text>发表于</span> <time title="创建时间：2021-05-21 16:09:26" itemprop="dateCreated datePublished" datetime=2021-05-21T16:09:26+08:00>2021-05-21</time> </span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder"></i> </span><span class=post-meta-item-text>分类于</span> <span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%BC%80%E5%8F%91/ itemprop=url rel=index><span itemprop=name>开发</span></a></span></span></div></div></header><div class=post-body itemprop=articleBody><blockquote><p>原文 <a target=_blank rel=noopener href=https://github.com/ZhenlyChen/X.509Reader/blob/master/docs/Design.md>ZhenlyChen/X.509Reader</a></blockquote><h1 id=x509-证书解析><a class=markdownIt-Anchor href=#x509-证书解析></a> X.509 证书解析</h1><h2 id=x509-证书结构描述><a class=markdownIt-Anchor href=#x509-证书结构描述></a> X.509 证书结构描述</h2><p>X.509证书有多种常用的文件扩展名，代表着不同形式的数据编码以及内容<p>其中常见的有（来自Wikipedia）：<ul><li><code>.pem</code> – <a target=_blank rel=noopener href="https://zh.wikipedia.org/w/index.php?title=DER&amp;action=edit&amp;redlink=1">DER</a>编码的证书再进行<a target=_blank rel=noopener href=https://zh.wikipedia.org/wiki/Base64>Base64</a>编码的数据<li><code>.cer</code>, <code>.crt</code>, <code>.der</code> – 通常是<a target=_blank rel=noopener href="https://zh.wikipedia.org/w/index.php?title=DER&amp;action=edit&amp;redlink=1">DER</a>二进制格式的，但Base64编码后也很常见。<li><code>.p7b</code>, <code>.p7c</code> – <a target=_blank rel=noopener href=https://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A0%87%E5%87%86>PKCS#7</a> SignedData structure without data, just certificate(s) or <a target=_blank rel=noopener href=https://zh.wikipedia.org/wiki/%E8%AF%81%E4%B9%A6%E5%90%8A%E9%94%80%E5%88%97%E8%A1%A8>CRL</a>(s)<li><code>.p12</code> – <a target=_blank rel=noopener href=https://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A0%87%E5%87%86>PKCS#12</a>格式，包含证书的同时可能还有带密码保护的私钥<li><code>.pfx</code> – PFX，PKCS#12之前的格式（通常用PKCS#12格式，比如那些由<a target=_blank rel=noopener href=https://zh.wikipedia.org/wiki/IIS>IIS</a>产生的PFX文件）</ul><p>这里我主要解析的是<code>DER</code>二进制格式经过Base64编码后的数据<p>其中证书的组成结构标准用<code>ASN.1</code>来进行描述，有着不同的版本，其中<code>V3</code>版本的基本结构如下（Wikipedia）：<ul><li>证书<ul><li>版本号：标识证书的版本（版本1、版本2或是版本3）<li>序列号：标识证书的唯一整数，由证书颁发者分配的本证书的唯一标识符<li>签名算法：用于签证书的算法标识，由对象标识符加上相关的参数组成，用于说明本证书所用的数字签名算法<li>颁发者：证书颁发者的可识别名（DN）<li>证书有效期 ：此日期前无效 - 此日期后无效<li>主体：证书拥有者的可识别名<li>主体公钥信息<ul><li>公钥算法<li>主体公钥</ul><li>颁发者唯一身份信息（可选项）<li>主体唯一身份信息（可选项）<li>扩展信息（可选项）<ul><li>发行者密钥标识符：证书所含密钥的唯一标识符，用来区分同一证书拥有者的多对密钥<li>密钥使用：指明（限定）证书的公钥可以完成的功能或服务，如：证书签名、数据加密等<li>CRL分布点<li>私钥的使用期<li>证书策略：由对象标识符和限定符组成，这些对象标识符说明证书的颁发和使用策略有关<li>策略映射<li>主体别名：指出证书拥有者的别名，如电子邮件地址、IP地址等<li>颁发者别名：指出证书颁发者的别名<li>主体目录属性：证书拥有者的一系列属性</ul><li>证书签名算法<li>数字签名</ul></ul><h2 id=数据结构><a class=markdownIt-Anchor href=#数据结构></a> 数据结构</h2><h3 id=base64><a class=markdownIt-Anchor href=#base64></a> Base64</h3><p>为了在互联网上传输，大多数证书都是采用Base64编码，以可打印字符的形式表示二进制数据流。<p>Base64编码由RFC 1421和RFC 2045定义，一共有64个可打印字符，因此每六个比特表示为一个单元，以64种字符表示二进制数据。<h4 id=解码><a class=markdownIt-Anchor href=#解码></a> 解码</h4><p>首先取出一组（4个字符），按照其值在<code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code>中位置获得其代表的值，然后依次从高位到低位放入一个24位的缓冲区中，最后将其划分为三个八位的字符。<p>下面是维基百科上一个简单的例子<p><img src=Design/1544786276143.png alt=1544786276143><p>在C++中，只需要一个简单的循环，每次以原数据的4个单元为一组，将其转换成3个八位的数据。<figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line>byte text[len] = &#123;<span class=number>0</span>&#125;;</span><br><span class=line><span class=keyword>int</span> textIndex = <span class=number>0</span>;</span><br><span class=line><span class=keyword>for</span> (<span class=keyword>int</span> i = <span class=number>0</span>; i &lt; data.length(); i += <span class=number>4</span>) &#123;</span><br><span class=line>  byte base64_bit_6[<span class=number>4</span>];</span><br><span class=line>  <span class=keyword>for</span> (<span class=keyword>int</span> j = <span class=number>0</span>; j &lt; <span class=number>4</span>; j++) &#123;</span><br><span class=line>    base64_bit_6[j] = base64_chars.find(data[i + j]);</span><br><span class=line>  &#125;</span><br><span class=line>  text[textIndex] =</span><br><span class=line>    ((base64_bit_6[<span class=number>0</span>] &amp; <span class=number>0x3f</span>) &lt;&lt; <span class=number>2</span>) | ((base64_bit_6[<span class=number>1</span>] &amp; <span class=number>0x30</span>) &gt;&gt; <span class=number>4</span>);</span><br><span class=line>  text[textIndex + <span class=number>1</span>] =</span><br><span class=line>    ((base64_bit_6[<span class=number>1</span>] &amp; <span class=number>0xf</span>) &lt;&lt; <span class=number>4</span>) | ((base64_bit_6[<span class=number>2</span>] &amp; <span class=number>0x3c</span>) &gt;&gt; <span class=number>2</span>);</span><br><span class=line>  text[textIndex + <span class=number>2</span>] =</span><br><span class=line>    ((base64_bit_6[<span class=number>2</span>] &amp; <span class=number>0x3</span>) &lt;&lt; <span class=number>6</span>) | (base64_bit_6[<span class=number>3</span>] &amp; <span class=number>0x3f</span>);</span><br><span class=line>  textIndex += <span class=number>3</span>;</span><br><span class=line>&#125;</span><br></pre></table></figure><h3 id=ans1><a class=markdownIt-Anchor href=#ans1></a> ANS.1</h3><p>经过Base64解码后，就是证书中的内容了，按照标准，这一部分的内容使用<code>ANS.1</code>表示。<p>ANS.1是一套描述数据表示、编码、传输、解码的灵活的记法，是一套正式、无歧义和精确的规则。我们可以使用ANS.1描述独立于计算机硬件的对象结构。<p>对于X.509证书标准，存在以下的结构：<figure class="highlight plain"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br></pre><td class=code><pre><span class=line>Certificate  ::&#x3D;  SEQUENCE  &#123;</span><br><span class=line>  tbsCertificate       TBSCertificate,</span><br><span class=line>  signatureAlgorithm   AlgorithmIdentifier,</span><br><span class=line>  signatureValue       BIT STRING  &#125;</span><br><span class=line></span><br><span class=line>TBSCertificate  ::&#x3D;  SEQUENCE  &#123;</span><br><span class=line>  version         [0]  EXPLICIT Version DEFAULT v1,</span><br><span class=line>  serialNumber         CertificateSerialNumber,</span><br><span class=line>  signature            AlgorithmIdentifier,</span><br><span class=line>  issuer               Name,</span><br><span class=line>  validity             Validity,</span><br><span class=line>  subject              Name,</span><br><span class=line>  subjectPublicKeyInfo SubjectPublicKeyInfo,</span><br><span class=line>  issuerUniqueID  [1]  IMPLICIT UniqueIdentifier OPTIONAL,</span><br><span class=line>                        -- If present, version MUST be v2 or v3</span><br><span class=line>  subjectUniqueID [2]  IMPLICIT UniqueIdentifier OPTIONAL,</span><br><span class=line>                        -- If present, version MUST be v2 or v3</span><br><span class=line>  extensions      [3]  EXPLICIT Extensions OPTIONAL</span><br><span class=line>                        -- If present, version MUST be v3&#125;</span><br><span class=line></span><br><span class=line>Version  ::&#x3D;  INTEGER  &#123;  v1(0), v2(1), v3(2)  &#125;</span><br><span class=line></span><br><span class=line>CertificateSerialNumber  ::&#x3D;  INTEGER</span><br><span class=line></span><br><span class=line>Validity ::&#x3D; SEQUENCE &#123;</span><br><span class=line>  notBefore      Time,</span><br><span class=line>  notAfter       Time &#125;</span><br><span class=line></span><br><span class=line>Time ::&#x3D; CHOICE &#123;</span><br><span class=line>  utcTime        UTCTime,</span><br><span class=line>  generalTime    GeneralizedTime &#125;</span><br><span class=line></span><br><span class=line>UniqueIdentifier  ::&#x3D;  BIT STRING</span><br><span class=line></span><br><span class=line>SubjectPublicKeyInfo  ::&#x3D;  SEQUENCE  &#123;</span><br><span class=line>  algorithm            AlgorithmIdentifier,</span><br><span class=line>  subjectPublicKey     BIT STRING  &#125;</span><br><span class=line></span><br><span class=line>Extensions  ::&#x3D;  SEQUENCE SIZE (1..MAX) OF Extension</span><br><span class=line></span><br><span class=line>Extension  ::&#x3D;  SEQUENCE  &#123;</span><br><span class=line>  extnID      OBJECT IDENTIFIER,</span><br><span class=line>  critical    BOOLEAN DEFAULT FALSE,</span><br><span class=line>  extnValue   OCTET STRING</span><br><span class=line>              -- contains the DER encoding of an ASN.1 value</span><br><span class=line>              -- corresponding to the extension type identified</span><br><span class=line>              -- by extnID</span><br><span class=line>              &#125;</span><br></pre></table></figure><h3 id=der><a class=markdownIt-Anchor href=#der></a> DER</h3><p>证书中的ANS.1数据是以DER编码而来的。<p>具体的文档可以查看http://luca.ntop.org/Teaching/Appunti/asn1.html<p>DER为ANS.1类型定义了一种唯一的编码方案。<p>对于每一种数据类型，其DER编码由以下四部分组成：<ul><li>类型字段：tag(T)<li>长度字段：length(L)<li>值字段：value(V)<li>结束表示字段</ul><h4 id=类型字段><a class=markdownIt-Anchor href=#类型字段></a> 类型字段</h4><p>类型由一个字节（8位）大小的数据表示<p>其中高两位(8-7)表示了TAG的类型：<ul><li><code>00</code>: universal<li><code>01</code>: application<li><code>10</code>: context-specific<li><code>11</code>: private</ul><p>第六位表示是否位结构化类型：<ul><li><code>0</code>: 简单类型<li><code>1</code>：结构类型</ul><p>剩余的五位(5-1)就是表示具体的类型<p>比较常用的类型有<table><thead><tr><th>Type<th>Tag number (decimal)<th>Tag number (hexadecimal)<tbody><tr><td><code>INTEGER</code><td>2<td><code>02</code><tr><td><code>BIT STRING</code><td>3<td><code>03</code><tr><td><code>OCTET STRING</code><td>4<td><code>04</code><tr><td><code>NULL</code><td>5<td><code>05</code><tr><td><code>OBJECT IDENTIFIER</code><td>6<td><code>06</code><tr><td><code>SEQUENCE</code> and <code>SEQUENCE OF</code><td>16<td><code>10</code><tr><td><code>SET</code> and <code>SET OF</code><td>17<td><code>11</code><tr><td><code>PrintableString</code><td>19<td><code>13</code><tr><td><code>T61String</code><td>20<td><code>14</code><tr><td><code>IA5String</code><td>22<td><code>16</code><tr><td><code>UTCTime</code><td>23<td><code>17</code></table><h4 id=长度字段><a class=markdownIt-Anchor href=#长度字段></a> 长度字段</h4><p>长度字段，有两种编码格式。<p>若长度值小于等于127，则用一个字节表示，bit8 = 0, bit7-bit1 存放长度值<p>若长度值大于127，则用多个字节表示，可以有2到127个字节。第一个字节的第8位为1，其它低7位给出后面该域使用的字节的数量，从该域第二个字节开始给出数据的长度，高位优先。<p>还有一种特殊情况，这个字节为<code>0x80</code>，表示数据块长度不定，由数据块结束标识结束数据块。<h4 id=值字段><a class=markdownIt-Anchor href=#值字段></a> 值字段</h4><p>根据不同类型，值字段可以表示不同的数据，如Ascii字符、16进制字符串、OID<h3 id=object-id><a class=markdownIt-Anchor href=#object-id></a> Object ID</h3><p>在证书中的各种值中，比较常见的就是<code>Object ID</code>(对象标识符)<p>对象标识符是由国际电信联盟(ITU)和ISO/IEC标准化的标识符机制，用于表示对一个对象、概念或者事务的全球化的一种标识。<p>OID是由一连串以点<code>.</code>分隔的数字组成，<p>比如：<code>1.3.6.1.4.1.343</code><p>表示的是<ul><li>1： ISO assigned OIDs（ISO指定的OID）<li>1.3 ： ISO Identified Organization （ISO认证组织）<li>1.3.6： US Department of Defense （美国国防部）<li>1.3.6.1 ：Internet （因特网）<li>1.3.6.1.4： Internet Private （互联网专用）<li>1.3.6.1.4.1 ：IANA-registered Private Enterprises （私营企业）<li>1.3.6.1.4.1.343 ：Intel Corporation （英特尔公司）</ul><p>不同的OID表示的信息可以在网上查到 <a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/1.3.6.1.4.1.343.html>https://www.alvestrand.no/objectid/1.3.6.1.4.1.343.html</a><p>在X.509证书里面，证书颁发者的地区、国家就是使用OID来表示的<h4 id=转换><a class=markdownIt-Anchor href=#转换></a> 转换</h4><p>那么我们如何将二进制数据转换成OID标识呢？<p>在X.509的值的二进制数据中，一个OID表示的值如下<p><code>00101010 10000110 01001000 10000110 11110111 00001101 00000001 00000001 00001011</code><p>将其分为8位大小的块，每一块的第一位表示是否为结束块<p>如果是1就和后面的连在一起<p>如果是0就是一个独立的块<p>得到以下的7bit的6个块<p><code>0101010 00001101001000 000011011101110001101 0000001 0000001 0001011</code><p>然后化为10进制<p><code>42 840 113549 1 1 11</code><p>对第一位<code>X</code>进行特殊处理，使其变为两个位<ul><li>第一位：<code>min([X/40], 2)</code><li>第二位： <code>X - 40 * 第一位</code></ul><p>因此<code>42 = 40 * 1 + 2</code>，可以分解为1和2，然后得到以下的OID<p><code>1.2.840.113549.1.1.11</code><p>在网上查找数据库，得出以下数据<p><a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/1.2.840.113549.1.1.11.html>1.2.840.113549.1.1.11</a> - sha256WithRSAEncryption<ul><li><a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/1.2.840.113549.1.1.html>1.2.840.113549.1.1</a> - PKCS-1<li><a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/1.2.840.113549.1.html>1.2.840.113549.1</a> - PKCS<li><a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/1.2.840.113549.html>1.2.840.113549</a> - RSADSI<li><a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/1.2.840.html>1.2.840</a> - USA<li><a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/1.2.html>1.2</a> - ISO member body<li><a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/1.html>1</a> - ISO assigned OIDs<li><a target=_blank rel=noopener href=https://www.alvestrand.no/objectid/top.html>Top of OID tree</a></ul><p>因此，这个标识符表示这个证书使用的加密算法为<code>sha256WithRSAEncryption</code><p>在C++里面，只要了解其结构，就可以很简单将二进制数据转换成OID字符串<figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br></pre><td class=code><pre><span class=line>String title = <span class=string>&quot;&quot;</span>;</span><br><span class=line>oiFirst = data[i] &amp; <span class=number>0x7f</span>;</span><br><span class=line>oiIndex = min(oiFirst / <span class=number>40</span>, <span class=number>2</span>);</span><br><span class=line>title.append(to_string(min(oiFirst / <span class=number>40</span>, <span class=number>2</span>)));</span><br><span class=line>title.append(<span class=string>&quot;.&quot;</span>);</span><br><span class=line>title.append(to_string(oiFirst - <span class=number>40</span> * oiIndex));</span><br><span class=line>title.append(<span class=string>&quot;.&quot;</span>);</span><br><span class=line>oiIndex = <span class=number>2</span>;</span><br><span class=line>oiFirst = <span class=number>0</span>;</span><br><span class=line><span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>1</span>; t &lt; lens.len; t++) &#123;</span><br><span class=line>  oiFirst &lt;&lt;= <span class=number>7</span>;</span><br><span class=line>  oiFirst += data[i + t] &amp; <span class=number>0x7f</span>;</span><br><span class=line>  <span class=keyword>if</span> (!(data[i + t] &amp; <span class=number>0x80</span>)) &#123;</span><br><span class=line>    title.append(to_string(oiFirst));</span><br><span class=line>    title.append(<span class=string>&quot;.&quot;</span>);</span><br><span class=line>    oiIndex++;</span><br><span class=line>    oiFirst = <span class=number>0</span>;</span><br><span class=line>  &#125;</span><br><span class=line>&#125;</span><br><span class=line><span class=comment>// title 为OID字符串</span></span><br></pre></table></figure><h3 id=解析><a class=markdownIt-Anchor href=#解析></a> 解析</h3><p>下面对我的网站<code>www.zhenly.cn</code>的证书数据逐一解析<figure class="highlight c"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br><span class=line>162</span><br><span class=line>163</span><br><span class=line>164</span><br><span class=line>165</span><br><span class=line>166</span><br><span class=line>167</span><br><span class=line>168</span><br><span class=line>169</span><br><span class=line>170</span><br><span class=line>171</span><br><span class=line>172</span><br><span class=line>173</span><br><span class=line>174</span><br><span class=line>175</span><br><span class=line>176</span><br><span class=line>177</span><br><span class=line>178</span><br><span class=line>179</span><br><span class=line>180</span><br><span class=line>181</span><br><span class=line>182</span><br><span class=line>183</span><br><span class=line>184</span><br><span class=line>185</span><br><span class=line>186</span><br><span class=line>187</span><br><span class=line>188</span><br><span class=line>189</span><br><span class=line>190</span><br><span class=line>191</span><br><span class=line>192</span><br><span class=line>193</span><br><span class=line>194</span><br><span class=line>195</span><br><span class=line>196</span><br><span class=line>197</span><br><span class=line>198</span><br><span class=line>199</span><br><span class=line>200</span><br><span class=line>201</span><br><span class=line>202</span><br><span class=line>203</span><br><span class=line>204</span><br><span class=line>205</span><br><span class=line>206</span><br><span class=line>207</span><br><span class=line>208</span><br><span class=line>209</span><br><span class=line>210</span><br><span class=line>211</span><br><span class=line>212</span><br><span class=line>213</span><br><span class=line>214</span><br><span class=line>215</span><br><span class=line>216</span><br><span class=line>217</span><br><span class=line>218</span><br><span class=line>219</span><br><span class=line>220</span><br><span class=line>221</span><br><span class=line>222</span><br><span class=line>223</span><br><span class=line>224</span><br><span class=line>225</span><br><span class=line>226</span><br><span class=line>227</span><br><span class=line>228</span><br><span class=line>229</span><br><span class=line>230</span><br><span class=line>231</span><br><span class=line>232</span><br><span class=line>233</span><br><span class=line>234</span><br><span class=line>235</span><br><span class=line>236</span><br><span class=line>237</span><br><span class=line>238</span><br><span class=line>239</span><br><span class=line>240</span><br><span class=line>241</span><br><span class=line>242</span><br><span class=line>243</span><br><span class=line>244</span><br><span class=line>245</span><br><span class=line>246</span><br><span class=line>247</span><br><span class=line>248</span><br><span class=line>249</span><br><span class=line>250</span><br><span class=line>251</span><br><span class=line>252</span><br><span class=line>253</span><br><span class=line>254</span><br><span class=line>255</span><br><span class=line>256</span><br><span class=line>257</span><br><span class=line>258</span><br><span class=line>259</span><br><span class=line>260</span><br><span class=line>261</span><br><span class=line>262</span><br><span class=line>263</span><br><span class=line>264</span><br><span class=line>265</span><br><span class=line>266</span><br><span class=line>267</span><br><span class=line>268</span><br><span class=line>269</span><br><span class=line>270</span><br><span class=line>271</span><br><span class=line>272</span><br><span class=line>273</span><br><span class=line>274</span><br><span class=line>275</span><br></pre><td class=code><pre><span class=line><span class=number>30</span> <span class=number>82</span> <span class=number>05</span> <span class=number>93</span> <span class=comment>// SEQUENCE类型(30), 长度的长度2(82),长度1427(0593) Certificate::</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>82</span> <span class=number>04</span> <span class=number>7b</span> <span class=comment>// SEQUENCE类型(30),长度的长度2(82),长度1147(047b) tbsCertificate::</span></span><br><span class=line></span><br><span class=line>a0 <span class=number>03</span>       <span class=comment>// 特殊内容-证书版本(a0),长度3(03) Version::</span></span><br><span class=line><span class=number>02</span> <span class=number>01</span>       <span class=comment>// 整数类型(02),长度1</span></span><br><span class=line><span class=number>02</span>          <span class=comment>// 版本：3(02)</span></span><br><span class=line></span><br><span class=line><span class=number>02</span> <span class=number>10</span>       <span class=comment>// 整数类型(02),长度16(10) serialNumber::</span></span><br><span class=line><span class=number>08</span> ea ef ef ac a5 <span class=number>62</span> e2 <span class=number>98</span> <span class=number>0</span>e <span class=number>0</span>c <span class=number>3b</span> <span class=number>99</span> e6 a5 a6 </span><br><span class=line><span class=comment>//  序列号：08eaefefaca562e2980e0c3b99e6a5a6</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>0</span>d       <span class=comment>// SEQUENCE类型(30),长度13</span></span><br><span class=line><span class=number>06</span> <span class=number>09</span>       <span class=comment>// Object Identifier 类型(06)，长度9(09)</span></span><br><span class=line><span class=number>2</span>a <span class=number>86</span> <span class=number>48</span> <span class=number>86</span> f7 <span class=number>0</span>d <span class=number>01</span> <span class=number>01</span> <span class=number>0b</span> <span class=comment>// signature:: 签名算法</span></span><br><span class=line></span><br><span class=line><span class=comment>// 00101010 10000110 01001000 10000110 11110111 00001101 00000001 00000001 00001011</span></span><br><span class=line><span class=comment>// 第一位表示是否为结束块，如果是1就和后面的连在一起，得到以下的7bit的9位东西</span></span><br><span class=line><span class=comment>// 0101010 00001101001000 000011011101110001101 0000001 0000001 0001011</span></span><br><span class=line><span class=comment>// 化为10进制</span></span><br><span class=line><span class=comment>// 42 840 113549 1 1 11</span></span><br><span class=line><span class=comment>// 对第一位特殊处理 42 = 40 * 1 + 2， 变成1 2（第一位 min([42/40], 2) 第二位 42 - 40 * 第一位 ）</span></span><br><span class=line><span class=comment>// 1 2 840 113549 1 1 11</span></span><br><span class=line><span class=comment>// &#123;iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-1(1) rsaEncryption(11)&#125;</span></span><br><span class=line><span class=comment>// https://www.alvestrand.no/objectid/1.2.840.113549.1.1.11.html</span></span><br><span class=line><span class=comment>// 1.2.840.113549.1.1.11 - sha256WithRSAEncryption</span></span><br><span class=line><span class=number>05</span> <span class=number>00</span>       <span class=comment>// Null(05) 长度0(0) 密钥参数</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>72</span>       <span class=comment>// SEQUENCE类型(30), 长度114(72)</span></span><br><span class=line></span><br><span class=line><span class=number>31</span> <span class=number>0b</span>       <span class=comment>// SET类型(31) 无序数列, 长度11(b)</span></span><br><span class=line><span class=number>30</span> <span class=number>09</span>       <span class=comment>// SEQUENCE类型(30) 长度9(09)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>04</span> <span class=number>06</span>    <span class=comment>// 2.5.4.6 - id-at-countryName</span></span><br><span class=line><span class=number>13</span> <span class=number>02</span>       <span class=comment>// Printable String类型(13) 长度2(02)</span></span><br><span class=line><span class=number>43</span> <span class=number>4</span>e       <span class=comment>// CN  C(43) N(4e) ASCII</span></span><br><span class=line></span><br><span class=line><span class=number>31</span> <span class=number>25</span>       <span class=comment>// SET类型(31) 无序数列, 长度37(25)</span></span><br><span class=line><span class=number>30</span> <span class=number>23</span>       <span class=comment>// SEQUENCE类型(30), 长度35(23)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>04</span> <span class=number>0</span>a    <span class=comment>// 2.5.4.10 - id-at-organizationName</span></span><br><span class=line><span class=number>13</span> <span class=number>1</span>c       <span class=comment>// Printable String类型(13) 长度28(1c)</span></span><br><span class=line><span class=number>54</span> <span class=number>72</span> <span class=number>75</span> <span class=number>73</span> <span class=number>74</span> <span class=number>41</span> <span class=number>73</span> <span class=number>69</span> <span class=number>61</span> <span class=number>20</span> <span class=number>54</span> <span class=number>65</span> <span class=number>63</span> <span class=number>68</span> <span class=number>6</span>e <span class=number>6f</span> <span class=number>6</span>c <span class=number>6f</span> <span class=number>67</span> <span class=number>69</span> <span class=number>65</span> <span class=number>73</span> <span class=number>2</span>c <span class=number>20</span> <span class=number>49</span> <span class=number>6</span>e <span class=number>63</span> <span class=number>2</span>e <span class=comment>// TrustAsia Technologies, Inc.</span></span><br><span class=line></span><br><span class=line><span class=number>31</span> <span class=number>1</span>d       <span class=comment>// SET类型(31) 无序数列, 长度29(1d)</span></span><br><span class=line><span class=number>30</span> <span class=number>1b</span>       <span class=comment>// SEQUENCE类型(30), 长度27(1b)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>04</span> <span class=number>0b</span>    <span class=comment>// 2.5.4.11 - id-at-organizationalUnitName</span></span><br><span class=line><span class=number>13</span> <span class=number>14</span>       <span class=comment>// Printable String类型(13) 长度20(14)</span></span><br><span class=line><span class=number>44</span> <span class=number>6f</span> <span class=number>6</span>d <span class=number>61</span> <span class=number>69</span> <span class=number>6</span>e <span class=number>20</span> <span class=number>56</span> <span class=number>61</span> <span class=number>6</span>c <span class=number>69</span> <span class=number>64</span> <span class=number>61</span> <span class=number>74</span> <span class=number>65</span> <span class=number>64</span> <span class=number>20</span> <span class=number>53</span> <span class=number>53</span> <span class=number>4</span>c <span class=comment>// Domain Validated SSL</span></span><br><span class=line></span><br><span class=line><span class=number>31</span> <span class=number>1</span>d       <span class=comment>// SET类型(31) 无序数列, 长度29(1d)</span></span><br><span class=line><span class=number>30</span> <span class=number>1b</span>       <span class=comment>// SEQUENCE类型(30), 长度27(1b)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>04</span> <span class=number>03</span>    <span class=comment>// 2.5.4.3 - id-at-commonName</span></span><br><span class=line><span class=number>13</span> <span class=number>14</span>       <span class=comment>// Printable String类型(13) 长度20(14)</span></span><br><span class=line><span class=number>54</span> <span class=number>72</span> <span class=number>75</span> <span class=number>73</span> <span class=number>74</span> <span class=number>41</span> <span class=number>73</span> <span class=number>69</span> <span class=number>61</span> <span class=number>20</span> <span class=number>54</span> <span class=number>4</span>c <span class=number>53</span> <span class=number>20</span> <span class=number>52</span> <span class=number>53</span> <span class=number>41</span> <span class=number>20</span> <span class=number>43</span> <span class=number>41</span> <span class=comment>// TrustAsia TLS RSA CA</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>1</span>e       <span class=comment>// SEQUENCE类型(30), 长度30(1e)</span></span><br><span class=line><span class=number>17</span> <span class=number>0</span>d       <span class=comment>// UTCTime类型(17), 长度13(0d)</span></span><br><span class=line><span class=number>31</span> <span class=number>38</span> <span class=number>31</span> <span class=number>30</span> <span class=number>32</span> <span class=number>37</span> <span class=number>30</span> <span class=number>30</span> <span class=number>30</span> <span class=number>30</span> <span class=number>30</span> <span class=number>30</span> <span class=number>5</span>a <span class=comment>// 181027000000Z</span></span><br><span class=line></span><br><span class=line><span class=number>17</span> <span class=number>0</span>d       <span class=comment>// UTCTime类型(17), 长度13(0d)</span></span><br><span class=line><span class=number>32</span> <span class=number>30</span> <span class=number>30</span> <span class=number>31</span> <span class=number>32</span> <span class=number>35</span> <span class=number>31</span> <span class=number>32</span> <span class=number>30</span> <span class=number>30</span> <span class=number>30</span> <span class=number>30</span> <span class=number>5</span>a <span class=comment>// 200125120000Z</span></span><br><span class=line></span><br><span class=line><span class=comment>// Subject 信息</span></span><br><span class=line><span class=number>30</span> <span class=number>18</span>       <span class=comment>// SEQUENCE类型(30), 长度24(18)</span></span><br><span class=line><span class=number>31</span> <span class=number>16</span>       <span class=comment>// SET类型(31) 无序数列, 长度22(16)</span></span><br><span class=line><span class=number>30</span> <span class=number>14</span>       <span class=comment>// SEQUENCE类型(30), 长度20(14)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>04</span> <span class=number>03</span>    <span class=comment>// 2.5.4.3 - id-at-commonName</span></span><br><span class=line><span class=number>13</span> <span class=number>0</span>d       <span class=comment>// Printable String类型(13) 长度13(d)</span></span><br><span class=line><span class=number>77</span> <span class=number>77</span> <span class=number>77</span> <span class=number>2</span>e <span class=number>7</span>a <span class=number>68</span> <span class=number>65</span> <span class=number>6</span>e <span class=number>6</span>c <span class=number>79</span> <span class=number>2</span>e <span class=number>63</span> <span class=number>6</span>e <span class=comment>// www.zhenly.cn</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>82</span> <span class=number>01</span> <span class=number>22</span> <span class=comment>// SEQUENCE类型(30), 长度的长度2(82), 长度290(0122)</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>0</span>d       <span class=comment>// SEQUENCE类型(30), 长度13(d)</span></span><br><span class=line><span class=number>06</span> <span class=number>09</span>       <span class=comment>// Object Identifier 类型(06)，长度9(09)</span></span><br><span class=line><span class=number>2</span>a <span class=number>86</span> <span class=number>48</span> <span class=number>86</span> f7 <span class=number>0</span>d <span class=number>01</span> <span class=number>01</span> <span class=number>01</span></span><br><span class=line><span class=comment>// ‭00101010 10000110 01001000 10000110 ‭11110111‬ 00001101 00000001 00000001 00000001‬</span></span><br><span class=line><span class=comment>// 0101010 00001101001000 000011011101110001101 0000001 0000001 0000001‬</span></span><br><span class=line><span class=comment>// 42 840 113549 1 1 1</span></span><br><span class=line><span class=comment>// 1.2.840.113549.1.1.1</span></span><br><span class=line><span class=comment>// RSA encryption</span></span><br><span class=line><span class=number>05</span> <span class=number>00</span> <span class=comment>// Null</span></span><br><span class=line></span><br><span class=line><span class=number>03</span> <span class=number>82</span> <span class=number>01</span> <span class=number>0f</span>  <span class=comment>// BIT STRING类型， 长度的长度2(82), 长度‭271‬(010f)</span></span><br><span class=line><span class=number>00</span>           <span class=comment>// 开始 270位RSA公钥</span></span><br><span class=line><span class=number>30</span> <span class=number>82</span> <span class=number>01</span> <span class=number>0</span>a <span class=number>02</span> <span class=number>82</span> <span class=number>01</span> <span class=number>01</span> <span class=number>00</span> b3 f3 cf fd f4 <span class=number>6f</span> bb fd <span class=number>45</span> <span class=number>80</span> ae <span class=number>80</span> <span class=number>01</span> <span class=number>8</span>e dd <span class=number>85</span> f4 <span class=number>87</span></span><br><span class=line><span class=number>18</span> <span class=number>47</span> <span class=number>51</span> fa a3 <span class=number>6f</span> f3 <span class=number>61</span> <span class=number>41</span> <span class=number>47</span> c9 <span class=number>58</span> dd b6 <span class=number>87</span> e3 <span class=number>18</span> df <span class=number>05</span> <span class=number>2b</span> <span class=number>14</span> fd <span class=number>6</span>d <span class=number>31</span> e7 <span class=number>78</span> ef</span><br><span class=line><span class=number>03</span> c9 <span class=number>53</span> b2 <span class=number>5f</span> <span class=number>11</span> fa <span class=number>49</span> <span class=number>51</span> <span class=number>2f</span> <span class=number>56</span> <span class=number>57</span> c1 <span class=number>84</span> <span class=number>5</span>e <span class=number>7</span>a f9 <span class=number>7f</span> c0 <span class=number>55</span> ec <span class=number>64</span> <span class=number>26</span> <span class=number>0b</span> <span class=number>07</span> <span class=number>2</span>e <span class=number>67</span></span><br><span class=line><span class=number>99</span> <span class=number>1</span>c c4 <span class=number>65</span> <span class=number>66</span> de cb <span class=number>32</span> a9 a3 ed <span class=number>96</span> e5 <span class=number>1</span>e <span class=number>0f</span> <span class=number>43</span> <span class=number>35</span> d9 <span class=number>14</span> d6 <span class=number>4f</span> fd <span class=number>20</span> ed fd <span class=number>08</span> <span class=number>2</span>e</span><br><span class=line>b4 ad fb <span class=number>97</span> <span class=number>44</span> a6 <span class=number>9</span>d <span class=number>5f</span> <span class=number>06</span> <span class=number>9f</span> <span class=number>24</span> <span class=number>7</span>d dc cf <span class=number>91</span> <span class=number>41</span> ca f8 <span class=number>22</span> <span class=number>49</span> <span class=number>3</span>d ab <span class=number>47</span> <span class=number>76</span> <span class=number>96</span> <span class=number>88</span> <span class=number>7</span>d</span><br><span class=line><span class=number>69</span> <span class=number>3</span>d <span class=number>25</span> c6 b4 <span class=number>84</span> <span class=number>6</span>d <span class=number>6</span>d <span class=number>44</span> b4 b7 <span class=number>41</span> <span class=number>65</span> <span class=number>8</span>c <span class=number>55</span> <span class=number>16</span> <span class=number>31</span> c3 <span class=number>56</span> <span class=number>50</span> a9 <span class=number>49</span> b0 <span class=number>90</span> e5 <span class=number>47</span> ec</span><br><span class=line><span class=number>33</span> <span class=number>5</span>e <span class=number>80</span> <span class=number>5</span>a <span class=number>78</span> <span class=number>9</span>a <span class=number>75</span> <span class=number>91</span> <span class=number>6</span>e f9 <span class=number>11</span> f8 <span class=number>64</span> <span class=number>6f</span> b1 <span class=number>93</span> <span class=number>35</span> bb <span class=number>7</span>a <span class=number>0</span>d b2 <span class=number>20</span> <span class=number>2</span>e ca <span class=number>6b</span> <span class=number>3b</span> <span class=number>63</span></span><br><span class=line>c5 ef <span class=number>38</span> e8 c0 b1 <span class=number>07</span> <span class=number>72</span> <span class=number>7</span>d c4 c6 b5 <span class=number>5b</span> f7 <span class=number>9</span>c e5 ae <span class=number>3</span>e <span class=number>1b</span> cb <span class=number>7</span>a <span class=number>18</span> <span class=number>6</span>c <span class=number>3</span>e <span class=number>48</span> ef d9</span><br><span class=line><span class=number>88</span> <span class=number>64</span> d6 <span class=number>63</span> <span class=number>25</span> a1 <span class=number>56</span> <span class=number>47</span> <span class=number>00</span> <span class=number>0</span>e a9 <span class=number>8b</span> aa <span class=number>6</span>d ac d6 <span class=number>19</span> c8 aa af da <span class=number>95</span> <span class=number>28</span> c0 <span class=number>54</span> <span class=number>32</span> <span class=number>90</span></span><br><span class=line><span class=number>0</span>c <span class=number>6b</span> <span class=number>94</span> <span class=number>1f</span> <span class=number>10</span> cd <span class=number>16</span> <span class=number>87</span> <span class=number>22</span> a9 <span class=number>6f</span> <span class=number>65</span> <span class=number>70</span> ac <span class=number>55</span> ad <span class=number>5</span>a a3 d5 b8 <span class=number>97</span> ab <span class=number>02</span> <span class=number>03</span> <span class=number>01</span> <span class=number>00</span> <span class=number>01</span></span><br><span class=line></span><br><span class=line></span><br><span class=line>a3 <span class=number>82</span> <span class=number>02</span> <span class=number>7</span>d <span class=comment>// 扩展字段(a3),长度的长度2(82),长度637(27d)</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>82</span> <span class=number>02</span> <span class=number>79</span> <span class=comment>// SEQUENCE类型(30),长度的长度2(82), 长度‭633‬(279)</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>1f</span>       <span class=comment>// SEQUENCE类型(30),长度‭‭31‬‬(1f)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>1</span>d <span class=number>23</span></span><br><span class=line><span class=comment>// ‭01010101 00011101 00100011‬</span></span><br><span class=line><span class=comment>// ‭85‬ 29 35</span></span><br><span class=line><span class=comment>// 2.5.29.35 - Authority Key Identifier</span></span><br><span class=line></span><br><span class=line><span class=number>04</span> <span class=number>18</span>       <span class=comment>// OCTET STRING类型(04)，长度24(18)</span></span><br><span class=line><span class=number>30</span> <span class=number>16</span>       <span class=comment>// SEQUENCE类型(30),长度22(16)</span></span><br><span class=line><span class=number>80</span> <span class=number>14</span>       <span class=comment>// 表示证书的版本(80), 长度20(14)</span></span><br><span class=line><span class=number>7f</span> d3 <span class=number>99</span> f3 a0 <span class=number>47</span> <span class=number>0</span>e <span class=number>31</span> <span class=number>00</span> <span class=number>56</span> <span class=number>56</span> <span class=number>22</span> <span class=number>8</span>e b7 cc <span class=number>9</span>e dd ca <span class=number>01</span> <span class=number>8</span>a <span class=comment>// 7fd399f3a0470e31005656228eb7cc9eddca018a</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>1</span>d       <span class=comment>// SEQUENCE类型(30),长度29‬‬(1d)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>1</span>d <span class=number>0</span>e    <span class=comment>// 2.5.29.14 - Subject Key Identifier</span></span><br><span class=line></span><br><span class=line><span class=number>04</span> <span class=number>16</span>       <span class=comment>// OCTET STRING类型(04)，长度22(16)</span></span><br><span class=line><span class=number>04</span> <span class=number>14</span>       <span class=comment>// OCTET STRING类型(04)，长度20(14)</span></span><br><span class=line><span class=number>83</span> ad <span class=number>62</span> <span class=number>8f</span> f3 <span class=number>56</span> c4 <span class=number>1b</span> f3 <span class=number>26</span> <span class=number>5</span>e <span class=number>3</span>e <span class=number>4f</span> <span class=number>5f</span> <span class=number>09</span> <span class=number>90</span> <span class=number>1</span>e <span class=number>7</span>c fe bf <span class=comment>// 83ad628ff356c41bf3265e3e4f5f09901e7cfebf</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>23</span>       <span class=comment>// SEQUENCE类型(30),长度35‬‬(23)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>1</span>d <span class=number>11</span>    <span class=comment>// 2.5.29.17 - Subject Alternative Name</span></span><br><span class=line><span class=number>04</span> <span class=number>1</span>c       <span class=comment>// OCTET STRING类型(04)，长度28(1c)</span></span><br><span class=line><span class=number>30</span> <span class=number>1</span>a       <span class=comment>// SEQUENCE类型(30),长度26‬‬(1a)</span></span><br><span class=line><span class=number>82</span> <span class=number>0</span>d       <span class=comment>// subjectUniqueID表示证书主体的唯一id(82),长度13(d)</span></span><br><span class=line><span class=number>77</span> <span class=number>77</span> <span class=number>77</span> <span class=number>2</span>e <span class=number>7</span>a <span class=number>68</span> <span class=number>65</span> <span class=number>6</span>e <span class=number>6</span>c <span class=number>79</span> <span class=number>2</span>e <span class=number>63</span> <span class=number>6</span>e <span class=comment>// www.zhenly.cn</span></span><br><span class=line></span><br><span class=line><span class=number>82</span> <span class=number>09</span>      <span class=comment>// subjectUniqueID表示证书主体的唯一id(82),长度9(09)</span></span><br><span class=line><span class=number>7</span>a <span class=number>68</span> <span class=number>65</span> <span class=number>6</span>e <span class=number>6</span>c <span class=number>79</span> <span class=number>2</span>e <span class=number>63</span> <span class=number>6</span>e <span class=comment>// zhenly.cn</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>0</span>e       <span class=comment>// SEQUENCE类型(30),长度14‬‬(e)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>1</span>d <span class=number>0f</span>    <span class=comment>// 2.5.29.15 - Key Usage</span></span><br><span class=line><span class=number>01</span> <span class=number>01</span>       <span class=comment>// 布尔值类型(01)， 长度1(01)</span></span><br><span class=line>ff          <span class=comment>// true</span></span><br><span class=line></span><br><span class=line><span class=number>04</span> <span class=number>04</span>       <span class=comment>// OCTET STRING类型(04)，长度4(04)</span></span><br><span class=line><span class=number>03</span> <span class=number>02</span> <span class=number>05</span> a0 <span class=comment>// ???</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>1</span>d       <span class=comment>// SEQUENCE类型(30),长度29‬‬(1d)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>1</span>d <span class=number>25</span>    <span class=comment>// 2.5.29.37 - Extended key usage</span></span><br><span class=line></span><br><span class=line><span class=number>04</span> <span class=number>16</span>       <span class=comment>// OCTET STRING类型(04)，长度22(16)</span></span><br><span class=line><span class=number>30</span> <span class=number>14</span>       <span class=comment>// SEQUENCE类型(30),长度20‬‬(14)</span></span><br><span class=line><span class=number>06</span> <span class=number>08</span>       <span class=comment>// Object Identifier 类型(06)，长度8(08)</span></span><br><span class=line><span class=number>2b</span> <span class=number>06</span> <span class=number>01</span> <span class=number>05</span> <span class=number>05</span> <span class=number>07</span> <span class=number>03</span> <span class=number>01</span></span><br><span class=line><span class=comment>// 2b060105 05070301</span></span><br><span class=line><span class=comment>// ‭00101011 00000110 00000001 00000101‬ 0000‭0101 00000111 00000011 00000001‬</span></span><br><span class=line><span class=comment>// ‭0101011 0000110 0000001 0000101‬ 000‭0101 0000111 0000011 0000001‬</span></span><br><span class=line><span class=comment>// 43 6 1 5 5 7 3 1</span></span><br><span class=line><span class=comment>// 1.3.6.1.5.5.7.3.1 - id_kp_serverAuth</span></span><br><span class=line></span><br><span class=line><span class=number>06</span> <span class=number>08</span>       <span class=comment>// Object Identifier 类型(06)，长度8(08)</span></span><br><span class=line><span class=number>2b</span> <span class=number>06</span> <span class=number>01</span> <span class=number>05</span> <span class=number>05</span> <span class=number>07</span> <span class=number>03</span> <span class=number>02</span> <span class=comment>// 1.3.6.1.5.5.7.3.2 - id_kp_clientAuth</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>4</span>c       <span class=comment>// SEQUENCE类型(30),长度‭76‬(4c)</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span>       <span class=comment>// Object Identifier 类型(06)，长度3(03)</span></span><br><span class=line><span class=number>55</span> <span class=number>1</span>d <span class=number>20</span>    <span class=comment>// 2.5.29.32 - Certificate Policies</span></span><br><span class=line></span><br><span class=line><span class=number>04</span> <span class=number>45</span>       <span class=comment>// OCTET STRING类型(04)，长度69(45)</span></span><br><span class=line><span class=number>30</span> <span class=number>43</span>       <span class=comment>// SEQUENCE类型(30),长度‭67‬(43)</span></span><br><span class=line><span class=number>30</span> <span class=number>37</span>       <span class=comment>// SEQUENCE类型(30),长度‭55‬(37)</span></span><br><span class=line><span class=number>06</span> <span class=number>09</span>       <span class=comment>// Object Identifier 类型(06)，长度9(09)</span></span><br><span class=line><span class=number>60</span> <span class=number>86</span> <span class=number>48</span> <span class=number>01</span> <span class=number>86</span> fd <span class=number>6</span>c <span class=number>01</span> <span class=number>02</span></span><br><span class=line><span class=comment>// 60864801 86fd6c01 02</span></span><br><span class=line><span class=comment>// ‭01100000 10000110 01001000 00000001‬ ‭10000110 11111101 01101100 00000001‬ 00000010</span></span><br><span class=line><span class=comment>// ‭1100000 00001101001000 0000001‬ ‭000011011111011101100 0000001‬ 0000010</span></span><br><span class=line><span class=comment>// 96 840 1 114412 1 2</span></span><br><span class=line><span class=comment>// 2.16.840.1.114412.1.2 - Digicert EV</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>2</span>a       <span class=comment>// SEQUENCE类型(30),长度‭42(2a)</span></span><br><span class=line><span class=number>30</span> <span class=number>28</span>       <span class=comment>// SEQUENCE类型(30),长度‭40(28)</span></span><br><span class=line><span class=number>06</span> <span class=number>08</span>       <span class=comment>// Object Identifier 类型(06)，长度8</span></span><br><span class=line><span class=number>2b</span> <span class=number>06</span> <span class=number>01</span> <span class=number>05</span> <span class=number>05</span> <span class=number>07</span> <span class=number>02</span> <span class=number>01</span></span><br><span class=line><span class=comment>// 2b060105 05070201</span></span><br><span class=line><span class=comment>// 00101011 00000110 00000001 00000101 0000‭0101 00000111 00000010 00000001‬</span></span><br><span class=line><span class=comment>// 0101011 0000110 0000001 0000101 000‭0101 0000111 0000010 0000001‬</span></span><br><span class=line><span class=comment>// 43 6 1 5 5 7 2 1</span></span><br><span class=line><span class=comment>// 1.3.6.1.5.5.7.2.1 - id-qt-cps: OID for CPS qualifier</span></span><br><span class=line></span><br><span class=line><span class=number>16</span> <span class=number>1</span>c       <span class=comment>// IA5String类型(16),长度28</span></span><br><span class=line><span class=number>68</span> <span class=number>74</span> <span class=number>74</span> <span class=number>70</span> <span class=number>73</span> <span class=number>3</span>a <span class=number>2f</span> <span class=number>2f</span> <span class=number>77</span> <span class=number>77</span> <span class=number>77</span> <span class=number>2</span>e <span class=number>64</span> <span class=number>69</span> <span class=number>67</span> <span class=number>69</span> <span class=number>63</span> <span class=number>65</span> <span class=number>72</span> <span class=number>74</span> <span class=number>2</span>e <span class=number>63</span> <span class=number>6f</span> <span class=number>6</span>d <span class=number>2f</span> <span class=number>43</span> <span class=number>50</span> <span class=number>53</span> <span class=comment>// https://www.digicert.com/CPS</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>08</span>       <span class=comment>// SEQUENCE类型(30),长度8</span></span><br><span class=line><span class=number>06</span> <span class=number>06</span>       <span class=comment>// Object Identifier 类型(06)，长度6</span></span><br><span class=line><span class=number>67</span> <span class=number>81</span> <span class=number>0</span>c <span class=number>01</span> <span class=number>02</span> <span class=number>01</span></span><br><span class=line><span class=comment>// 67810c01 02 01</span></span><br><span class=line><span class=comment>// 01100111 10000001 00001100 00000001 00000002 00000001</span></span><br><span class=line><span class=comment>// 1100111 00000010001100 0000001 0000002 0000001</span></span><br><span class=line><span class=comment>// 103 140 1 2 1</span></span><br><span class=line><span class=comment>// 2.23.140.1.2.1 - domain-validated</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>81</span> <span class=number>81</span> <span class=comment>// SEQUENCE类型(30),长度129</span></span><br><span class=line><span class=number>06</span> <span class=number>08</span></span><br><span class=line><span class=number>2b</span> <span class=number>06</span> <span class=number>01</span> <span class=number>05</span> <span class=number>05</span> <span class=number>07</span> <span class=number>01</span> <span class=number>01</span> <span class=comment>// 1.3.6.1.5.5.7.1.1 - id-pe-authorityInfoAccess</span></span><br><span class=line></span><br><span class=line><span class=number>04</span> <span class=number>75</span></span><br><span class=line><span class=number>30</span> <span class=number>73</span></span><br><span class=line><span class=number>30</span> <span class=number>25</span></span><br><span class=line><span class=number>06</span> <span class=number>08</span></span><br><span class=line><span class=number>2b</span> <span class=number>06</span> <span class=number>01</span> <span class=number>05</span> <span class=number>05</span> <span class=number>07</span> <span class=number>30</span> <span class=number>01</span> <span class=comment>// 1.3.6.1.5.5.7.48.1 - OCSP</span></span><br><span class=line></span><br><span class=line><span class=number>86</span> <span class=number>19</span> <span class=comment>// 特殊IA5String类型(86),长度25</span></span><br><span class=line><span class=number>68</span> <span class=number>74</span> <span class=number>74</span> <span class=number>70</span> <span class=number>3</span>a <span class=number>2f</span> <span class=number>2f</span> <span class=number>6f</span> <span class=number>63</span> <span class=number>73</span> <span class=number>70</span> <span class=number>32</span> <span class=number>2</span>e <span class=number>64</span> <span class=number>69</span> <span class=number>67</span> <span class=number>69</span> <span class=number>63</span> <span class=number>65</span> <span class=number>72</span> <span class=number>74</span> <span class=number>2</span>e <span class=number>63</span> <span class=number>6f</span> <span class=number>6</span>d <span class=comment>// http://ocsp2.digicert.com</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>4</span>a <span class=comment>// 74</span></span><br><span class=line><span class=number>06</span> <span class=number>08</span></span><br><span class=line><span class=number>2b</span> <span class=number>06</span> <span class=number>01</span> <span class=number>05</span> <span class=number>05</span> <span class=number>07</span> <span class=number>30</span> <span class=number>02</span> <span class=comment>// 1.3.6.1.5.5.7.48.2 - id-ad-caIssuers</span></span><br><span class=line></span><br><span class=line><span class=number>86</span> <span class=number>3</span>e <span class=comment>// 特殊IA5String类型(86),长度62</span></span><br><span class=line><span class=number>68</span> <span class=number>74</span> <span class=number>74</span> <span class=number>70</span> <span class=number>3</span>a <span class=number>2f</span> <span class=number>2f</span> <span class=number>63</span> <span class=number>61</span> <span class=number>63</span></span><br><span class=line><span class=number>65</span> <span class=number>72</span> <span class=number>74</span> <span class=number>73</span> <span class=number>2</span>e <span class=number>64</span> <span class=number>69</span> <span class=number>67</span> <span class=number>69</span> <span class=number>74</span></span><br><span class=line><span class=number>61</span> <span class=number>6</span>c <span class=number>63</span> <span class=number>65</span> <span class=number>72</span> <span class=number>74</span> <span class=number>76</span> <span class=number>61</span> <span class=number>6</span>c <span class=number>69</span></span><br><span class=line><span class=number>64</span> <span class=number>61</span> <span class=number>74</span> <span class=number>69</span> <span class=number>6f</span> <span class=number>6</span>e <span class=number>2</span>e <span class=number>63</span> <span class=number>6f</span> <span class=number>6</span>d</span><br><span class=line><span class=number>2f</span> <span class=number>54</span> <span class=number>72</span> <span class=number>75</span> <span class=number>73</span> <span class=number>74</span> <span class=number>41</span> <span class=number>73</span> <span class=number>69</span> <span class=number>61</span></span><br><span class=line><span class=number>54</span> <span class=number>4</span>c <span class=number>53</span> <span class=number>52</span> <span class=number>53</span> <span class=number>41</span> <span class=number>43</span> <span class=number>41</span> <span class=number>2</span>e <span class=number>63</span> <span class=number>72</span> <span class=number>74</span> <span class=comment>// http://cacerts.digitalcertvalidation.com/TrustAsiaTLSRSACA.crt</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>09</span></span><br><span class=line><span class=number>06</span> <span class=number>03</span></span><br><span class=line><span class=number>55</span> <span class=number>1</span>d <span class=number>13</span> <span class=comment>// 2.5.29.19 - Basic Constraints</span></span><br><span class=line><span class=number>04</span> <span class=number>02</span></span><br><span class=line><span class=number>30</span> <span class=number>00</span></span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>82</span> <span class=number>01</span> <span class=number>04</span> <span class=comment>// 206</span></span><br><span class=line></span><br><span class=line><span class=number>06</span> <span class=number>0</span>a</span><br><span class=line><span class=number>2b</span> <span class=number>06</span> <span class=number>01</span> <span class=number>04</span> <span class=number>01</span> d6 <span class=number>79</span> <span class=number>02</span> <span class=number>04</span> <span class=number>02</span></span><br><span class=line><span class=comment>// 2b060104 01d67902 0402</span></span><br><span class=line><span class=comment>// 00101011 00000110 00000001 00000100 00000001 11010110 01111001 00000010 00000100 00000010</span></span><br><span class=line><span class=comment>// 0101011 0000110 0000001 0000100 0000001 10101101111001 0000010 0000100 0000010</span></span><br><span class=line><span class=comment>// 43 6 1 4 1 11129 2 4 2</span></span><br><span class=line><span class=comment>// 1.3.6.1.4.1.11129.2.4.2 - x.509 extension for certificate transparency SCTs</span></span><br><span class=line></span><br><span class=line><span class=number>04</span> <span class=number>81</span> f5 <span class=comment>// 245</span></span><br><span class=line><span class=number>04</span> <span class=number>81</span> f2 <span class=comment>// 242</span></span><br><span class=line><span class=number>00</span> <span class=comment>// 开始241个字符</span></span><br><span class=line>f0 <span class=number>00</span> <span class=number>76</span> <span class=number>00</span> a4 b9 <span class=number>09</span> <span class=number>90</span> b4 <span class=number>18</span> <span class=number>58</span> <span class=number>14</span> <span class=number>87</span> bb <span class=number>13</span> a2 cc <span class=number>67</span> <span class=number>70</span> <span class=number>0</span>a</span><br><span class=line><span class=number>3</span>c <span class=number>35</span> <span class=number>98</span> <span class=number>04</span> f9 <span class=number>1b</span> df b8 e3 <span class=number>77</span> cd <span class=number>0</span>e c8 <span class=number>0</span>d dc <span class=number>10</span> <span class=number>00</span> <span class=number>00</span> <span class=number>01</span> <span class=number>66</span></span><br><span class=line>b3 <span class=number>86</span> <span class=number>13</span> a9 <span class=number>00</span> <span class=number>00</span> <span class=number>04</span> <span class=number>03</span> <span class=number>00</span> <span class=number>47</span> <span class=number>30</span> <span class=number>45</span> <span class=number>02</span> <span class=number>21</span> <span class=number>00</span> da a3 <span class=number>73</span> <span class=number>26</span> <span class=number>49</span></span><br><span class=line>ec <span class=number>0</span>e <span class=number>64</span> <span class=number>42</span> <span class=number>48</span> <span class=number>9f</span> <span class=number>00</span> ba <span class=number>6</span>e d9 fa <span class=number>1</span>c <span class=number>85</span> ca aa db ad a5 <span class=number>16</span> <span class=number>57</span></span><br><span class=line><span class=number>2</span>a <span class=number>47</span> <span class=number>27</span> <span class=number>3f</span> <span class=number>2b</span> <span class=number>2</span>e bb <span class=number>02</span> <span class=number>20</span> <span class=number>6</span>a <span class=number>4</span>e <span class=number>48</span> <span class=number>20</span> <span class=number>74</span> <span class=number>97</span> <span class=number>33</span> fc e9 a4 <span class=number>00</span></span><br><span class=line><span class=number>25</span> c5 ce be <span class=number>78</span> d9 fd <span class=number>68</span> <span class=number>66</span> <span class=number>58</span> <span class=number>3b</span> e1 f8 <span class=number>98</span> <span class=number>18</span> <span class=number>4</span>e f4 a6 <span class=number>4</span>e <span class=number>2b</span></span><br><span class=line>a5 <span class=number>00</span> <span class=number>76</span> <span class=number>00</span> <span class=number>87</span> <span class=number>75</span> bf e7 <span class=number>59</span> <span class=number>7</span>c f8 <span class=number>8</span>c <span class=number>43</span> <span class=number>99</span> <span class=number>5f</span> bd f3 <span class=number>6</span>e ff <span class=number>56</span></span><br><span class=line><span class=number>8</span>d <span class=number>47</span> <span class=number>56</span> <span class=number>36</span> ff <span class=number>4</span>a b5 <span class=number>60</span> c1 b4 ea ff <span class=number>5</span>e a0 <span class=number>83</span> <span class=number>0f</span> <span class=number>00</span> <span class=number>00</span> <span class=number>01</span> <span class=number>66</span></span><br><span class=line>b3 <span class=number>86</span> <span class=number>14</span> <span class=number>90</span> <span class=number>00</span> <span class=number>00</span> <span class=number>04</span> <span class=number>03</span> <span class=number>00</span> <span class=number>47</span> <span class=number>30</span> <span class=number>45</span> <span class=number>02</span> <span class=number>20</span> <span class=number>3f</span> <span class=number>27</span> e1 <span class=number>9</span>e cc <span class=number>65</span></span><br><span class=line><span class=number>2</span>e <span class=number>3</span>c d6 <span class=number>67</span> cf <span class=number>78</span> f5 <span class=number>0b</span> <span class=number>03</span> <span class=number>90</span> fa <span class=number>7</span>c <span class=number>08</span> b5 <span class=number>11</span> <span class=number>29</span> c1 <span class=number>85</span> <span class=number>22</span> <span class=number>21</span></span><br><span class=line><span class=number>10</span> <span class=number>36</span> <span class=number>21</span> c8 <span class=number>40</span> e5 <span class=number>02</span> <span class=number>21</span> <span class=number>00</span> ad <span class=number>36</span> ed be <span class=number>18</span> ee b6 a6 cd c0 d4</span><br><span class=line><span class=number>96</span> <span class=number>74</span> <span class=number>62</span> <span class=number>2b</span> <span class=number>97</span> cc d9 b5 cf <span class=number>27</span> <span class=number>9</span>a <span class=number>8</span>a <span class=number>52</span> <span class=number>61</span> <span class=number>84</span> <span class=number>57</span> <span class=number>22</span> <span class=number>60</span> c6 b9 <span class=number>5</span>e</span><br><span class=line></span><br><span class=line><span class=number>30</span> <span class=number>0</span>d</span><br><span class=line><span class=number>06</span> <span class=number>09</span></span><br><span class=line><span class=number>2</span>a <span class=number>86</span> <span class=number>48</span> <span class=number>86</span> f7 <span class=number>0</span>d <span class=number>01</span> <span class=number>01</span> <span class=number>0b</span> <span class=comment>// 1.2.840.113549.1.1.11 - sha256WithRSAEncryption</span></span><br><span class=line><span class=number>05</span> <span class=number>00</span></span><br><span class=line></span><br><span class=line><span class=number>03</span> <span class=number>82</span> <span class=number>01</span> <span class=number>01</span> <span class=comment>// 257</span></span><br><span class=line><span class=number>00</span> <span class=comment>// 开始256</span></span><br><span class=line><span class=number>63</span> bf <span class=number>1</span>a ec <span class=number>14</span> <span class=number>19</span> fc <span class=number>15</span> f6 <span class=number>3f</span> cf <span class=number>1f</span> <span class=number>13</span> <span class=number>9</span>a <span class=number>67</span> fa <span class=number>47</span> <span class=number>60</span> <span class=number>6</span>d <span class=number>8</span>d</span><br><span class=line><span class=number>5</span>a <span class=number>9</span>d <span class=number>45</span> <span class=number>04</span> ce <span class=number>4</span>e cd <span class=number>76</span> <span class=number>86</span> <span class=number>96</span> fc <span class=number>4f</span> <span class=number>62</span> <span class=number>1</span>d ca a0 f0 <span class=number>4</span>e <span class=number>24</span> b3</span><br><span class=line>ad c5 ee <span class=number>85</span> d9 fe <span class=number>8</span>c <span class=number>64</span> <span class=number>20</span> <span class=number>0</span>e <span class=number>50</span> <span class=number>97</span> d5 <span class=number>62</span> <span class=number>11</span> c5 <span class=number>20</span> e3 <span class=number>4</span>c <span class=number>7b</span></span><br><span class=line><span class=number>98</span> <span class=number>82</span> <span class=number>57</span> <span class=number>82</span> <span class=number>0</span>e <span class=number>95</span> <span class=number>27</span> <span class=number>2</span>d a8 <span class=number>94</span> df <span class=number>16</span> <span class=number>20</span> <span class=number>47</span> a9 b2 <span class=number>53</span> <span class=number>58</span> <span class=number>56</span> d3</span><br><span class=line><span class=number>39</span> <span class=number>11</span> c2 <span class=number>5</span>a <span class=number>57</span> <span class=number>20</span> c1 <span class=number>8</span>c e7 <span class=number>31</span> <span class=number>62</span> <span class=number>6</span>a <span class=number>25</span> <span class=number>4</span>c b1 <span class=number>38</span> <span class=number>39</span> <span class=number>97</span> <span class=number>2</span>e <span class=number>41</span></span><br><span class=line><span class=number>6</span>d <span class=number>58</span> c6 ac <span class=number>02</span> <span class=number>23</span> <span class=number>45</span> e5 f2 <span class=number>4</span>d <span class=number>1f</span> <span class=number>92</span> <span class=number>16</span> <span class=number>49</span> c8 a9 <span class=number>6</span>e fc bd <span class=number>1</span>a</span><br><span class=line>e1 dd f0 <span class=number>25</span> <span class=number>4</span>d e8 <span class=number>57</span> <span class=number>4</span>d <span class=number>93</span> <span class=number>10</span> <span class=number>7</span>c <span class=number>10</span> <span class=number>63</span> <span class=number>0</span>a <span class=number>0</span>a be <span class=number>51</span> <span class=number>68</span> ec f1</span><br><span class=line>be da c7 <span class=number>65</span> <span class=number>22</span> a8 <span class=number>61</span> <span class=number>5</span>c <span class=number>2</span>a <span class=number>7</span>d <span class=number>40</span> dd <span class=number>02</span> <span class=number>28</span> ee b3 <span class=number>1</span>d b9 <span class=number>78</span> <span class=number>0</span>d</span><br><span class=line>b4 <span class=number>76</span> <span class=number>1</span>c <span class=number>72</span> ad <span class=number>89</span> d5 <span class=number>44</span> <span class=number>12</span> <span class=number>4b</span> <span class=number>42</span> aa <span class=number>07</span> <span class=number>77</span> <span class=number>14</span> <span class=number>4</span>d <span class=number>38</span> d5 <span class=number>81</span> <span class=number>4b</span></span><br><span class=line>e5 <span class=number>09</span> cc <span class=number>3</span>d ba ca c9 aa b6 b1 <span class=number>60</span> <span class=number>34</span> <span class=number>5</span>d <span class=number>89</span> <span class=number>86</span> cf <span class=number>78</span> a7 bf a5</span><br><span class=line>b8 be <span class=number>85</span> <span class=number>0b</span> b9 <span class=number>14</span> <span class=number>0f</span> a7 <span class=number>2</span>d <span class=number>7</span>a <span class=number>4</span>c d0 <span class=number>2f</span> ee <span class=number>86</span> <span class=number>20</span> <span class=number>02</span> cf <span class=number>9</span>d d1</span><br><span class=line><span class=number>01</span> <span class=number>18</span> <span class=number>9</span>a c0 a1 <span class=number>95</span> <span class=number>8</span>a <span class=number>8f</span> d8 dc <span class=number>3</span>a <span class=number>60</span> ad <span class=number>67</span> <span class=number>72</span> <span class=number>56</span> a5 <span class=number>10</span> dd d9</span><br><span class=line><span class=number>81</span> e5 <span class=number>3</span>e <span class=number>72</span> ba d6 b1 cd <span class=number>8b</span> <span class=number>2</span>c <span class=number>3</span>a <span class=number>21</span> <span class=number>90</span> <span class=number>10</span> <span class=number>0</span>a <span class=number>27</span></span><br></pre></table></figure><h2 id=c-语言源代码><a class=markdownIt-Anchor href=#c-语言源代码></a> C 语言源代码</h2><p>代码仓库： <a target=_blank rel=noopener href=https://github.com/ZhenlyChen/X.509Reader>Github</a><h3 id=读取文件><a class=markdownIt-Anchor href=#读取文件></a> 读取文件</h3><p>首先读取证书文件，将其的<p><code>-----BEGIN CERTIFICATE-----</code>和<code>-----END CERTIFICATE-----</code>之中的Base64编码读取到字符串中<figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br></pre><td class=code><pre><span class=line><span class=comment>// main.cpp</span></span><br><span class=line><span class=built_in>string</span> fileName;</span><br><span class=line><span class=built_in>string</span> base64Str = <span class=string>&quot;&quot;</span>;</span><br><span class=line>fileName = <span class=built_in>string</span>(argv[<span class=number>1</span>]);</span><br><span class=line><span class=function>ifstream <span class=title>in</span><span class=params>(fileName)</span></span>;</span><br><span class=line><span class=keyword>if</span> (!in.is_open()) &#123;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;Error opening file&quot;</span>;</span><br><span class=line>  <span class=built_in>exit</span>(<span class=number>1</span>);</span><br><span class=line>&#125;</span><br><span class=line><span class=built_in>cout</span> &lt;&lt; fileName &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line><span class=keyword>char</span> buffer[<span class=number>1024</span>];</span><br><span class=line><span class=keyword>while</span> (!in.eof()) &#123;</span><br><span class=line>  in.getline(buffer, <span class=number>1024</span>);</span><br><span class=line>  <span class=keyword>if</span> (<span class=built_in>string</span>(buffer).find(<span class=string>&quot;BEGIN CERTIFICATE&quot;</span>) != <span class=number>-1</span>) &#123;</span><br><span class=line>    <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;Begin&quot;</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>  &#125; <span class=keyword>else</span> <span class=keyword>if</span> (<span class=built_in>string</span>(buffer).find(<span class=string>&quot;END CERTIFICATE&quot;</span>) != <span class=number>-1</span>) &#123;</span><br><span class=line>    parseX509(base64Str);</span><br><span class=line>    <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;End&quot;</span> &lt;&lt; <span class=built_in>endl</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>    base64Str = <span class=string>&quot;&quot;</span>;</span><br><span class=line>  &#125; <span class=keyword>else</span> &#123;</span><br><span class=line>    base64Str.append(buffer);</span><br><span class=line>  &#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><h3 id=base64解码><a class=markdownIt-Anchor href=#base64解码></a> Base64解码</h3><figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br></pre><td class=code><pre><span class=line><span class=comment>// x509.cpp</span></span><br><span class=line></span><br><span class=line><span class=keyword>static</span> <span class=keyword>const</span> <span class=built_in>string</span> base64_chars =</span><br><span class=line>    <span class=string>&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class=line>    <span class=string>&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class=line>    <span class=string>&quot;0123456789+/&quot;</span>;</span><br><span class=line></span><br><span class=line><span class=keyword>while</span> (data.length() % <span class=number>4</span> != <span class=number>0</span>) &#123;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;Error&quot;</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>  data.append(<span class=string>&quot;=&quot;</span>);</span><br><span class=line>&#125;</span><br><span class=line><span class=keyword>int</span> len = (data.length() / <span class=number>4</span>) * <span class=number>3</span>;</span><br><span class=line><span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;证书长度：&quot;</span> &lt;&lt; len &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>byte text[len] = &#123;<span class=number>0</span>&#125;;</span><br><span class=line><span class=keyword>int</span> textIndex = <span class=number>0</span>;</span><br><span class=line><span class=keyword>for</span> (<span class=keyword>int</span> i = <span class=number>0</span>; i &lt; data.length(); i += <span class=number>4</span>) &#123;</span><br><span class=line>  byte base64_bit_6[<span class=number>4</span>];</span><br><span class=line>  <span class=keyword>for</span> (<span class=keyword>int</span> j = <span class=number>0</span>; j &lt; <span class=number>4</span>; j++) &#123;</span><br><span class=line>    base64_bit_6[j] = base64_chars.find(data[i + j]);</span><br><span class=line>  &#125;</span><br><span class=line>  text[textIndex] =</span><br><span class=line>    ((base64_bit_6[<span class=number>0</span>] &amp; <span class=number>0x3f</span>) &lt;&lt; <span class=number>2</span>) | ((base64_bit_6[<span class=number>1</span>] &amp; <span class=number>0x30</span>) &gt;&gt; <span class=number>4</span>);</span><br><span class=line>  text[textIndex + <span class=number>1</span>] =</span><br><span class=line>    ((base64_bit_6[<span class=number>1</span>] &amp; <span class=number>0xf</span>) &lt;&lt; <span class=number>4</span>) | ((base64_bit_6[<span class=number>2</span>] &amp; <span class=number>0x3c</span>) &gt;&gt; <span class=number>2</span>);</span><br><span class=line>  text[textIndex + <span class=number>2</span>] =</span><br><span class=line>    ((base64_bit_6[<span class=number>2</span>] &amp; <span class=number>0x3</span>) &lt;&lt; <span class=number>6</span>) | (base64_bit_6[<span class=number>3</span>] &amp; <span class=number>0x3f</span>);</span><br><span class=line>  textIndex += <span class=number>3</span>;</span><br><span class=line>&#125;</span><br></pre></table></figure><h3 id=ans1解码><a class=markdownIt-Anchor href=#ans1解码></a> ANS.1解码</h3><p>解析<figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre><td class=code><pre><span class=line>parseANS(text, <span class=number>0</span>, len);</span><br></pre></table></figure><p>这里使用递归的方式解析将二进制数据根据ANS.1中的长度将其划分为不同的部分进行解析<figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br><span class=line>141</span><br><span class=line>142</span><br><span class=line>143</span><br><span class=line>144</span><br><span class=line>145</span><br><span class=line>146</span><br><span class=line>147</span><br><span class=line>148</span><br><span class=line>149</span><br><span class=line>150</span><br><span class=line>151</span><br><span class=line>152</span><br><span class=line>153</span><br><span class=line>154</span><br><span class=line>155</span><br><span class=line>156</span><br><span class=line>157</span><br><span class=line>158</span><br><span class=line>159</span><br><span class=line>160</span><br><span class=line>161</span><br></pre><td class=code><pre><span class=line><span class=keyword>typedef</span> <span class=class><span class=keyword>struct</span> &#123;</span></span><br><span class=line>  <span class=keyword>int</span> len;     <span class=comment>// 长度</span></span><br><span class=line>  <span class=keyword>int</span> lenLen;  <span class=comment>// 长度所占的长度</span></span><br><span class=line>&#125; lenData;     <span class=comment>// 长度信息</span></span><br><span class=line></span><br><span class=line><span class=keyword>typedef</span> <span class=class><span class=keyword>struct</span> &#123;</span></span><br><span class=line>  <span class=built_in>string</span> title;</span><br><span class=line>  <span class=keyword>int</span> len;</span><br><span class=line>  byte* data;</span><br><span class=line>  <span class=keyword>int</span> type;</span><br><span class=line>&#125; Item;  <span class=comment>// 解析项目</span></span><br><span class=line></span><br><span class=line><span class=built_in>vector</span>&lt;Item&gt; ansData;</span><br><span class=line></span><br><span class=line><span class=comment>// 长度、长度占用</span></span><br><span class=line><span class=function>lenData <span class=title>getLen</span><span class=params>(byte* data, <span class=keyword>int</span> i)</span> </span>&#123;</span><br><span class=line>  lenData res;</span><br><span class=line>  res.lenLen = <span class=number>1</span>;</span><br><span class=line>  <span class=keyword>if</span> (data[i] &amp; <span class=number>0x80</span>) &#123;</span><br><span class=line>    <span class=keyword>int</span> len_len = data[i] &amp; <span class=number>0x7f</span>;</span><br><span class=line>    <span class=keyword>int</span> len = <span class=number>0</span>;</span><br><span class=line>    i++;</span><br><span class=line>    <span class=keyword>for</span> (<span class=keyword>int</span> j = <span class=number>0</span>; j &lt; len_len; j++) &#123;</span><br><span class=line>      len &lt;&lt;= <span class=number>8</span>;</span><br><span class=line>      len += data[i + j];</span><br><span class=line>    &#125;</span><br><span class=line>    res.len = len;</span><br><span class=line>    res.lenLen += len_len;</span><br><span class=line>  &#125; <span class=keyword>else</span> &#123;</span><br><span class=line>    res.len = data[i] &amp; <span class=number>0x7f</span>;</span><br><span class=line>  &#125;</span><br><span class=line>  <span class=keyword>return</span> res;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=function><span class=keyword>void</span> <span class=title>parseANS</span><span class=params>(byte* data, <span class=keyword>int</span> begin, <span class=keyword>int</span> end)</span> </span>&#123;</span><br><span class=line>  <span class=keyword>int</span> i = begin;</span><br><span class=line>  lenData lens;</span><br><span class=line>  byte* text;</span><br><span class=line>  <span class=keyword>int</span> oiFirst;</span><br><span class=line>  <span class=keyword>int</span> oiIndex;</span><br><span class=line>  <span class=built_in>string</span> title;</span><br><span class=line>  <span class=keyword>int</span> type;</span><br><span class=line>  <span class=keyword>while</span> (i &lt; end) &#123;</span><br><span class=line>    <span class=keyword>int</span> type = data[i];</span><br><span class=line>    i++;</span><br><span class=line>    lens = getLen(data, i);</span><br><span class=line>    <span class=keyword>if</span> (i + lens.lenLen &lt;= end) &#123;</span><br><span class=line>      i += lens.lenLen;</span><br><span class=line>    &#125;</span><br><span class=line>    <span class=keyword>if</span> (lens.len &lt;<span class=number>0</span> || i + lens.len &gt; end) &#123;</span><br><span class=line>      <span class=keyword>break</span>;</span><br><span class=line>    &#125;</span><br><span class=line>    title = <span class=string>&quot;&quot;</span>;</span><br><span class=line>    <span class=keyword>switch</span> (type) &#123;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x30</span>:  <span class=comment>// 结构体序列</span></span><br><span class=line>        parseANS(data, i, i + lens.len);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x31</span>:  <span class=comment>// Set序列</span></span><br><span class=line>        parseANS(data, i, i + lens.len);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0xa3</span>:  <span class=comment>// 扩展字段</span></span><br><span class=line>        title = <span class=string>&quot;Extension&quot;</span>;</span><br><span class=line>        ansData.push_back(&#123;title, lens.len, <span class=literal>NULL</span>, type&#125;);</span><br><span class=line>        parseANS(data, i, i + lens.len);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0xa0</span>:  <span class=comment>// 证书版本</span></span><br><span class=line>        title = <span class=string>&quot;Version&quot;</span>;</span><br><span class=line>        ansData.push_back(&#123;title, lens.len, <span class=literal>NULL</span>, type&#125;);</span><br><span class=line>        parseANS(data, i, i + lens.len);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x04</span>:  <span class=comment>// OCTET STRING</span></span><br><span class=line>        <span class=comment>// title = &quot;Octet&quot;;</span></span><br><span class=line>        <span class=comment>// ansData.push_back(&#123;title, lens.len, NULL, type&#125;);</span></span><br><span class=line>        parseANS(data, i, i + lens.len);</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x05</span>:</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x06</span>:  <span class=comment>// Object Identifier</span></span><br><span class=line>        title = <span class=string>&quot;&quot;</span>;</span><br><span class=line>        oiFirst = data[i] &amp; <span class=number>0x7f</span>;</span><br><span class=line>        oiIndex = min(oiFirst / <span class=number>40</span>, <span class=number>2</span>);</span><br><span class=line>        title.append(to_string(min(oiFirst / <span class=number>40</span>, <span class=number>2</span>)));</span><br><span class=line>        title.append(<span class=string>&quot;.&quot;</span>);</span><br><span class=line>        title.append(to_string(oiFirst - <span class=number>40</span> * oiIndex));</span><br><span class=line>        title.append(<span class=string>&quot;.&quot;</span>);</span><br><span class=line>        oiIndex = <span class=number>2</span>;</span><br><span class=line>        oiFirst = <span class=number>0</span>;</span><br><span class=line>        <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>1</span>; t &lt; lens.len; t++) &#123;</span><br><span class=line>          oiFirst &lt;&lt;= <span class=number>7</span>;</span><br><span class=line>          oiFirst += data[i + t] &amp; <span class=number>0x7f</span>;</span><br><span class=line>          <span class=keyword>if</span> (!(data[i + t] &amp; <span class=number>0x80</span>)) &#123;</span><br><span class=line>            title.append(to_string(oiFirst));</span><br><span class=line>            title.append(<span class=string>&quot;.&quot;</span>);</span><br><span class=line>            oiIndex++;</span><br><span class=line>            oiFirst = <span class=number>0</span>;</span><br><span class=line>          &#125;</span><br><span class=line>        &#125;</span><br><span class=line>        ansData.push_back(</span><br><span class=line>            &#123;title.substr(<span class=number>0</span>, title.length() - <span class=number>1</span>), lens.len, <span class=literal>NULL</span>, type&#125;);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x17</span>:  <span class=comment>// 时间戳</span></span><br><span class=line>        title = <span class=string>&quot;UTCTime&quot;</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x13</span>:  <span class=comment>// 字符串</span></span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x82</span>:  <span class=comment>// subjectUniqueID</span></span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x16</span>:  <span class=comment>// IA5String类型</span></span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x0c</span>:  <span class=comment>// UTF8String类型</span></span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x86</span>:  <span class=comment>// 特殊IA5String类型</span></span><br><span class=line>        <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>0</span>; t &lt; lens.len; t++) &#123;</span><br><span class=line>          title += (<span class=keyword>char</span>)data[i + t];</span><br><span class=line>        &#125;</span><br><span class=line>        ansData.push_back(&#123;title, lens.len, <span class=literal>NULL</span>, type&#125;);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x01</span>:  <span class=comment>// 布尔类型</span></span><br><span class=line>        oiFirst = <span class=number>0xff</span>;</span><br><span class=line>        <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>0</span>; t &lt; lens.len; t++) &#123;</span><br><span class=line>          oiFirst &amp;= data[i + t];</span><br><span class=line>        &#125;</span><br><span class=line>        ansData.push_back(</span><br><span class=line>            &#123;oiFirst == <span class=number>0</span> ? <span class=string>&quot;False&quot;</span> : <span class=string>&quot;True&quot;</span>, lens.len, <span class=literal>NULL</span>, type&#125;);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x02</span>:  <span class=comment>// 整数类型</span></span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x80</span>:  <span class=comment>// 直接输出</span></span><br><span class=line>        text = <span class=keyword>new</span> byte[lens.len];</span><br><span class=line>        <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>0</span>; t &lt; lens.len; t++) &#123;</span><br><span class=line>          text[t] = data[i + t];</span><br><span class=line>        &#125;</span><br><span class=line>        ansData.push_back(&#123;title, lens.len, text, type&#125;);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x03</span>:  <span class=comment>// Bit String 类型</span></span><br><span class=line>        text = <span class=keyword>new</span> byte[lens.len - <span class=number>1</span>];</span><br><span class=line>        <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>0</span>; t &lt; lens.len - <span class=number>1</span>; t++) &#123;</span><br><span class=line>          text[t] = data[i + t + <span class=number>1</span>];</span><br><span class=line>        &#125;</span><br><span class=line>        ansData.push_back(&#123;<span class=string>&quot;&quot;</span>, lens.len - <span class=number>1</span>, text, type&#125;);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>case</span> <span class=number>0x00</span>:</span><br><span class=line>        text = <span class=keyword>new</span> byte[end - begin];</span><br><span class=line>        <span class=keyword>for</span> (<span class=keyword>int</span> t = begin + <span class=number>1</span>; t &lt; end; t++) &#123;</span><br><span class=line>          text[t - begin - <span class=number>1</span>] = data[t];</span><br><span class=line>        &#125;</span><br><span class=line>        ansData.push_back(&#123;<span class=string>&quot;0x00&quot;</span>, end - begin - <span class=number>1</span>, text, type&#125;);</span><br><span class=line>        <span class=keyword>break</span>;</span><br><span class=line>      <span class=keyword>default</span>:</span><br><span class=line>        i--;</span><br><span class=line>        <span class=keyword>if</span> (i + lens.len &gt; end) &#123;</span><br><span class=line>          text = <span class=keyword>new</span> byte[end - begin];</span><br><span class=line>          <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>0</span>; t &lt; end - begin; t++) &#123;</span><br><span class=line>            text[t] = data[i + t];</span><br><span class=line>          &#125;</span><br><span class=line>          ansData.push_back(&#123;<span class=string>&quot;&quot;</span>, end - begin, text, type&#125;);</span><br><span class=line>        &#125; <span class=keyword>else</span> &#123;</span><br><span class=line>          text = <span class=keyword>new</span> byte[lens.len];</span><br><span class=line>          <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>0</span>; t &lt; lens.len; t++) &#123;</span><br><span class=line>            text[t] = data[i + t];</span><br><span class=line>          &#125;</span><br><span class=line>          ansData.push_back(&#123;<span class=string>&quot;&quot;</span>, lens.len, text, type&#125;);</span><br><span class=line>        &#125;</span><br><span class=line>        i = end;</span><br><span class=line>    &#125;</span><br><span class=line>    i += lens.len;</span><br><span class=line>  &#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><h3 id=显示数据><a class=markdownIt-Anchor href=#显示数据></a> 显示数据</h3><p>我们把一些证书用到的OID存储到MAP中，然后显示出其数据的表示的意义<figure class="highlight c++"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br><span class=line>51</span><br><span class=line>52</span><br><span class=line>53</span><br><span class=line>54</span><br><span class=line>55</span><br><span class=line>56</span><br><span class=line>57</span><br><span class=line>58</span><br><span class=line>59</span><br><span class=line>60</span><br><span class=line>61</span><br><span class=line>62</span><br><span class=line>63</span><br><span class=line>64</span><br><span class=line>65</span><br><span class=line>66</span><br><span class=line>67</span><br><span class=line>68</span><br><span class=line>69</span><br><span class=line>70</span><br><span class=line>71</span><br><span class=line>72</span><br><span class=line>73</span><br><span class=line>74</span><br><span class=line>75</span><br><span class=line>76</span><br><span class=line>77</span><br><span class=line>78</span><br><span class=line>79</span><br><span class=line>80</span><br><span class=line>81</span><br><span class=line>82</span><br><span class=line>83</span><br><span class=line>84</span><br><span class=line>85</span><br><span class=line>86</span><br><span class=line>87</span><br><span class=line>88</span><br><span class=line>89</span><br><span class=line>90</span><br><span class=line>91</span><br><span class=line>92</span><br><span class=line>93</span><br><span class=line>94</span><br><span class=line>95</span><br><span class=line>96</span><br><span class=line>97</span><br><span class=line>98</span><br><span class=line>99</span><br><span class=line>100</span><br><span class=line>101</span><br><span class=line>102</span><br><span class=line>103</span><br><span class=line>104</span><br><span class=line>105</span><br><span class=line>106</span><br><span class=line>107</span><br><span class=line>108</span><br><span class=line>109</span><br><span class=line>110</span><br><span class=line>111</span><br><span class=line>112</span><br><span class=line>113</span><br><span class=line>114</span><br><span class=line>115</span><br><span class=line>116</span><br><span class=line>117</span><br><span class=line>118</span><br><span class=line>119</span><br><span class=line>120</span><br><span class=line>121</span><br><span class=line>122</span><br><span class=line>123</span><br><span class=line>124</span><br><span class=line>125</span><br><span class=line>126</span><br><span class=line>127</span><br><span class=line>128</span><br><span class=line>129</span><br><span class=line>130</span><br><span class=line>131</span><br><span class=line>132</span><br><span class=line>133</span><br><span class=line>134</span><br><span class=line>135</span><br><span class=line>136</span><br><span class=line>137</span><br><span class=line>138</span><br><span class=line>139</span><br><span class=line>140</span><br></pre><td class=code><pre><span class=line><span class=function><span class=keyword>void</span> <span class=title>printTime</span><span class=params>(<span class=built_in>string</span> timeStr)</span> </span>&#123;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;20&quot;</span> &lt;&lt; timeStr[<span class=number>0</span>] &lt;&lt; timeStr[<span class=number>1</span>] &lt;&lt; <span class=string>&quot;年&quot;</span>;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; timeStr[<span class=number>2</span>] &lt;&lt; timeStr[<span class=number>3</span>] &lt;&lt; <span class=string>&quot;月&quot;</span>;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; timeStr[<span class=number>4</span>] &lt;&lt; timeStr[<span class=number>5</span>] &lt;&lt; <span class=string>&quot;日&quot;</span>;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; timeStr[<span class=number>6</span>] &lt;&lt; timeStr[<span class=number>7</span>] &lt;&lt; <span class=string>&quot;:&quot;</span>;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; timeStr[<span class=number>8</span>] &lt;&lt; timeStr[<span class=number>9</span>] &lt;&lt; <span class=string>&quot;:&quot;</span>;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; timeStr[<span class=number>10</span>] &lt;&lt; timeStr[<span class=number>11</span>];</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=function><span class=keyword>void</span> <span class=title>printHex</span><span class=params>(byte* data, <span class=keyword>int</span> len)</span> </span>&#123;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; hex;</span><br><span class=line>  <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>0</span>; t &lt; len; t++) &#123;</span><br><span class=line>    <span class=built_in>cout</span> &lt;&lt; ((data[t] &amp; <span class=number>0xf0</span>) &gt;&gt; <span class=number>4</span>) &lt;&lt; (data[t] &amp; <span class=number>0xf</span>);</span><br><span class=line>  &#125;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; dec &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=function><span class=keyword>void</span> <span class=title>printHexLimit</span><span class=params>(byte* data, <span class=keyword>int</span> len)</span> </span>&#123;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; hex;</span><br><span class=line>  <span class=keyword>for</span> (<span class=keyword>int</span> t = <span class=number>0</span>; t &lt; len; t++) &#123;</span><br><span class=line>    <span class=built_in>cout</span> &lt;&lt; ((data[t] &amp; <span class=number>0xf0</span>) &gt;&gt; <span class=number>4</span>) &lt;&lt; (data[t] &amp; <span class=number>0xf</span>);</span><br><span class=line>    <span class=keyword>if</span> (t % <span class=number>30</span> == <span class=number>29</span>) <span class=built_in>cout</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>  &#125;</span><br><span class=line>  <span class=built_in>cout</span> &lt;&lt; dec &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=function><span class=keyword>void</span> <span class=title>printRes</span><span class=params>()</span> </span>&#123;</span><br><span class=line>  <span class=built_in>std</span>::<span class=built_in>map</span>&lt;<span class=built_in>string</span>, <span class=built_in>string</span>&gt; titleToString = &#123;</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.5.5.7.3.1&quot;</span>, <span class=string>&quot;服务器身份验证(id_kp_serverAuth): True&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.5.5.7.3.2&quot;</span>, <span class=string>&quot;客户端身份验证(id_kp_clientAuth): True&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.29.37&quot;</span>, <span class=string>&quot;扩展密钥用法(Extended key usage):&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.29.31&quot;</span>, <span class=string>&quot;CRL Distribution Points:&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.10045.2.1&quot;</span>, <span class=string>&quot;EC Public Key:&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;Extension&quot;</span>, <span class=string>&quot;扩展字段:&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.23.140.1.2.2&quot;</span>,<span class=string>&quot;组织验证(organization-validated):&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.5.5.7.1.1&quot;</span>, <span class=string>&quot;AuthorityInfoAccess:&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.29.19&quot;</span>, <span class=string>&quot;基本约束(Basic Constraints):&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.5.5.7.3.2&quot;</span>, <span class=string>&quot;客户端身份验证(id_kp_clientAuth): True&quot;</span>&#125;&#125;;</span><br><span class=line>  <span class=built_in>std</span>::<span class=built_in>map</span>&lt;<span class=built_in>string</span>, <span class=built_in>string</span>&gt; titleToHex = &#123;</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.10045.3.1.7&quot;</span>,</span><br><span class=line>       <span class=string>&quot;推荐椭圆曲线域(SEC 2 recommended elliptic curve domain): \n&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.29.35&quot;</span>, <span class=string>&quot;授权密钥标识符(Authority Key Identifier): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.29.14&quot;</span>, <span class=string>&quot;主体密钥标识符(Subject Key Identifier): &quot;</span>&#125;&#125;;</span><br><span class=line>  <span class=built_in>std</span>::<span class=built_in>map</span>&lt;<span class=built_in>string</span>, <span class=built_in>string</span>&gt; titleToNext = &#123;</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.5.5.7.2.1&quot;</span>, <span class=string>&quot;OID for CPS qualifier: &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.5.5.7.48.1&quot;</span>, <span class=string>&quot;OCSP: &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.5.5.7.48.2&quot;</span>, <span class=string>&quot;id-ad-caIssuers: &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.4.1.311.60.2.1.1&quot;</span>, <span class=string>&quot;所在地(Locality): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.4.1.311.60.2.1.3&quot;</span>, <span class=string>&quot;国家(Country): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.6.1.4.1.311.60.2.1.2&quot;</span>, <span class=string>&quot;州或省(State or province): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.3&quot;</span>, <span class=string>&quot;通用名称(id-at-commonName): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.5&quot;</span>, <span class=string>&quot;颁发者序列号(id-at-serialNumber): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.6&quot;</span>, <span class=string>&quot;颁发者国家名(id-at-countryName): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.7&quot;</span>, <span class=string>&quot;颁发者位置名(id-at-localityName): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.8&quot;</span>, <span class=string>&quot;颁发者州省名(id-at-stateOrProvinceName): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.9&quot;</span>, <span class=string>&quot;颁发者街区地址(id-at-streetAddress): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.10&quot;</span>, <span class=string>&quot;颁发者组织名(id-at-organizationName): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.11&quot;</span>, <span class=string>&quot;颁发者组织单位名(id-at-organizationalUnitName): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.12&quot;</span>, <span class=string>&quot;颁发者标题(id-at-title): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.13&quot;</span>, <span class=string>&quot;颁发者描述(id-at-description): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.4.15&quot;</span>, <span class=string>&quot;颁发者业务类别(id-at-businessCategory): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.29.32&quot;</span>, <span class=string>&quot;证书策略(Certificate Policies): &quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;2.5.29.15&quot;</span>, <span class=string>&quot;使用密钥(Key Usage): &quot;</span>&#125;&#125;;</span><br><span class=line></span><br><span class=line>    <span class=built_in>std</span>::<span class=built_in>map</span>&lt;<span class=built_in>string</span>, <span class=built_in>string</span>&gt; algorithmObject = &#123;</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.10040.4.1&quot;</span>, <span class=string>&quot;DSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.10040.4.3&quot;</span> , <span class=string>&quot;sha1DSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.113549.1.1.1&quot;</span> ,<span class=string>&quot;RSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.113549.1.1.2&quot;</span> , <span class=string>&quot;md2RSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.113549.1.1.3&quot;</span> , <span class=string>&quot;md4RSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.113549.1.1.4&quot;</span> , <span class=string>&quot;md5RSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.113549.1.1.5&quot;</span> , <span class=string>&quot;sha1RSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.3.14.3.2.29&quot;</span>, <span class=string>&quot;sha1RSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.113549.1.1.13&quot;</span>, <span class=string>&quot;sha512RSA&quot;</span>&#125;,</span><br><span class=line>      &#123;<span class=string>&quot;1.2.840.113549.1.1.11&quot;</span>,<span class=string>&quot;sha256RSA&quot;</span>&#125;&#125;;</span><br><span class=line></span><br><span class=line>  <span class=keyword>for</span> (<span class=keyword>int</span> i = <span class=number>0</span>; i &lt; ansData.size(); i++) &#123;</span><br><span class=line>    Item item = ansData[i];</span><br><span class=line>    <span class=keyword>if</span> (!<span class=built_in>strcmp</span>(item.title.c_str(), <span class=string>&quot;Version&quot;</span>)) &#123;</span><br><span class=line>      item = ansData[++i];</span><br><span class=line>      <span class=keyword>if</span> (item.type == <span class=number>0x02</span>) &#123;</span><br><span class=line>        <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;证书版本: &quot;</span>;</span><br><span class=line>        <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;V&quot;</span> &lt;&lt; item.data[<span class=number>0</span>] + <span class=number>1</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>        item = ansData[++i];</span><br><span class=line>        <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;序列号: &quot;</span>;</span><br><span class=line>        printHex(item.data, item.len);</span><br><span class=line>      &#125; <span class=keyword>else</span> &#123;</span><br><span class=line>        i--;</span><br><span class=line>      &#125;</span><br><span class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> (titleToString.find(item.title) != titleToString.end()) &#123;</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; titleToString[item.title] &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> (titleToHex.find(item.title) != titleToHex.end()) &#123;</span><br><span class=line>      <span class=built_in>string</span> title = titleToHex[item.title];</span><br><span class=line>      item = ansData[++i];</span><br><span class=line>      <span class=keyword>if</span> (item.data != <span class=literal>NULL</span>) &#123;</span><br><span class=line>        <span class=built_in>cout</span> &lt;&lt; title;</span><br><span class=line>        printHex(item.data, item.len);</span><br><span class=line>      &#125; <span class=keyword>else</span> &#123;</span><br><span class=line>        i--;</span><br><span class=line>      &#125;</span><br><span class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> (titleToNext.find(item.title) != titleToNext.end()) &#123;</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; titleToNext[item.title];</span><br><span class=line>      item = ansData[++i];</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; item.title &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> (algorithmObject.find(item.title) != algorithmObject.end()) &#123;</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;加密算法: &quot;</span> &lt;&lt; algorithmObject[item.title];</span><br><span class=line>      item = ansData[++i];</span><br><span class=line>      <span class=keyword>if</span> (item.type == <span class=number>0x03</span>) &#123;</span><br><span class=line>        <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;\n公钥：&quot;</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>        printHexLimit(item.data, item.len);</span><br><span class=line>      &#125; <span class=keyword>else</span> &#123;</span><br><span class=line>        i--;</span><br><span class=line>      &#125;</span><br><span class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> (!<span class=built_in>strcmp</span>(item.title.c_str(), <span class=string>&quot;0x00&quot;</span>)) &#123;</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;Public Key: &quot;</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>      printHexLimit(item.data, item.len);</span><br><span class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> (!<span class=built_in>strcmp</span>(item.title.c_str(), <span class=string>&quot;2.5.29.17&quot;</span>)) &#123;</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;主体别名(Subject Alternative Name): &quot;</span>;</span><br><span class=line>      item = ansData[++i];</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; item.title;</span><br><span class=line>      item = ansData[++i];</span><br><span class=line>      <span class=keyword>while</span> (item.type == <span class=number>0x82</span>) &#123;</span><br><span class=line>        <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;, &quot;</span> &lt;&lt; item.title;</span><br><span class=line>        item = ansData[++i];</span><br><span class=line>      &#125;</span><br><span class=line>      i--;</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>    &#125; <span class=keyword>else</span> <span class=keyword>if</span> (item.title.length() &gt; <span class=number>7</span> &amp;&amp;</span><br><span class=line>               !<span class=built_in>strcmp</span>(item.title.substr(<span class=number>0</span>, <span class=number>7</span>).c_str(), <span class=string>&quot;UTCTime&quot;</span>)) &#123;</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot;有效期: &quot;</span>;</span><br><span class=line>      <span class=built_in>string</span> beginTime = item.title.substr(<span class=number>7</span>, item.title.length() - <span class=number>8</span>);</span><br><span class=line>      printTime(beginTime);</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; <span class=string>&quot; - &quot;</span>;</span><br><span class=line>      item = ansData[++i];</span><br><span class=line>      <span class=built_in>string</span> endTime = item.title.substr(<span class=number>7</span>, item.title.length() - <span class=number>8</span>);</span><br><span class=line>      printTime(endTime);</span><br><span class=line>      <span class=built_in>cout</span> &lt;&lt; <span class=built_in>endl</span>;</span><br><span class=line>    &#125;</span><br><span class=line>  &#125;</span><br><span class=line>&#125;</span><br></pre></table></figure></div><footer class=post-footer><div class=post-tags><a href=/tags/%E5%BC%80%E5%8F%91/ rel=tag><i class="fa fa-tag"></i> 开发</a> <a href=/tags/%E8%AF%81%E4%B9%A6%E6%A0%BC%E5%BC%8F/ rel=tag><i class="fa fa-tag"></i> 证书格式</a> <a href=/tags/ASN-1/ rel=tag><i class="fa fa-tag"></i> ASN.1</a></div><div class=post-nav><div class=post-nav-item><a href=/2021/05/21/519a38cc442c/ rel=prev title="切换到vs online 了"><i class="fa fa-chevron-left"></i> 切换到vs online 了</a></div><div class=post-nav-item><a href=/2021/05/21/9d48d51788bb/ rel=next title=加密博客测试>加密博客测试 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; <span itemprop=copyrightYear>2021</span> <span class=with-love><i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Vitock</span></div></div></footer><script src=https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/next-boot.js></script><script src=/js/pjax.js></script><script class=next-config data-name=enableMath type=application/json>false</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity="sha256-55Ddc47WvWTK5vYVejnAuSK7USJaL7FQXrzQ4HiQ1WY=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin=anonymous><script class=next-config data-name=gitalk type=application/json>{"enable":true,"github_id":"vitock","repo":"vitock.github.io","client_id":"e7f10b97367d65ffb9e5","client_secret":"2e83b75434ccccb749d08eddbb0599330d46835e","admin_user":"vitock","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en | zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"0c8469145379725f3f0253c4508648eb"}</script><script src=/js/third-party/comments/gitalk.js></script>
