<!doctype html><html lang=zh-CN><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222><meta name=generator content="Hexo 5.2.0"><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-next.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32-next.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16-next.png><link rel=mask-icon href=/images/logo.svg color=#222><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><script class=next-config data-name=main type=application/json>{"hostname":"vitock.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src=/js/config.js></script><meta name=description content="ECDSA 签名 前面讲过ECDH的加密,现在写点关于签名的东西。 ECDSA 相对于 RSA 签名，速度更快，签名更短。 已知消息 MessageMessageMessage ,这里对其做哈希(sha256)求得结果。 这里不对消息本身签名,因为消息太长了,计算量太大。签名一般都是对消息的hash进行签名。"><meta property=og:type content=article><meta property=og:title content="ECDSA 签名算法"><meta property=og:url content=http://vitock.github.io/2021/07/29/d9aa54d24287/index.html><meta property=og:site_name><meta property=og:description content="ECDSA 签名 前面讲过ECDH的加密,现在写点关于签名的东西。 ECDSA 相对于 RSA 签名，速度更快，签名更短。 已知消息 MessageMessageMessage ,这里对其做哈希(sha256)求得结果。 这里不对消息本身签名,因为消息太长了,计算量太大。签名一般都是对消息的hash进行签名。"><meta property=og:locale content=zh_CN><meta property=article:published_time content=2021-07-29T04:02:30.000Z><meta property=article:modified_time content=2021-08-12T02:14:02.852Z><meta property=article:author content=Vitock><meta property=article:tag content=ECC加密><meta property=article:tag content=椭圆曲线><meta property=article:tag content=模逆元><meta property=article:tag content=素数><meta property=article:tag content=ECDSA><meta name=twitter:card content=summary><link rel=canonical href=http://vitock.github.io/2021/07/29/d9aa54d24287/ ><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://vitock.github.io/2021/07/29/d9aa54d24287/","path":"2021/07/29/d9aa54d24287/","title":"ECDSA 签名算法"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>ECDSA 签名算法 |</title><script src=/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?49542d4f1ae3f2f35a0227ac6a0c62c6></script><noscript><link rel=stylesheet href=/css/noscript.css></noscript><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title></h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Vitock</div><div class=site-nav-right><div class="toggle popup-trigger"></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ rel=section><i class="fa fa-home fa-fw"></i>首页</a><li class="menu-item menu-item-tags"><a href=/tags/ rel=section><i class="fa fa-tags fa-fw"></i>标签</a><li class="menu-item menu-item-archives"><a href=/archives/ rel=section><i class="fa fa-archive fa-fw"></i>归档</a><li class="menu-item menu-item-about"><a href=/about/ rel=section><i class="fa fa-user fa-fw"></i>关于</a></ul></nav></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-2"><a class=nav-link href=#ecdsa-%E7%AD%BE%E5%90%8D><span class=nav-number>1.</span> <span class=nav-text>ECDSA 签名</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%AD%A5%E9%AA%A4><span class=nav-number>1.1.</span> <span class=nav-text>步骤</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E8%AF%81%E6%98%8E><span class=nav-number>1.1.1.</span> <span class=nav-text>证明,</span></a></ol></ol><li class="nav-item nav-level-2"><a class=nav-link href=#%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B8%8D%E9%9A%8F%E6%9C%BA%E9%80%A0%E6%88%90%E7%9A%84%E7%A7%81%E9%92%A5%E6%B3%84%E9%9C%B2%E4%BA%8B%E4%BB%B6><span class=nav-number>2.</span> <span class=nav-text>随机数不随机造成的私钥泄露事件</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#ecc-%E9%81%87%E5%88%B0%E7%9A%84%E6%8C%91%E6%88%98><span class=nav-number>3.</span> <span class=nav-text>ECC 遇到的挑战</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#dhdiffie-hellman%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E7%AE%97%E6%B3%95%E7%AE%97%E6%B3%95><span class=nav-number>4.</span> <span class=nav-text>DH(Diffie-Hellman)密钥交换算法算法</span></a></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class=site-overview><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Vitock src=/img/avatar/icon_0.webp><p class=site-author-name itemprop=name>Vitock<div class=site-description itemprop=description></div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/ ><span class=site-state-item-count>51</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/ ><span class=site-state-item-count>7</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/ ><span class=site-state-item-count>50</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class=links-of-author-item><a href=https://github.com/vitock title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;vitock" rel=noopener target=_blank><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class=links-of-author-item><a href=https://weibo.com/2145843507/profile title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;2145843507&#x2F;profile" rel=noopener target=_blank><i class="fab fa-weibo fa-fw"></i>Weibo</a></span></div></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up"></i> <span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang=zh-CN><link itemprop=mainEntityOfPage href=http://vitock.github.io/2021/07/29/d9aa54d24287/ ><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=/img/avatar/icon_0.webp><meta itemprop=name content=Vitock><meta itemprop=description content=""></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=""></span><header class=post-header><h1 class=post-title itemprop="name headline">ECDSA 签名算法</h1><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i> </span><span class=post-meta-item-text>发表于</span> <time title="创建时间：2021-07-29 12:02:30" itemprop="dateCreated datePublished" datetime=2021-07-29T12:02:30+08:00>2021-07-29</time></span></div></div></header><div class=post-body itemprop=articleBody><h2 id=ecdsa-签名><a class=markdownIt-Anchor href=#ecdsa-签名></a> ECDSA 签名</h2><p>前面讲过ECDH的加密,现在写点关于签名的东西。<br>ECDSA 相对于 RSA 签名，速度更快，签名更短。<p>已知消息 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding=application/x-tex>Message</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">e</span></span></span></span> ,这里对其做哈希(sha256)求得结果。<br>这里不对消息本身签名,因为消息太长了,计算量太大。签名一般都是对消息的hash进行签名。<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable rowspacing=0.24999999999999992em columnalign="right left" columnspacing=0em><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mi>h</mi><mo>=</mo><mi>H</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy=false>(</mo><mi>M</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mi>d</mi><mi>A</mi><mo>=</mo><mi>Y</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>P</mi><mi>r</mi><mi>i</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>K</mi><mi>e</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mi>P</mi><mo>=</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><mi>G</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} &amp; h = Hash(Message) \\ &amp; dA = Your Private Key\\ &amp; P = dA \cdot G \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:4.500000000000002em;vertical-align:-2.000000000000001em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.5000000000000004em><span style=top:-4.5em><span class=pstrut style=height:2.84em></span><span class=mord></span></span><span style=top:-3em><span class=pstrut style=height:2.84em></span><span class=mord></span></span><span style=top:-1.4999999999999991em><span class=pstrut style=height:2.84em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.000000000000001em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.5000000000000004em><span style=top:-4.66em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.08125em>H</span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.10903em>M</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style=margin-right:.03588em>g</span><span class="mord mathdefault">e</span><span class=mclose>)</span></span></span><span style=top:-3.16em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.22222em>Y</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style=margin-right:.03588em>v</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style=margin-right:.03588em>y</span></span></span><span style=top:-1.6599999999999993em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.000000000000001em><span></span></span></span></span></span></span></span></span></span></span></span><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding=application/x-tex>dA</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span></span></span></span>是用于签名的,保密,不能公开。<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=application/x-tex>P</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span></span></span></span>是公钥,<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>h</mi></mrow><annotation encoding=application/x-tex>h</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">h</span></span></span></span>是消息的哈希摘要。一般使用SHA256生成。<h3 id=步骤><a class=markdownIt-Anchor href=#步骤></a> 步骤</h3><ol><li><strong>随机生成</strong> 32 位数字 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span> 作为临时私钥,并生成临时公钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi></mrow><annotation encoding=application/x-tex>R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span></ol><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi><mo>=</mo><mi>k</mi><mo>⋅</mo><mi>G</mi></mrow><annotation encoding=application/x-tex>R = k \cdot G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span></span><blockquote><p>这里注意随机不可预测,后面会写到不随机的后果。</blockquote><ol start=2><li><p>计算 S 签名<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><mi>h</mi><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo><mspace></mspace><mspace width=1em><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mspace width=0.3333333333333333em><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>S = k^{-1}(h + dA \cdot R_x) \pmod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:1em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.3333333333333333em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span></span><p>这里 <span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=application/x-tex>k^{-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 是k的模逆元<br><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mi>x</mi></msub></mrow><annotation encoding=application/x-tex>R_x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>是临时公钥<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi></mrow><annotation encoding=application/x-tex>R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span>的x坐标<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>p</mi></mrow><annotation encoding=application/x-tex>p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">p</span></span></span></span> 是 曲线规定的素数,<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>G</mi></mrow><annotation encoding=application/x-tex>G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span>是公共点<p>将<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>S</mi><mo separator=true>,</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(S,R_x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 整体作为签名。</ol><blockquote><p>快速求模逆元,可以用<a target=_blank rel=noopener href=https://zh.wikipedia.org/wiki/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95>扩展欧几里得算法</a>,具体方式就是辗转相除,细节可以看百科</blockquote><ol start=3><li>验证<ol><li>计算</ol><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi><mo>=</mo><msup><mi>S</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><mi>h</mi><mo>⋅</mo><mi>G</mi><mo>+</mo><mi>P</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>R = S^{-1}(h \cdot G + P \cdot R_x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.76666em;vertical-align:-.08333em></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span><ol start=2><li>比较 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi></mrow><annotation encoding=application/x-tex>R</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span></span> 的x坐标 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mi>x</mi></msub></mrow><annotation encoding=application/x-tex>R_{x}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 等于第2部结果中的 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mi>x</mi></msub></mrow><annotation encoding=application/x-tex>R_x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>,验证就通过。</ol></ol><h4 id=证明><a class=markdownIt-Anchor href=#证明></a> 证明,</h4><p>由于<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi><mo>=</mo><mi>k</mi><mo>⋅</mo><mi>G</mi><mspace linebreak=newline></mspace><mi>P</mi><mo>=</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><mi>G</mi><mspace linebreak=newline></mspace><mo>↓</mo><mspace linebreak=newline></mspace><mtable rowspacing=0.24999999999999992em columnalign="right left" columnspacing=0em><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mi>R</mi></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msup><mi>S</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><mi>h</mi><mo>⋅</mo><mi>G</mi><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><mi>G</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msup><mi>S</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>G</mi><mo stretchy=false>(</mo><mi>h</mi><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>k</mi><mi>G</mi></mrow></mstyle></mtd></mtr></mtable><mspace linebreak=newline></mspace><mo>↓</mo><mspace linebreak=newline></mspace><mi>k</mi><mo>=</mo><msup><mi>S</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><mi>h</mi><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>R = k \cdot G \\ P = dA \cdot G\\ \downarrow\\ \begin{aligned} R &amp;= S^{-1}(h \cdot G + dA \cdot G \cdot R_x ) \\ &amp;= S^{-1}G (h + dA \cdot R_x) \\ &amp;= kG \\ \end{aligned}\\ \downarrow\\ k = S^{-1}(h + dA \cdot R_x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.13889em>P</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mrel>↓</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:4.548216em;vertical-align:-2.024108em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.524108em><span style=top:-4.66em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span></span></span><span style=top:-3.135892em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-1.6358920000000001em><span class=pstrut style=height:3em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.024108em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:2.524108em><span style=top:-4.66em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">G</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span><span style=top:-3.135892em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">G</span><span class=mopen>(</span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span><span style=top:-1.6358920000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class="mord mathdefault">G</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.024108em><span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mrel>↓</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span><p>两边同时取逆<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>S</mi><mo stretchy=false>(</mo><mi>h</mi><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><msup><mo stretchy=false>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=application/x-tex>k^{-1} = S (h + dA \cdot R_x)^{-1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.864108em;vertical-align:0></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mopen>(</span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span><p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><mi>h</mi><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>S = k^{-1}(h + dA \cdot R_x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathdefault">h</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span><p>与<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>S</mi></mrow><annotation encoding=application/x-tex>S</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.05764em>S</span></span></span></span> 的生成公式一样,所以等式成立。<h2 id=随机数不随机造成的私钥泄露事件><a class=markdownIt-Anchor href=#随机数不随机造成的私钥泄露事件></a> 随机数不随机造成的私钥泄露事件</h2><p>k的选取要随机,不可预测。<p>索尼就犯了这样的错误，PS3 所有的游戏签名，用到的都是<font color=red>同样的随机数<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span></font>,<br>这样只要购买两个游戏,就能获得对应的签名<br><span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>S</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(S_1,R_x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> ,<span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><msub><mi>S</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(S_2,R_x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> 由于是同样的k,导致公钥的<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mi>x</mi></msub></mrow><annotation encoding=application/x-tex>R_x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>坐标也是一样的。<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mrow><mo fence=true>{</mo><mtable rowspacing=0.3599999999999999em columnalign="left left" columnspacing=1em><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><msub><mi>h</mi><mn>1</mn></msub><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=false><mrow><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><msub><mi>h</mi><mn>2</mn></msub><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><mspace linebreak=newline></mspace><mo>↓</mo><mspace linebreak=newline></mspace><msub><mi>S</mi><mn>1</mn></msub><mo>−</mo><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><msub><mi>h</mi><mn>1</mn></msub><mo>−</mo><msub><mi>h</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\begin{cases} S_1 = k^{-1}(h_1 + dA \cdot R_x)\\ S_2 = k^{-1}(h_2 + dA \cdot R_x) \\ \end{cases}\\ \downarrow\\ S_1 - S_2 = k^{-1}(h_1 - h_2)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:3.0000299999999998em;vertical-align:-1.25003em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">{</span></span><span class=mord><span class=mtable><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.69em><span style=top:-3.69em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.19em><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mrel>↓</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class="mspace newline"></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span><p>这里 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>S</mi><mn>2</mn></msub><mo separator=true>,</mo><msub><mi>h</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>S_1, S_2, h_1, h_2</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>都是已知的， 很容易就计算出<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi></mrow><annotation encoding=application/x-tex>k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span></span></span></span>,<br>然后<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>R</mi><mo>=</mo><mi>k</mi><mo>⋅</mo><mi>G</mi></mrow><annotation encoding=application/x-tex>R = k \cdot G</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault">G</span></span></span></span></span><p>计算出<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>R</mi><mi>x</mi></msub></mrow><annotation encoding=application/x-tex>R_x</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>,代入<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>=</mo><msup><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=false>(</mo><msub><mi>h</mi><mn>1</mn></msub><mo>+</mo><mi>d</mi><mi>A</mi><mo>⋅</mo><msub><mi>R</mi><mi>x</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>S_1 = k^{-1}(h_1 + dA \cdot R_x)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.83333em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1.1141079999999999em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.864108em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathdefault">h</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord><span class="mord mathdefault" style=margin-right:.00773em>R</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span><p>很容易就计算出私钥<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>d</mi><mi>A</mi></mrow><annotation encoding=application/x-tex>dA</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault">d</span><span class="mord mathdefault">A</span></span></span></span> ,<br>这样就能随意签名其他盗版游戏文件了。<h2 id=ecc-遇到的挑战><a class=markdownIt-Anchor href=#ecc-遇到的挑战></a> ECC 遇到的挑战</h2><p>目前的估算认为：破解256位素数域上的椭圆曲线，需要2330个量子比特与1260亿个托佛利门。相比之下，使用秀尔算法破解2048位的RSA则需要4098个量子比特与5.2万亿个托佛利门。因此，椭圆曲线会更先遭到量子计算机的破解。<hr><h2 id=dhdiffie-hellman密钥交换算法算法><a class=markdownIt-Anchor href=#dhdiffie-hellman密钥交换算法算法></a> DH(Diffie-Hellman)密钥交换算法算法</h2><p>用到的也是离散对数难题<br>公开一个 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>p</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x,p)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mclose>)</span></span></span></span> ,其中,x 是随机数,p是一个大素数<p>A 随机生成一个随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>r</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>r_a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><msup><mi>x</mi><msub><mi>r</mi><mi>a</mi></msub></msup><mspace></mspace><mspace width=0.6666666666666666em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>m = x^{r_a} \mod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285719em><span style=top:-2.357em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.6666666666666666em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span></span></span></span>, 保密 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>r</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>r_a</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><p>B 随机生成一个随机数 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>r</mi><mi>b</mi></msub></mrow><annotation encoding=application/x-tex>r_b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> 计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><msup><mi>x</mi><msub><mi>r</mi><mi>b</mi></msub></msup><mspace></mspace><mspace width=0.6666666666666666em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>p</mi></mrow><annotation encoding=application/x-tex>n = x^{r_b} \mod p</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.664392em;vertical-align:0></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3487714285714287em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15122857142857138em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.6666666666666666em></span></span><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span></span></span></span>, 保密 <span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>r</mi><mi>b</mi></msub></mrow><annotation encoding=application/x-tex>r_b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.58056em;vertical-align:-.15em></span><span class=mord><span class="mord mathdefault" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><p>AB 互换 mn,<br>计算密钥<p class=katex-block><span class=katex-display><span class=katex><span class=katex-mathml><math><semantics><mtable rowspacing=0.24999999999999992em columnalign="right left" columnspacing=0em><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><msub><mi>K</mi><mi>a</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msup><mi>n</mi><msub><mi>r</mi><mi>a</mi></msub></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msup><mrow><mo stretchy=false>(</mo><msup><mi>x</mi><msub><mi>r</mi><mi>b</mi></msub></msup><mo stretchy=false>)</mo></mrow><msub><mi>r</mi><mi>a</mi></msub></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msup><mi>x</mi><mrow><msub><mi>r</mi><mi>a</mi></msub><mo>⋅</mo><msub><mi>r</mi><mi>b</mi></msub></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msup><mrow><mo stretchy=false>(</mo><msup><mi>x</mi><msub><mi>r</mi><mi>a</mi></msub></msup><mo stretchy=false>)</mo></mrow><msub><mi>r</mi><mi>b</mi></msub></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msup><mi>m</mi><msub><mi>r</mi><mi>b</mi></msub></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><msub><mi>K</mi><mi>b</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0 displaystyle=true><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0 displaystyle=true><mrow><mrow></mrow><mo>=</mo><mi>K</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} K_a &amp; = n ^ {r_a} \\ &amp; = {(x ^{r_b})} ^ {r_a} \\ &amp; = x^{r_a \cdot r_b}\\ &amp; = {(x ^{r_a})}^{r_b}\\ &amp; = m ^{r_b}\\ &amp; = K_b \\ &amp; = K \end{aligned}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:10.500000000000004em;vertical-align:-5.000000000000002em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:5.500000000000001em><span style=top:-7.660000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-6.16em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-4.659999999999999em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-3.1599999999999993em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-1.6599999999999993em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:-.15999999999999837em><span class=pstrut style=height:3em></span><span class=mord></span></span><span style=top:1.3400000000000016em><span class=pstrut style=height:3em></span><span class=mord></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:5.000000000000002em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:5.500000000000001em><span style=top:-7.660000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285719em><span style=top:-2.357em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-6.16em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=mord><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3487714285714287em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15122857142857138em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285719em><span style=top:-2.357em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-4.659999999999999em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.724115em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285719em><span style=top:-2.357em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span><span class="mbin mtight">⋅</span><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3487714285714287em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15122857142857138em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-3.1599999999999993em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=mord><span class=mopen>(</span><span class=mord><span class="mord mathdefault">x</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.16454285714285719em><span style=top:-2.357em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=mclose>)</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.804292em><span style=top:-3.2029em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3487714285714287em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15122857142857138em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-1.6599999999999993em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7143919999999999em><span style=top:-3.113em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=top:-2.3487714285714287em;margin-left:-.02778em;margin-right:.07142857142857144em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15122857142857138em><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=top:-.15999999999999837em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:1.3400000000000016em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:5.000000000000002em><span></span></span></span></span></span></span></span></span></span></span></span><p>AB计算出来的<span class=katex><span class=katex-mathml><math><semantics><mrow><msub><mi>K</mi><mi>a</mi></msub><mo separator=true>,</mo><msub><mi>K</mi><mi>b</mi></msub></mrow><annotation encoding=application/x-tex>K_a,K_b</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8777699999999999em;vertical-align:-.19444em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.151392em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-left:-.07153em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>相等,都是<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span><br><strong><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span> 就是两者交换的密钥。</strong><p>例子<p>公布 <span class=katex><span class=katex-mathml><math><semantics><mrow><mo stretchy=false>(</mo><mi>x</mi><mo separator=true>,</mo><mi>p</mi><mo stretchy=false>)</mo><mo>=</mo><mo stretchy=false>(</mo><mn>2</mn><mo separator=true>,</mo><mn>17</mn><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(x,p)= (2,17)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class="mord mathdefault">x</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">p</span><span class=mclose>)</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>(</span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mord>7</span><span class=mclose>)</span></span></span></span>;<p>A 取随机数 3 ,计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo>=</mo><msup><mn>2</mn><mn>3</mn></msup><mspace></mspace><mspace width=0.6666666666666666em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mtext> </mtext><mn>17</mn><mo>=</mo><mn>8</mn></mrow><annotation encoding=application/x-tex>m = 2^3 \mod 17 = 8</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.6666666666666666em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mord>7</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>8</span></span></span></span><p>B 取随机数 5 计算 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>n</mi><mo>=</mo><msup><mn>2</mn><mn>5</mn></msup><mspace></mspace><mspace width=0.6666666666666666em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mtext> </mtext><mn>17</mn><mo>=</mo><mn>15</mn></mrow><annotation encoding=application/x-tex>n = 2 ^ 5 \mod 17 = 15</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class="mord mathdefault">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.6666666666666666em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mord>7</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span><span class=mord>5</span></span></span></span><p>交换 AB 交换<span class=katex><span class=katex-mathml><math><semantics><mrow><mi>m</mi><mo separator=true>,</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>m,n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class="mord mathdefault">m</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class="mord mathdefault">n</span></span></span></span><br>A 计算密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>n</mi><mn>3</mn></msup><mspace></mspace><mspace width=0.6666666666666666em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mtext> </mtext><mn>17</mn><mo>=</mo><mn>9</mn><mo>=</mo><mi>K</mi></mrow><annotation encoding=application/x-tex>k = n ^ 3 \mod 17 = 9 = K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">n</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.6666666666666666em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mord>7</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>9</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span><br>B 计算密钥 <span class=katex><span class=katex-mathml><math><semantics><mrow><mi>k</mi><mo>=</mo><msup><mi>m</mi><mn>5</mn></msup><mspace></mspace><mspace width=0.6666666666666666em><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi></mrow><mtext> </mtext><mtext> </mtext><mn>17</mn><mo>=</mo><mn>9</mn><mo>=</mo><mi>K</mi></mrow><annotation encoding=application/x-tex>k = m ^ 5 \mod 17 = 9 = K</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class="mord mathdefault">m</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace style=margin-right:.6666666666666666em></span></span><span class=base><span class=strut style=height:.69444em;vertical-align:0></span><span class=mord><span class=mord><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mord>7</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>9</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span></span></span></span><p><span class=katex><span class=katex-mathml><math><semantics><mrow><mi>K</mi><mo>=</mo><mn>9</mn></mrow><annotation encoding=application/x-tex>K =9</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class="mord mathdefault" style=margin-right:.07153em>K</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>9</span></span></span></span> 就是密钥<blockquote><p>注，DH算法也无法完全避免中间人攻击，交换m和n的过程中，如果遇到中间人，A 和B 是无法感知的。</blockquote></div><div class=popular-posts-header>相关文章</div><ul class=popular-posts><li class=popular-posts-item><div class=popular-posts-title><a href=/2020/10/21/541a3f0129ff/ rel=bookmark>ECC椭圆曲线加密</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/07/817093e2f777/ rel=bookmark>扩展欧几里得算法</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/02/e68ed72c802a/ rel=bookmark>RSA</a></div><li class=popular-posts-item><div class=popular-posts-title><a href=/2021/08/07/42fede76182f/ rel=bookmark>Miller-Rabin素数测试算法</a></div></ul><footer class=post-footer><div class=post-tags><a href=/tags/ECC%E5%8A%A0%E5%AF%86/ rel=tag><i class="fa fa-tag"></i> ECC加密</a> <a href=/tags/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/ rel=tag><i class="fa fa-tag"></i> 椭圆曲线</a> <a href=/tags/%E6%A8%A1%E9%80%86%E5%85%83/ rel=tag><i class="fa fa-tag"></i> 模逆元</a> <a href=/tags/%E7%B4%A0%E6%95%B0/ rel=tag><i class="fa fa-tag"></i> 素数</a> <a href=/tags/ECDSA/ rel=tag><i class="fa fa-tag"></i> ECDSA</a></div><div class=post-nav><div class=post-nav-item><a href=/2021/06/28/3d92ef57e6e7/ rel=prev title=一个身份证小技巧><i class="fa fa-chevron-left"></i> 一个身份证小技巧</a></div><div class=post-nav-item><a href=/2021/08/02/e68ed72c802a/ rel=next title=RSA>RSA <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; <span itemprop=copyrightYear>2021</span> <span class=with-love><i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>Vitock</span></div></div></footer><script src=https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/next-boot.js></script><script src=/js/pjax.js></script><script class=next-config data-name=enableMath type=application/json>true</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity="sha256-55Ddc47WvWTK5vYVejnAuSK7USJaL7FQXrzQ4HiQ1WY=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin=anonymous><script class=next-config data-name=gitalk type=application/json>{"enable":true,"github_id":"vitock","repo":"vitock.github.io","client_id":"e7f10b97367d65ffb9e5","client_secret":"2e83b75434ccccb749d08eddbb0599330d46835e","admin_user":"vitock","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en | zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"6162d37c7ab41e0a48154c5633d25578"}</script><script src=/js/third-party/comments/gitalk.js></script>
